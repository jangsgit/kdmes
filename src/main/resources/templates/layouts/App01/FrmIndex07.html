<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<header th:fragment="headerFragment">
    <!-- py-md-2 px-1 py-1 -->
    <div class="card-body d-flex align-items-center py-md-2 px-auto py-auto ">
        <main class="main" id="top"> 
            <div class="container-fluid"> 
                <script>
                    var isFluid = JSON.parse(localStorage.getItem('isFluid'));
                    if (isFluid) {
                        var container = document.querySelector('[data-layout]');
                        container.classList.remove('container');
                        container.classList.add('container-fluid');
                    }
                </script> 


                <nav class="navbar navbar-light navbar-vertical navbar-expand-xl">
                    <script>
                        var navbarStyle = localStorage.getItem("navbarStyle");
                        if (navbarStyle && navbarStyle !== 'transparent') {
                            document.querySelector('.navbar-vertical').classList.add(`navbar-${navbarStyle}`);
                        }
                    </script>
                    <div class="d-flex align-items-center">
                        <div class="toggle-icon-wrapper">

                            <button class="btn navbar-toggler-humburger-icon navbar-vertical-toggle"
                                data-bs-toggle="tooltip" data-bs-placement="left" title="Toggle Navigation"><span
                                    class="navbar-toggle-icon"><span class="toggle-line"></span></span></button>

                        </div><a class="navbar-brand" href="@{/user}">
                            <!-- <div class="d-flex align-items-center py-3"><img class="me-2"
                                    th:src="@{assets/img/icons/spot-illustrations/falcon.png}" alt="" width="40" /><span
                                    class="font-sans-serif">ActasErp</span>
                            </div> -->
                        </a>
                    </div> 
                    <!------navbar vertical------>     
                    <div th:replace="layouts/layout01/navbarMemWeb :: navbar"></div>  
                </nav>  
                <div class="content" id="index07"> 
                    <!------nav ------>
                    <!-- <div th:replace="layouts/layout01/headerNavWeb :: headerNav"></div>   -->

<body layout:fragment="index07"> 
<!-- ######################### ######################### ######################### ######################### ######################### ######################### --> 
<!-- contents body 시작--> 
<!-- form 또는 action 으로 받아오기  -->
<div class="con">
    <!-- contents header -->
    <th:block th:include="layouts/APPHeader/appheadTop"/> 
    <!-- contents body 시작--> 
 
  <div class="card">
    <div class="card-body p-3">
      <div class="d-flex align-items-center gap-2 mb-3">
        <input type="text" class="form-control form-control-sm" style="width: 200px;" placeholder="거래처명 입력..." id="searchtxt"  />
        <button class="btn btn-primary btn-sm"   id="retrieveBtn">검색</button>
        <button class="btn btn-primary btn-sm"     id="gogobtn" data-bs-toggle="modal" data-bs-target="#gomodal">거래처현황</button>  
        <label class="form-label d-block">&nbsp;</label>
        <button type="button" class="btn btn-primary btn-sm" id="save" onclick="save_btn()">저장</button>
        <button type="button" class="btn btn-outline-secondary btn-sm" onclick="clear_rtn()">신규</button>
        <button type="button" class="btn btn-outline-danger btn-sm"  id="delete" onclick="delete_btn()">삭제</button>
        
      </div>        
      <!-- Grid Area -->
      <div class="grid-container mb-3"> 
            <div id="wtab01Grid_div"  style="  height:200px;  width:1100px;   margin:0 auto; "></div>    
      </div> 
      <!-- Form Section -->
      <div class="form-section">
        <form class="row g-2">
          <div class="col-md-3">
            <div class="input_wrap" style="max-width: 230px;"> 
                <label for="companyType" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">업체구분</label>
                <select th:field="*{cifcodeList}" name="acorp1" id="acorp1">
                    <option value="">선택</option>
                    <option th:each="val : ${cifcodeList}" th:value="${val.cifcode}" th:text="${val.cifcodename}">
                </select>
                <input type="hidden"   name="acorp2" id="acorp2" autocomplete="off"  disabled > 
            </div>     
          </div>
          <div class="col-md-3">
            <label for="clientName" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">거래처명 <span class="text-danger">*</span></label>  
            <input type="text" id="acorp" class="form-control" placeholder="거래처명" required />
            <input type="hidden" id="acorp3"  disabled>
            <input type="hidden" id="acode"  disabled>
          </div>
          <div class="col-md-3">
            <label for="bizNumber" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">사업자번호</label>
            <div class="input-group-inline">
              <input type="text" id="asano1"  class="form-control" maxlength="3" placeholder="000" />
              <input type="text" id="asano2"  class="form-control" maxlength="2" placeholder="00" />
              <input type="text" id="asano3"  class="form-control" maxlength="5" placeholder="00000" />
            </div> 
          </div>
          <div class="col-md-3">
            <label for="ceo" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">대표자</label>
            <input type="text" id="aname" class="form-control" placeholder="대표자 이름" />
          </div>
          <div class="col-md-3">
            <label for="ajumi1" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">법인번호</label>
            <div class="input-group-inline">
              <input type="text" id="ajumi1"  class="form-control" maxlength="7"   />
              <input type="text" id="ajumi2"  class="form-control" maxlength="7"   /> 
            </div>  
          </div>
          <div class="col-md-3">
            <label for="aupte" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">업태</label>
            <input type="text" id="aupte" class="form-control"  /> 
          </div>
          <div class="col-md-3">
            <label for="ajong" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">종목</label>
            <input type="text" id="ajong" class="form-control"  /> 
          </div>
          <div class="col-md-3">
            <label for="apost1" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">우편번호</label>
            <input type="text" id="apost1" class="form-control"  onclick="sample4_execDaumPostcode()" />
          </div>
          <div class="col-md-3">
            <label for="ajuso1" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">주소</label>
            <input type="text" id="ajuso1"  maxlength="30" class="form-control mb-1" placeholder="기본 주소" /> 
          </div> 
          <div class="col-md-3"> 
            <label for="ajuso1" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">상세주소</label>
            <input type="text" id="ajuso2"  maxlength="20" class="form-control" placeholder="상세 주소" /> 
          </div> 
          <div class="col-md-3">
            <label for="atelno" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">대표전화</label>
            <input type="text" id="atelno" class="form-control"  />
          </div>
          <div class="col-md-3">
            <label for="atelno2" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">전화</label>
            <input type="text" id="atelno2" class="form-control"  />
          </div>
          <div class="col-md-3">
            <label for="adam1" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">담당자</label>
            <input type="text" id="adam1" class="form-control"  />
          </div>
          <div class="col-md-3">
            <label for="abuse1" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">담당자연락처</label>
            <input type="text" id="abuse1" class="form-control"  />
          </div>
          <div class="col-md-3">
            <label for="ahand" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">핸드폰</label>
            <input type="text" id="ahand" class="form-control"  />
          </div>
          <div class="col-md-3">
            <label for="aemail" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">이메일</label>
            <input type="text" id="aemail" class="form-control"  />
          </div>
          <div class="col-md-3">
            <label for="adomain" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">홈페이지</label>
            <input type="text" id="adomain" class="form-control"  />
          </div>
          <div class="col-md-3">
            <label for="afax" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">팩스</label>
            <input type="text" id="afax" class="form-control"  />
          </div>
          <div class="col-md-3">
            <label for="abigo" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">비고</label>
            <textarea class="form-control" aria-label="With textarea" name="abigo" id="abigo" ></textarea>
          </div> 
        </form>
      </div>
    </div>
  </div>
 

      
 
    <!--  모달 처리 -->
    <input class="form-control form-control-sm"  type="hidden" id="innamebtn" data-bs-toggle="modal" data-bs-target="#insamodal"  /> 
    <!--------------------------------------------------------------------------------------->   
    <div class="modal fade" id="insamodal" data-bs-keyboard="false"
    data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel"
    aria-hidden="true">
        <div class="modal-dialog modal-lg mt-6" role="document" id = "modalForm01"
            style="max-width: 600px">
            <div class="modal-content border-0">
                <div class="modal-body p-0" > 
                    <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">                            
                        <div class="search">
                            <div class="input_wrap">  
                                <input class="form-control form-control-sm" id="searchCode" type="text"   onkeyup="if(window.event.keyCode==13){insaList_rtn('M')}"
                                placeholder="사원명 "     />                                      
                            </div>
                            <button id="winnameBtn">
                                <img th:src="@{/assets/images/i_search.png}" alt=""> 
                            </button>
                        </div>                             
                    </div>   
                    <div class="container-fluid"> 
                        <div id="winnameGrid_div" ></div>
                        <div id="thePager02"></div>
                    </div>   
                </div>  

                <div class="modal-footer">
                    <div class="row g-1">
                        <div class="col-auto">
                            <button class="badge-soft-primary dropdown-item rounded-1"
                                type="button"  id="winnamemodal_btn" data-bs-dismiss="modal">Close</button>
                        </div> 
                    </div>
                </div>   

            </div>
        </div> 
    </div>  
  


    <!--------------------------------------------------------------------------------------->   
    <!-- 거래처현황 MODAL ForM  -->  
    <div class="modal fade" id="gomodal" data-bs-keyboard="false"
    data-bs-backdrop="static" aria-labelledby="staticBackdropLabel"
    aria-hidden="true">
        <div class="modal-dialog modal-lg mt-6" role="document" id ="modalForm01" style="max-width: 80%">
            <div class="modal-content">                   
                <div class="modal-body p-0" > 
                    <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">

                        <!-- <div class="search">
                            <div class="input_wrap">
                                <input class="form-control form-control-sm" id="searchx5Code" type="text" onkeyup="if(window.event.keyCode==13){searchtxt9_rtn()}"
                                placeholder="거래처현황 " />                                      
                            </div>
                            <button id="wgoBtn">
                                <img th:src="@{/assets/images/i_search.png}" alt=""> 
                            </button>                            
                        </div>   -->
                        <div class="infor_bar type2" style="display: flex; justify-content: space-between; align-items: flex-end; flex-wrap: wrap; padding: 10px 15px;">
                            <!-- 좌측 검색영역 -->
                            <div class="left" style="display: flex; gap: 20px; flex-wrap: wrap;">
                                <!-- 업체구분 -->
                                <div style="display: flex; align-items: center;">
                                    <span class="input-group-text" style="height: 28px; font-size: 13px; background: #e9eff2; border: 1px solid #ccc;">업체구분</span>
                                    <select class="form-select" name="conacorp1" id="conacorp1" style="height: 28px; font-size: 13px; border: 1px solid #ccc;">
                                        <option value="">선택</option>
                                        <option th:each="val : ${cifcodeList}" th:value="${val.cifcode}" th:text="${val.cifcodename}"></option>
                                    </select>
                                </div>
                        
                                <!-- 검색어 -->
                                <div style="display: flex; align-items: center;">
                                    <span class="input-group-text" style="height: 28px; font-size: 13px; background: #e9eff2; border: 1px solid #ccc;">검색어</span>
                                    <input class="form-control" type="text" id="conacorp" placeholder="거래처명 / 거래처코드"
                                           style="height: 28px; font-size: 13px; border: 1px solid #ccc; width: 200px;">
                                </div>
                            </div>
                        
                            <!-- 조회 버튼 -->
                            <div class="right" style="margin-top: 10px;">
                                <button type="button" class="color2" id="wciflistBtn"
                                        style="height: 30px; padding: 0 15px; background: #1c6b92; color: white; border: none; font-size: 13px; border-radius: 3px;">
                                    <i style="margin-right: 4px;"><img th:src="@{/assets/images/i_search.png}" alt="" style="vertical-align: middle; width: 14px;"></i>
                                    조회
                                </button>
                            </div>
                        </div>
                                             
                    </div>   
                    <div class="box_wrap with_tit" style="padding: 10px;">
                        <div class="container-fluid" style="padding: 10px;">
                            <div id="wtab02Grid_div" ></div>
                            <!-- <div  id="tab02Pager"></div> -->
                        </div>   
                    </div>
                </div>  

                <div class="modal-footer">
                    <div class="row g-1">
                        <div class="col-auto">
                            <button class="badge-soft-primary dropdown-item rounded-1"
                                type="button"  id="wciflist_rtn" data-bs-dismiss="modal">Close</button>
                        </div> 
                    </div>
                </div>   

            </div>
        </div> 
    </div>  
    <!--------------------------------------------------------------------------------------->   


    <!--########################################자바 스크립트 시작-->
    <script th:inline="javascript"> 
        // 그리드 호출 window.onload 
        var view_p01tab01page;
        var view_innamepage;  
        var view_p01tab02page;
        var wtab01Grid;        
        var wtab02Grid;        
        var winnameGrid;  
        var typeMenu;  
        var treemap; 
        var insaflag = "";
        let barchart;
        let ani;
        var wseries_data = [0];  
        var rowCount = 0;
        var cellCount = 100;
        // 폼 저장시  file data 와   string data 담을 변수 
        let formData = new FormData(); 



        window.onload = function() {  
                // localStorage.setItem("setpage", "app10p001");
                // **************거래처현황 LIST************************************************ 
                // console.log("[window onload] : [start]");
                //tab01 grid list
            // var data = getData_tab01(100);
            view_p01tab01page = new wijmo.collections.CollectionView(getData_tab01(), {
                // sortDescriptions: [new wijmo.collections.SortDescription("acode", false)],
                // pageSize: 21
            });
        // tab01 grid page
            // new wijmo.input.CollectionViewNavigator('#tab01Pager', {
            //     byPage: true,
            //     headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
            //     cv: view_p01tab01page
            // });      
            
            wtab01Grid = new wijmo.grid.FlexGrid('#wtab01Grid_div', {  
                autoGenerateColumns: false,
                showMarquee: true,
                isReadOnly: false, 
                allowSorting: 'MultiColumn',
                // selectionMode: 'RowRange',
                alternatingRowStep: 0,
                columns: [   
                    { binding: 'acorp', 
                      header: '거래처명', 
                      align: "left", 
                        cellTemplate: wijmo.grid.cellmaker.CellMaker.makeLink({ 
                            text: '<b>${item.acorp}</b>',
                            click: (e, ctx) => {
                                wcifChk_a(ctx.item.acorp1, ctx.item.acorp2, ctx.item.acorp3, ctx.item.acode, ctx.item.acorp,ctx.item.asano1, ctx.item.asano2, ctx.item.asano3, ctx.item.aname, ctx.item.aupte, ctx.item.ajong,ctx.item.apost1, ctx.item.ajuso1, ctx.item.ajuso2, ctx.item.abigo, ctx.item.agita, ctx.item.ajumi1, ctx.item.ajumi2,ctx.item.aascode1, ctx.item.aascode2, ctx.item.atelno, ctx.item.atelno2, ctx.item.aemail, ctx.item.ahand, ctx.item.abonsadam1, ctx.item.abonsadam2, ctx.item.abonsadam3, ctx.item.adomain, ctx.item.afax, ctx.item.inname01, ctx.item.inname02, ctx.item.inname03, ctx.item.abuse1, ctx.item.adam1 );                    
                            }
                        }),
                      width: 150
                    },  
                    { binding: 'atelno', header: '전화번호', align: "left", width: 130 }, 
                    { binding: 'asanotxt', 
                      header: '사업자번호', 
                      align: "center", 
                        cellTemplate: wijmo.grid.cellmaker.CellMaker.makeLink({ 
                            text: '<b>${item.asanotxt}</b>',
                            click: (e, ctx) => {
                                wcifChk_a(ctx.item.acorp1, ctx.item.acorp2, ctx.item.acorp3, ctx.item.acode, ctx.item.acorp,ctx.item.asano1, ctx.item.asano2, ctx.item.asano3, ctx.item.aname, ctx.item.aupte, ctx.item.ajong,ctx.item.apost1, ctx.item.ajuso1, ctx.item.ajuso2, ctx.item.abigo, ctx.item.agita, ctx.item.ajumi1, ctx.item.ajumi2,ctx.item.aascode1, ctx.item.aascode2, ctx.item.atelno, ctx.item.atelno2, ctx.item.aemail, ctx.item.ahand, ctx.item.abonsadam1, ctx.item.abonsadam2, ctx.item.abonsadam3, ctx.item.adomain, ctx.item.afax, ctx.item.inname01, ctx.item.inname02, ctx.item.inname03, ctx.item.abuse1, ctx.item.adam1 );                    
                            }
                        }),
                      width: 150
                    },              
                    { binding: 'aname', header: '대표자', align: "center", width: 100 },  
                    { binding: 'aupte', header: '업태', align: "center", width: 80 },  
                    { binding: 'ajong', header: '업종', align: "center", width: 80 },          
                    { binding: 'atelno2', header: '전화번호2', align: "left", width: 130 },        
                    { binding: 'ahand', header: '핸드폰', align: "left", width: 130 },                     
                    { binding: 'aemail', header: '메일', align: "left", width: 200 },     
                    { binding: 'ajusotxt', header: '주소', align: "center", width: 200 },    
                    { binding: 'inname01', header: '담당(현)', align: "left", width: 100 },        
                    { binding: 'inname02', header: '담당', align: "left", width: 100 },        
                    { binding: 'inname03', header: '담당', align: "center", width: 100 },                         
                    
                ], 
                itemsSource: view_p01tab01page,  
            });        
    
            
                new FlexGridContextMenu(wtab01Grid);
                // 그룹 패널 생성
                // var theGroupPanel = new wijmo.grid.grouppanel.GroupPanel('#theGroupPanel', {
                //     placeholder: '그룹을 만들려면 열을 여기로 끌어다 놓아주세요.  마우스 우 클릭하시면 엑셀로 받으실 수 있습니다.',
                //     grid: wtab01Grid
                // }); 
                // 선택기 생성
                // let selector = new wijmo.grid.selector.Selector(wtab01Grid, {
                //     itemChecked: () => {
                //         showCheckedCount();
                //     }
                // });  
                // 헤더 열 전환
                setHeaderColumn(false);
                function setHeaderColumn(headerOn) {
                    wtab01Grid.headersVisibility = headerOn
                    ? wijmo.grid.HeadersVisibility.All
                    : wijmo.grid.HeadersVisibility.Column;
                    // selector.column = headerOn
                    // ? wtab01Grid.rowHeaders.columns[0]
                    // : wtab01Grid.columns[0];
                } 
                wtab01Grid.showMarquee = true;
                wtab01Grid.focus();
                wijmo.toggleClass(wtab01Grid.hostElement, 'highlightActive', true);
                wtab01Grid.focus();

    
            // tab01검색 데이터 수집
            function getData_tab01(scnt, start){      
                var wtab01Dto = [[${index07List}]];   
                var wactnm_data = [];          
                var cnt = 1;   
                if (!start)
                    start = 0;
                rowCount = wtab01Dto.length; 
                for (var i = 0; i < rowCount; i++) {
                    wactnm_data.push({
                        id: i + start, 
                        index: cnt,
                        acorp1: wtab01Dto[i]["acorp1"], 
                        acorp2: wtab01Dto[i]["acorp2"], 
                        acorp3: wtab01Dto[i]["acorp3"], 
                        acode: wtab01Dto[i]["acode"], 
                        acorp: wtab01Dto[i]["acorp"], 
                        asano1: wtab01Dto[i]["asano1"], 
                        asano2: wtab01Dto[i]["asano2"], 
                        asano3: wtab01Dto[i]["asano3"], 
                        asanotxt: wtab01Dto[i]["asanotxt"], 
                        aname: wtab01Dto[i]["aname"], 
                        aupte: wtab01Dto[i]["aupte"], 
                        ajong: wtab01Dto[i]["ajong"], 
                        apost1: wtab01Dto[i]["apost1"], 
                        ajuso1: wtab01Dto[i]["ajuso1"], 
                        ajuso2: wtab01Dto[i]["ajuso2"],
                        ajusotxt: wtab01Dto[i]["ajusotxt"],  
                        abigo: wtab01Dto[i]["abigo"], 
                        agita: wtab01Dto[i]["agita"], 
                        ajumi1: wtab01Dto[i]["ajumi1"], 
                        ajumi2: wtab01Dto[i]["ajumi2"], 
                        ajumitxt: wtab01Dto[i]["ajumitxt"],  
                        aascode1: wtab01Dto[i]["aascode1"], 
                        aascode2: wtab01Dto[i]["aascode2"], 
                        aascodetxt: wtab01Dto[i]["aascodetxt"],  
                        atelno: wtab01Dto[i]["atelno"], 
                        atelno2: wtab01Dto[i]["atelno2"], 
                        aemail: wtab01Dto[i]["aemail"],   
                        ahand: wtab01Dto[i]["ahand"],   
                        abonsadam1: wtab01Dto[i]["abonsadam1"],   
                        abonsadam2: wtab01Dto[i]["abonsadam2"],   
                        abonsadam3: wtab01Dto[i]["abonsadam3"],   
                        adomain: wtab01Dto[i]["adomain"],   
                        afax: wtab01Dto[i]["afax"],  
                        abuse1: wtab01Dto[i]["abuse1"],   
                        adam1: wtab01Dto[i]["adam1"],   
                        inname01: wtab01Dto[i]["inname01"],   
                        inname02: wtab01Dto[i]["inname02"],   
                        inname03: wtab01Dto[i]["inname03"],      
                        
                    });
                    cnt++;
                }      
                return wactnm_data;                                         
            } 


            // 거래처현황 리스트     
            // // ################################################################

            view_p01tab02page = new wijmo.collections.CollectionView(getData_tab02(), {
                sortDescriptions: [new wijmo.collections.SortDescription("acode", false)],
                //pageSize: 18
            });
        // tab02 grid page
            // new wijmo.input.CollectionViewNavigator('#tab02Pager', {
            //     byPage: true,
            //     headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
            //     cv: view_p01tab02page
            // });      
            wtab02Grid = new wijmo.grid.FlexGrid('#wtab02Grid_div', {  
                autoGenerateColumns: false,
                showMarquee: true,
                isReadOnly: false,  
                frozenColumns: 2,
                // selectionMode: 'RowRange',
                allowSorting: 'MultiColumn',
                alternatingRowStep: 0,
                columns: [     
                    {
                        binding: 'acode',
                        width: 80,
                        header: '코드', 
                        align:"center",
                        cellTemplate: wijmo.grid.cellmaker.CellMaker.makeLink({ 
                            text: '<b>${item.acode}</b>',
                            click: (e, ctx) => {
                                wcifChk_a(ctx.item.acorp1, ctx.item.acorp2, ctx.item.acorp3, ctx.item.acode, ctx.item.acorp,ctx.item.asano1, ctx.item.asano2, ctx.item.asano3, ctx.item.aname, ctx.item.aupte, ctx.item.ajong,ctx.item.apost1, ctx.item.ajuso1, ctx.item.ajuso2, ctx.item.abigo, ctx.item.agita, ctx.item.ajumi1, ctx.item.ajumi2,ctx.item.aascode1, ctx.item.aascode2, ctx.item.atelno, ctx.item.atelno2, ctx.item.aemail, ctx.item.ahand, ctx.item.abonsadam1, ctx.item.abonsadam2, ctx.item.abonsadam3, ctx.item.adomain, ctx.item.afax, ctx.item.inname01, ctx.item.inname02, ctx.item.inname03, ctx.item.abuse1, ctx.item.adam1 );                    
                            }
                        })
                    }, 
                    { binding: 'acorp', header: '거래처명', align: "left", width: 200 },  
                    { binding: 'cifcodename', header: '구분', align: "center", width: 100 },                 
                    { binding: 'asanotxt', header: '사업자번호', align: "center", width: 150 },  
                    { binding: 'aname', header: '대표자', align: "center", width: 100 },  
                    { binding: 'aupte', header: '업태', align: "center", width: 80 },  
                    { binding: 'ajong', header: '업종', align: "center", width: 80 },  
                    { binding: 'atelno', header: '전화번호', align: "left", width: 130 },        
                    { binding: 'atelno2', header: '전화번호2', align: "left", width: 130 },        
                    { binding: 'ahand', header: '핸드폰', align: "left", width: 130 },                     
                    { binding: 'aemail', header: '메일', align: "left", width: 200 },   
                    { binding: 'apost1', header: '우편번호', align: "center", width: 80 },  
                    { binding: 'ajusotxt', header: '주소', align: "center", width: 200 },    
                    { binding: 'inname01', header: '담당(현)', align: "left", width: 100 },        
                    { binding: 'inname02', header: '담당', align: "left", width: 100 },        
                    { binding: 'inname03', header: '담당', align: "center", width: 100 },  
                    { binding: 'adomain', header: '홈페이지', align: "center", width: 200 },              
                    
                ], 
                itemsSource: view_p01tab02page
            });       
    

            new FlexGridContextMenu(wtab02Grid);
                // 그룹 패널 생성
                // var theGroupPanel = new wijmo.grid.grouppanel.GroupPanel('#theGroupPanel', {
                //     placeholder: '그룹을 만들려면 열을 여기로 끌어다 놓아주세요.  마우스 우 클릭하시면 엑셀로 받으실 수 있습니다.',
                //     grid: wtab02Grid
                // }); 
                // 선택기 생성
                // selector = new wijmo.grid.selector.Selector(wtab02Grid, {
                //     itemChecked: () => {
                //         showCheckedCount();
                //     }
                // }); 
                // 헤더 열 전환
                setHeaderColumn02(false);
                function setHeaderColumn02(headerOn) {
                    wtab02Grid.headersVisibility = headerOn
                    ? wijmo.grid.HeadersVisibility.All
                    : wijmo.grid.HeadersVisibility.Column;
                    selector.column = headerOn
                    ? wtab02Grid.rowHeaders.columns[0]
                    : wtab02Grid.columns[0];
                } 
                wtab02Grid.showMarquee = true;
                wtab02Grid.focus();
                wijmo.toggleClass(wtab02Grid.hostElement, 'highlightActive', true);
                wtab02Grid.focus();

    
            // tab01검색 데이터 수집
            function getData_tab02(){    
                var wtab01Dto = [[${index07List}]];   
                var wactnm_data = [];   
                var cnt = 1;   
                for (var i = 0; i < wtab01Dto.length; i++) {
                    wactnm_data.push({
                        id: i, 
                        index: cnt,
                        acorp1: wtab01Dto[i]["acorp1"], 
                        acorp2: wtab01Dto[i]["acorp2"], 
                        acorp3: wtab01Dto[i]["acorp3"], 
                        acode: wtab01Dto[i]["acode"], 
                        cifcodename: wtab01Dto[i]["cifcodename"], 
                        acorp: wtab01Dto[i]["acorp"], 
                        asano1: wtab01Dto[i]["asano1"], 
                        asano2: wtab01Dto[i]["asano2"], 
                        asano3: wtab01Dto[i]["asano3"], 
                        asanotxt: wtab01Dto[i]["asanotxt"], 
                        aname: wtab01Dto[i]["aname"], 
                        aupte: wtab01Dto[i]["aupte"], 
                        ajong: wtab01Dto[i]["ajong"], 
                        apost1: wtab01Dto[i]["apost1"], 
                        ajuso1: wtab01Dto[i]["ajuso1"], 
                        ajuso2: wtab01Dto[i]["ajuso2"],
                        ajusotxt: wtab01Dto[i]["ajusotxt"],  
                        abigo: wtab01Dto[i]["abigo"], 
                        agita: wtab01Dto[i]["agita"], 
                        ajumi1: wtab01Dto[i]["ajumi1"], 
                        ajumi2: wtab01Dto[i]["ajumi2"], 
                        ajumitxt: wtab01Dto[i]["ajumitxt"],  
                        aascode1: wtab01Dto[i]["aascode1"], 
                        aascode2: wtab01Dto[i]["aascode2"], 
                        aascodetxt: wtab01Dto[i]["aascodetxt"],  
                        atelno: wtab01Dto[i]["atelno"], 
                        atelno2: wtab01Dto[i]["atelno2"], 
                        aemail: wtab01Dto[i]["aemail"],   
                        ahand: wtab01Dto[i]["ahand"],   
                        abonsadam1: wtab01Dto[i]["abonsadam1"],   
                        abonsadam2: wtab01Dto[i]["abonsadam2"],   
                        abonsadam3: wtab01Dto[i]["abonsadam3"],   
                        adomain: wtab01Dto[i]["adomain"],   
                        afax: wtab01Dto[i]["afax"],   
                        abuse1: wtab01Dto[i]["abuse1"],   
                        adam1: wtab01Dto[i]["adam1"],  
                        inname01: wtab01Dto[i]["inname01"],   
                        inname02: wtab01Dto[i]["inname02"],   
                        inname03: wtab01Dto[i]["inname03"],      
                        
                    });
                    cnt++;
                }      
                return wactnm_data;                                         
            } 
    
            // // ################################################################

            //사원현황 Modalㅁ
            view_innamepage = new wijmo.collections.CollectionView(getData_wlist(), {
                pageSize: 12
            });
            // 고장부위 페이지 이동
            new wijmo.input.CollectionViewNavigator('#thePager02', {
                byPage: true,
                headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
                cv: view_innamepage
            });     
            winnameGrid = new wijmo.grid.FlexGrid('#winnameGrid_div', {  
                autoGenerateColumns: false,
                isReadOnly: false, 
                allowSorting: 'MultiColumn',
                selectionMode: 'RowRange',
                alternatingRowStep: 0,
                columns: [     
                    { binding: 'insano', header: '코드', align: "center", width: '1*' },
                    { binding: 'inname', header: '사원명', align: "center", width: '1*' },
                ], 
                itemsSource: view_innamepage
            });  
            
            winnameGrid.showMarquee = true;
            winnameGrid.focus();
            wijmo.toggleClass(winnameGrid.hostElement, 'highlightActive', true);
            winnameGrid.focus();
            // 고장부위 데이터 수집
            function getData_wlist(){   
                var winname_data = []; 
                var cnt = 1;
                for (var i = 0; i < 12; i++) {
                    winname_data.push({
                        id: i, 
                        index: cnt,
                        insano:"",
                        inname: "",                            
                    });
                    cnt++;
                }    
                return winname_data;                                      
            }   

        } //window 호출 끝

    
        function delete_btn(){             
            if (!confirm("삭제하시겠습니까?")) {
                return ; 
            }               
            var ls_acode = document.getElementById('acode').value;       

            $.ajax({
                url: '/app01m/index07/del',   
                type:"POST", 
                data: {
                    "ascode" : ls_acode 
                },
                async:false,
                success:function(data){ 
                    if(data == "success"){  
                        alert("삭제되었습니다.")
                        // console.log("delete", data);                     
                        $("#retrieveBtn").trigger("click"); 
                        // listUp();   
                    }else{
                        alert("삭제중 오류가 발생했습니다. 관리자에게 문의하세요.")                             
                    }   
                },error:function(e){
                    console.log('error',e);
                }
            }).done(function(fragment){           
            })
            clear_rtn();  
        }
        
        //초기화 function
        function clear_rtn(elem){
            document.getElementById('acorp1').value = ""; 
                document.getElementById('acorp2').value = "";  
                document.getElementById('acorp3').value = "";;
                document.getElementById('acode').value = "";
                document.getElementById('acorp').value = "";
                document.getElementById('asano1').value = "";  
                document.getElementById('asano2').value = "";
                document.getElementById('asano3').value = ""; 
                document.getElementById('aname').value = "";
                document.getElementById('aupte').value = ""; 
                document.getElementById('ajong').value = "";
                document.getElementById('apost1').value = "";
                document.getElementById('ajuso1').value = "";
                document.getElementById('ajuso2').value = "";
                document.getElementById('abigo').value = "";
                // document.getElementById('agita').value = "";
                document.getElementById('ajumi1').value = "";
                document.getElementById('ajumi2').value = "";
                // document.getElementById('aascode1').value = "";
                // document.getElementById('aascode2').value = "";
                document.getElementById('atelno').value  = "";
                document.getElementById('atelno2').value = "";
                document.getElementById('aemail').value = "";
                document.getElementById('ahand').value = "";
                // document.getElementById('abonsadam1').value = "";
                // document.getElementById('abonsadam2').value = "";
                // document.getElementById('abonsadam3').value = "";
                document.getElementById('adomain').value = "";
                document.getElementById('afax').value = "";
                document.getElementById('abuse1').value = "";
                document.getElementById('adam1').value = "";
                // document.getElementById('inname01').value = "";
                // document.getElementById('inname02').value = "";
                // document.getElementById('inname03').value = "";  
        }
        // <!-- 저장 스크립트 시작 -->
        function save_btn(){   
                    
            var ls_acorp1 = document.getElementById('acorp1').value; 
            var ls_acorp2 = document.getElementById('acorp2').value;  
            var ls_acorp3 = document.getElementById('acorp3').value; 
            var ls_acode = document.getElementById('acode').value; 
            var ls_acorp = document.getElementById('acorp').value ; 
            var ls_asano1 = document.getElementById('asano1').value;    
            var ls_asano2 = document.getElementById('asano2').value; 
            var ls_asano3 = document.getElementById('asano3').value; 
            var ls_aname = document.getElementById('aname').value; 
            var ls_aupte = document.getElementById('aupte').value;  
            var ls_ajong = document.getElementById('ajong').value;  
            var ls_apost1 = document.getElementById('apost1').value ;  
            var ls_ajuso1 = document.getElementById('ajuso1').value ;  
            var ls_ajuso2 = document.getElementById('ajuso2').value; 
            var ls_abigo = document.getElementById('abigo').value; 
            var ls_agita = ""; //document.getElementById('agita').value ; 
            var ls_ajumi1 = document.getElementById('ajumi1').value; 
            var ls_ajumi2 = document.getElementById('ajumi2').value ; 
            var ls_aascode1 = ""; //document.getElementById('aascode1').value ; 
            var ls_aascode2 = ""; //document.getElementById('aascode2').value ; 
            var ls_atelno = document.getElementById('atelno').value ; 
            var ls_atelno2 = document.getElementById('atelno2').value; 
            var ls_aemail = document.getElementById('aemail').value ; 
            var ls_ahand = document.getElementById('ahand').value; 
            // var ls_abonsadam1 = document.getElementById('abonsadam1').value; 
            // var ls_abonsadam2 = document.getElementById('abonsadam2').value ; 
            // var ls_abonsadam3 = document.getElementById('abonsadam3').value; 
            var ls_adomain = document.getElementById('adomain').value; 
            var ls_afax = document.getElementById('afax').value ;
            var ls_adam1 = document.getElementById('adam1').value ;
            var ls_abuse1 = document.getElementById('abuse1').value ; 
            // var ls_inname01 = document.getElementById('inname01').value ; 
            // var ls_inname02 = document.getElementById('inname02').value ; 
            // var ls_inname03 = document.getElementById('inname03').value;  
                
            // if(ls_inname01 == null || ls_inname01.length == 0 || ls_inname01 == ""){ 
            //     ls_abonsadam1 = "";
            // }                      
            // if(ls_inname02 == null || ls_inname02.length == 0 || ls_inname02 == ""){ 
            //     ls_abonsadam2 = "";
            // }                      
            // if(ls_inname03 == null || ls_inname03.length == 0 || ls_inname03 == ""){ 
            //     ls_abonsadam3 = "";
            // }                                      
            

            
                if (!confirm("저장하시겠습니까?")) {
                        return ; 
                    }   
                if(!ls_acorp){
                    alert("거래처명을 입력하세요")
                        return ; 
                } 
                if(!ls_atelno){
                    alert("전화번호를 입력하세요") 
                        return ;                 
                }       

                if(ls_acorp1 == null || ls_acorp1.length == 0 || ls_acorp1 == ""){ 
                        alert("업체구분을 선택하세요") 
                        document.getElementById("acorp1").focus(); 
                        return ;               
                }             
                if(ls_asano1 != null && ls_asano1.length > 0 && ls_asano1 != ""){
                    if(ls_asano1.length != 3){
                        alert("사업자번호 첫번째 자리는 3자리로 입력해주세요")  
                        document.getElementById("asano1").focus(); 
                        return ;                 
                    }
                }       
                if(ls_asano2 != null && ls_asano2.length > 0 && ls_asano2 != ""){
                    if(ls_asano2.length != 2){
                        alert("사업자번호 두번째 자리는 2자리로 입력해주세요")   
                        document.getElementById("asano2").focus(); 
                        return ;                 
                    }
                }       
                if(ls_asano3 != null && ls_asano3.length > 0 && ls_asano3 != ""){
                    if(ls_asano3.length != 5){
                        alert("사업자번호 세번째 자리는 5자리로 입력해주세요")    
                        document.getElementById("asano3").focus(); 
                        return ;                 
                    }
                }      
                // if(ls_inname01 != null && ls_inname01.length > 0 && ls_inname01 != ""){ 
                //     if(ls_abonsadam1 == null || ls_abonsadam1.length == 0 || ls_abonsadam1 == ""){ 
                //         alert(ls_inname01 + " : 담당사원의 코드를 선택하세요.")    
                //         document.getElementById("inname01").focus();  
                //         return ;               
                //     } 
                // }    
                // if(ls_inname02 != null && ls_inname02.length > 0 && ls_inname02 != ""){ 
                //     if(ls_abonsadam2 == null || ls_abonsadam2.length == 0 || ls_abonsadam2 == ""){ 
                //         alert(ls_inname02 + " : 담당사원의 코드를 선택하세요.")     
                //         document.getElementById("inname02").focus();  
                //         return ;               
                //     } 
                // }     
                // if(ls_inname03 != null && ls_inname03.length > 0 && ls_inname03 != ""){ 
                //     if(ls_abonsadam3 == null || ls_abonsadam3.length == 0 || ls_abonsadam3 == ""){ 
                //         alert(ls_inname03 + " : 담당사원의 코드를 선택하세요.")     
                //         document.getElementById("inname03").focus();  
                //         return ;               
                //     } 
                // }   
                if(ls_ajumi1 != null && ls_ajumi1.length > 0 && ls_ajumi1 != ""){
                    if(ls_ajumi1.length != 6){
                        alert("법인번호 첫번째 자리는 6자리로 입력해주세요")     
                        document.getElementById("ajumi1").focus();  
                        return ;                 
                    }
                }    
                if(ls_ajumi2 != null && ls_ajumi2.length > 0 && ls_ajumi2 != ""){
                    if(ls_ajumi2.length != 7){
                        alert("법인번호 두번째 자리는 7자리로 입력해주세요")     
                        document.getElementById("ajumi2").focus();  
                        return ;                 
                    }
                }      
                if(ls_aascode1 != null && ls_aascode1.length > 0 && ls_aascode1 != ""){
                    if(ls_aascode1.length != 6){
                        alert("주민번호 첫번째 자리는 6자리로 입력해주세요")     
                        document.getElementById("aascode1").focus();  
                        return ;                 
                    }
                }    
                if(ls_aascode2 != null && ls_aascode2.length > 0 && ls_aascode2 != ""){
                    if(ls_aascode2.length != 7){
                        alert("주민번호 두번째 자리는 7자리로 입력해주세요")     
                        document.getElementById("aascode2").focus();  
                        return ;                 
                    }
                }    
                
                
                var inputdata = {  
                    "acorp1" : ls_acorp1,
                    "acorp2": ls_acorp2 , 
                    "acorp3"   : ls_acorp3, 
                    "acode": ls_acode , 
                    "acorp"   : ls_acorp, 
                    "asano1"   : ls_asano1,
                    "asano2"   : ls_asano2, 
                    "asano3": ls_asano3 , 
                    "aname" : ls_aname,
                    "aupte":  ls_aupte,
                    "ajong":  ls_ajong,
                    "apost1" :  ls_apost1,
                    "ajuso1" :  ls_ajuso1, 
                    "ajuso2" :  ls_ajuso2, 
                    "abigo" :  ls_abigo, 
                    "agita" :  ls_agita, 
                    "ajumi1" :  ls_ajumi1, 
                    "ajumi2" :  ls_ajumi2,                 
                    "aascode1"   : ls_aascode1, 
                    "aascode2"   : ls_aascode2,
                    "atelno" : ls_atelno,
                    "atelno2" : ls_atelno2,
                    "aemail"   : ls_aemail,
                    "ahand" : ls_ahand,
                    "adam1" : ls_adam1,
                    "abuse1" : ls_abuse1,
                    // "abonsadam3" : ls_abonsadam3, 
                    "adomain" : ls_adomain,                
                    "afax" : ls_afax          
                } 
                //직전 데이타가 메모리에 남아 폼데이타 키를 삭제후 다시 데이타를 전송해야함. 
                formData.delete("key");  
                // console.log(inputdata);

            formData.append("key", new Blob([ JSON.stringify(inputdata) ], {type : "application/json"}));
            
                $.ajax({
                        url: '/app01m/index07/save',
                        type: "POST",   
                        processData : false,                //  processData : false로 선언 시 formData를 string으로 변환하지 않음
                        contentType : false,                // contentType : false 로 선언 시 content-type 헤더가 multipart/form-data로 전송되게     
                        data: formData,                   
                        async:false,
                    success:function(data){
                        if(data == "success"){
                            alert("저장되었습니다.")
                            // console.log(formData);
                            searchList_rtn("%");              
                        }else{                       
                            alert("저장중 오류가 발생했습니다. 관리자에게 문의하세요.")
                            // listUp();
                            console.log(data);  
                        }
                    },error:function(e){
                        console.log('error',e);
                    }
                })            
                // return false;
        }

        function clearFormData( fd )
        {
        for( var prop in fd )
        {
            if ( typeof fd[ prop ] != "function" )
            {
            fd[ prop ] = "";
            }
        }
        }


        function listUp(){
            window.location.href = '/app01/index07';
        }; 


    //@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ 모달 검색@@@@@@@@@@@@@@@@@@@@@@@@@@@
    //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
            
    //사원검색 
    //
            // document.getElementById("inname01").addEventListener("keyup", (e)=>{ 
            //     if(e.keyCode === 13){  
            //         document.getElementById("innamebtn").click();
            //         insaflag = "A"; 
            //         insaSearchList_rtn("A"); 
            //     }
            // });    
            // document.getElementById("inname02").addEventListener("keyup", (e)=>{ 
            //     if(e.keyCode === 13){ 
            //         document.getElementById("innamebtn").click();
            //         insaflag = "B"; 
            //         insaSearchList_rtn("B"); 
            //     }
            // });    
            // document.getElementById("inname03").addEventListener("keyup", (e)=>{ 
            //     if(e.keyCode === 13){ 
            //         document.getElementById("innamebtn").click();
            //         insaflag = "C"; 
            //         insaSearchList_rtn("C"); 
            //     }
            // });    
    
            document.getElementById("winnameBtn").addEventListener("click",function(){   
                insaSearchList_rtn("M");  
            })   
            //사원검색 검색  
            document.getElementById("searchCode").addEventListener("keyup", (e)=>{ 
                if(e.keyCode === 13){ 
                    insaSearchList_rtn("M"); 
                }
            });    
            
            
            document.getElementById("wciflistBtn").addEventListener("click",function(){   
                searchListTot_rtn();  
            })   
            //거래처현황 검색  
            document.getElementById("conacorp").addEventListener("keyup", (e)=>{ 
                if(e.keyCode === 13){ 
                    searchListTot_rtn(); 
                }
            });    
            
            function insaSearchList_rtn(arg){  
                var insaText = "";
                if(arg == "M"){
                    insaText = document.getElementById('searchCode').value;   
                }
                if(arg == "A"){
                    insaText = document.getElementById('inname01').value;   
                }
                if(arg == "B"){
                    insaText = document.getElementById('inname02').value;   
                }
                if(arg == "C"){
                    insaText = document.getElementById('inname03').value;   
                }
                
                $.ajax({
                            url: '/popup/insalist',  
                            type:"POST",
                            data: { 
                                "searchtxt" :insaText, 
                            }, 
                            async:false,
                            success:function(data){  
                                tabB_grid(data);
                            },error:function(e){
                                console.log("error");                            
                            }
                        }).done(function(fragment){           

                        })        

            }     
    
            function tabB_grid(data){
                var wtab01Dto  = data;    
                var wtab01_data = [];
                var cnt = 1;
                for (var i = 0; i < wtab01Dto.length; i++) {
                    wtab01_data.push({
                        id: i, 
                        index: cnt, 
                        insano: wtab01Dto[i]["insano"], 
                        inname: wtab01Dto[i]["inname"]       
                    });
                    cnt++;
                }     
                winnameGrid.columns.clear();  
                winnameGrid.autoGenerateColumns = false; 
                view_innamepage.sourceCollection  = wtab01_data;

                var cols = new wijmo.grid.Column(); 
                cols.binding = 'insano';
                cols.header = '코드';
                cols.align = "center";
                cols.width = '*';  
                cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
                    text: '<b>${item.insano}</b>',
                    click: (e, ctx) => {
                        winsaChk_a(ctx.item.inname, ctx.item.insano);  
                    }
                });
                winnameGrid.columns.push(cols);  
    
                cols = new wijmo.grid.Column(); 
                cols.binding = 'inname';
                cols.header = '사원명';
                cols.align = "center";
                cols.width = '*';  
                winnameGrid.columns.push(cols);  
        
            }     
            function winsaChk_a(arg1, arg2){  
                switch (insaflag){
                    case "A":
                        document.getElementById('inname01').value = arg1;  
                        document.getElementById('abonsadam1').value = arg2; 
                        break;
                    case "B":
                        document.getElementById('inname02').value = arg1;  
                        document.getElementById('abonsadam2').value = arg2; 
                        break;
                    case "C":
                        document.getElementById('inname03').value = arg1;  
                        document.getElementById('abonsadam3').value = arg2; 
                        break;
                    default:
                        break;
                } 
                
                $("#winnamemodal_btn").trigger("click");
            }      






            // 거래처검색   
            document.getElementById("retrieveBtn").addEventListener("click",function(){  
                let ls_searchtxt = document.getElementById('searchtxt').value;  
                searchList_rtn(ls_searchtxt); 

            })   
            //검색  
            document.getElementById("searchtxt").addEventListener("keyup", (e)=>{ 
                if(e.keyCode === 13){ 
                    var searchText = document.getElementById('searchtxt').value; 
                    searchList_rtn(searchText); 
                }
            });         
            function searchList_rtn(arg1){    
                $.ajax({
                            url: '/app01m/index07/list',  
                            type:"POST",
                            data: { 
                                "searchtxt" :arg1, 
                            }, 
                            async:false,
                            success:function(data){  
                                tabA_grid(data);
                            },error:function(e){
                                console.log("error");                            
                            }
                        }).done(function(fragment){           

                        })        

            }    

            //  tab01 grid data 수집
            function tabA_grid(data){
                var wtab01Dto  = data;    
                var wtab01_data = [];
                var cnt = 1;
                for (var i = 0; i < wtab01Dto.length; i++) {
                    wtab01_data.push({
                        id: i, 
                        index: cnt, 
                        acorp1: wtab01Dto[i]["acorp1"], 
                        acorp2: wtab01Dto[i]["acorp2"], 
                        acorp3: wtab01Dto[i]["acorp3"], 
                        acode: wtab01Dto[i]["acode"], 
                        acorp: wtab01Dto[i]["acorp"], 
                        asano1: wtab01Dto[i]["asano1"], 
                        asano2: wtab01Dto[i]["asano2"], 
                        asano3: wtab01Dto[i]["asano3"], 
                        asanotxt: wtab01Dto[i]["asanotxt"],  
                        aname: wtab01Dto[i]["aname"], 
                        aupte: wtab01Dto[i]["aupte"], 
                        ajong: wtab01Dto[i]["ajong"], 
                        apost1: wtab01Dto[i]["apost1"], 
                        ajuso1: wtab01Dto[i]["ajuso1"], 
                        ajuso2: wtab01Dto[i]["ajuso2"],
                        ajusotxt: wtab01Dto[i]["ajusotxt"],  
                        abigo: wtab01Dto[i]["abigo"], 
                        agita: wtab01Dto[i]["agita"], 
                        ajumi1: wtab01Dto[i]["ajumi1"], 
                        ajumi2: wtab01Dto[i]["ajumi2"], 
                        aascode1: wtab01Dto[i]["aascode1"], 
                        aascode2: wtab01Dto[i]["aascode2"], 
                        atelno: wtab01Dto[i]["atelno"], 
                        atelno2: wtab01Dto[i]["atelno2"], 
                        aemail: wtab01Dto[i]["aemail"],   
                        ahand: wtab01Dto[i]["ahand"],   
                        abonsadam1: wtab01Dto[i]["abonsadam1"],   
                        abonsadam2: wtab01Dto[i]["abonsadam2"],   
                        abonsadam3: wtab01Dto[i]["abonsadam3"],   
                        adomain: wtab01Dto[i]["adomain"],   
                        afax: wtab01Dto[i]["afax"],   
                        abuse1: wtab01Dto[i]["abuse1"],   
                        adam1: wtab01Dto[i]["adam1"],  
                        inname01: wtab01Dto[i]["inname01"],   
                        inname02: wtab01Dto[i]["inname02"],   
                        inname03: wtab01Dto[i]["inname03"],       
                    });
                    cnt++;
                }   
 
                wtab01Grid.columns.clear();  
                wtab01Grid.autoGenerateColumns = false; 
                view_p01tab01page.sourceCollection  = wtab01_data;

                // var cols = new wijmo.grid.Column(); 
                // cols.binding = 'acode';
                // cols.header = '코드';
                // cols.align = "center";
                // cols.width = 80;
                // wtab01Grid.columns.push(cols);  

                var cols = new wijmo.grid.Column(); 
                cols.binding = 'acorp';
                cols.header = '거래처명'; 
                cols.align = "left"; 
                cols.width = 180;
                cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
                    text: '<b>${item.acorp}</b>',
                    click: (e, ctx) => {
                        wcifChk_a(ctx.item.acorp1, ctx.item.acorp2, ctx.item.acorp3, ctx.item.acode, ctx.item.acorp,ctx.item.asano1, ctx.item.asano2, ctx.item.asano3, ctx.item.aname, ctx.item.aupte, ctx.item.ajong,ctx.item.apost1, ctx.item.ajuso1, ctx.item.ajuso2, ctx.item.abigo, ctx.item.agita, ctx.item.ajumi1, ctx.item.ajumi2,ctx.item.aascode1, ctx.item.aascode2, ctx.item.atelno, ctx.item.atelno2, ctx.item.aemail, ctx.item.ahand, ctx.item.abonsadam1, ctx.item.abonsadam2, ctx.item.abonsadam3, ctx.item.adomain, ctx.item.afax, ctx.item.inname01, ctx.item.inname02, ctx.item.inname03, ctx.item.abuse1, ctx.item.adam1 );                    
                        
                    }
                });
                wtab01Grid.columns.push(cols); 
                cols = new wijmo.grid.Column(); 
                cols.binding = 'atelno';
                cols.header = '전화번호';
                cols.align = "left";
                cols.width =  130 ;  
                wtab01Grid.columns.push(cols);  
                cols = new wijmo.grid.Column(); 
                cols.binding = 'asanotxt';
                cols.header = '사업자번호';
                cols.align = "center";
                cols.width =  150 ;  
                cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
                    text: '<b>${item.asanotxt}</b>',
                    click: (e, ctx) => {
                        wcifChk_a(ctx.item.acorp1, ctx.item.acorp2, ctx.item.acorp3, ctx.item.acode, ctx.item.acorp,ctx.item.asano1, ctx.item.asano2, ctx.item.asano3, ctx.item.aname, ctx.item.aupte, ctx.item.ajong,ctx.item.apost1, ctx.item.ajuso1, ctx.item.ajuso2, ctx.item.abigo, ctx.item.agita, ctx.item.ajumi1, ctx.item.ajumi2,ctx.item.aascode1, ctx.item.aascode2, ctx.item.atelno, ctx.item.atelno2, ctx.item.aemail, ctx.item.ahand, ctx.item.abonsadam1, ctx.item.abonsadam2, ctx.item.abonsadam3, ctx.item.adomain, ctx.item.afax, ctx.item.inname01, ctx.item.inname02, ctx.item.inname03, ctx.item.abuse1, ctx.item.adam1 );                    
                        
                    }
                });
                wtab01Grid.columns.push(cols); 
                cols = new wijmo.grid.Column(); 
                cols.binding = 'aname';
                cols.header = '대표자';
                cols.align = "center";
                cols.width =  100 ;  
                wtab01Grid.columns.push(cols); 
                cols = new wijmo.grid.Column(); 
                cols.binding = 'aupte';
                cols.header = '업태';
                cols.align = "center";
                cols.width =  80 ;  
                wtab01Grid.columns.push(cols); 
                cols = new wijmo.grid.Column(); 
                cols.binding = 'ajong';
                cols.header = '업종';
                cols.align = "center";
                cols.width =  80 ;  
                wtab01Grid.columns.push(cols); 
                cols = new wijmo.grid.Column(); 
                cols.binding = 'atelno2';
                cols.header = '전화번호2';
                cols.align = "center";
                cols.width =  100 ;  
                wtab01Grid.columns.push(cols); 
                cols = new wijmo.grid.Column(); 
                cols.binding = 'ahand';
                cols.header = '핸드폰';
                cols.align = "center";
                cols.width =  100 ;  
                wtab01Grid.columns.push(cols); 
                cols = new wijmo.grid.Column(); 
                cols.binding = 'aemail';
                cols.header = '메일';
                cols.align = "left";
                cols.width =  200 ;  
                wtab01Grid.columns.push(cols); 
                cols = new wijmo.grid.Column(); 
                cols.binding = 'ajusotxt';
                cols.header = '주소';
                cols.align = "center";
                cols.width =  200 ;  
                wtab01Grid.columns.push(cols); 
                cols = new wijmo.grid.Column(); 
                cols.binding = 'inname01';
                cols.header = '담당(현)';
                cols.align = "center";
                cols.width =  100 ;  
                wtab01Grid.columns.push(cols); 
                cols = new wijmo.grid.Column(); 
                cols.binding = 'inname02';
                cols.header = '담당';
                cols.align = "center";
                cols.width =  100 ;  
                wtab01Grid.columns.push(cols); 
                cols = new wijmo.grid.Column(); 
                cols.binding = 'inname03';
                cols.header = '담당';
                cols.align = "center";
                cols.width =  100 ;  
                wtab01Grid.columns.push(cols);  
        
            }        

            // wcifChk_a(ctx.item.acorp1, ctx.item.acorp2, ctx.item.acorp3, ctx.item.acode, ctx.item.acorp,ctx.item.asano1, ctx.item.asano2, ctx.item.asano3, ctx.item.aname, ctx.item.aupte,
            //  ctx.item.ajong,ctx.item.apost1, ctx.item.ajuso1, ctx.item.ajuso2, ctx.item.abigo, ctx.item.agita, ctx.item.ajumi1, ctx.item.ajumi2,ctx.item.aascode1, ctx.item.aascode2,
            //   ctx.item.atelno, ctx.item.atelno2, ctx.item.aemail, ctx.item.ahand, ctx.item.abonsadam1, ctx.item.abonsadam2, ctx.item.abonsadam3, ctx.item.adomain, ctx.item.afax 
                        
            function wcifChk_a(arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10, arg11, arg12, arg13, arg14, arg15, arg16, arg17, arg18, arg19, arg20, arg21, arg22, arg23, arg24, arg25, arg26, arg27, arg28, arg29, arg30, arg31, arg32, arg33, arg34){            
                document.getElementById('acorp1').value = arg1;  
                document.getElementById('acorp2').value = arg2;   
                document.getElementById('acorp3').value = arg3;
                document.getElementById('acode').value = arg4; 
                document.getElementById('acorp').value = arg5; 
                document.getElementById('asano1').value = arg6;   
                document.getElementById('asano2').value = arg7;
                document.getElementById('asano3').value = arg8; 
                document.getElementById('aname').value = arg9; 
                document.getElementById('aupte').value = arg10;   
                document.getElementById('ajong').value = arg11; 
                document.getElementById('apost1').value = arg12; 
                document.getElementById('ajuso1').value = arg13; 
                document.getElementById('ajuso2').value = arg14; 
                document.getElementById('abigo').value = arg15;
                // document.getElementById('agita').value = arg16;
                document.getElementById('ajumi1').value = arg17;
                document.getElementById('ajumi2').value = arg18;
                // document.getElementById('aascode1').value = arg19; 
                // document.getElementById('aascode2').value = arg20;
                document.getElementById('atelno').value = arg21;
                document.getElementById('atelno2').value = arg22;
                document.getElementById('aemail').value = arg23;
                document.getElementById('ahand').value = arg24;
                // document.getElementById('abonsadam1').value = arg25; 
                // document.getElementById('abonsadam2').value = arg26;
                // document.getElementById('abonsadam3').value = arg27;
                document.getElementById('adomain').value = arg28;
                document.getElementById('afax').value = arg29; 
                // document.getElementById('inname01').value = arg30; 
                // document.getElementById('inname02').value = arg31; 
                // document.getElementById('inname03').value = arg32; 
                document.getElementById('abuse1').value = arg33; 
                document.getElementById('adam1').value = arg34; 
            }      


            function searchListTot_rtn(){ 
                
                let ls_conacorp1 = document.getElementById('conacorp1').value;  
                let ls_conacorp = document.getElementById('conacorp').value;  
                let ls_abonsadam1 = "%";
                let ls_conagita = '%'; //document.getElementById('conagita').value;   
                $.ajax({
                            url: '/app01m/index07/listtot',  
                            type:"POST",
                            data: { 
                                "conacorp1" :ls_conacorp1, 
                                "conacorp" :ls_conacorp, 
                                "conagita" :ls_conagita,
                                "abonsadam1" :ls_abonsadam1,  
                            }, 
                            async:false,
                            success:function(data){  
                                tabC_grid(data);
                            },error:function(e){
                                console.log("error");                            
                            }
                        }).done(function(fragment){           

                        })        

            }    

            //  tab02 grid data 수집
            function tabC_grid(data){
                var wtab02Dto  = data;    
                var wtab02_data = [];
                var cnt = 1;
                for (var i = 0; i < wtab02Dto.length; i++) {
                    wtab02_data.push({
                        id: i, 
                        index: cnt, 
                        acorp1: wtab02Dto[i]["acorp1"], 
                        acorp2: wtab02Dto[i]["acorp2"], 
                        acorp3: wtab02Dto[i]["acorp3"], 
                        cifcodename: wtab02Dto[i]["cifcodename"], 
                        acode: wtab02Dto[i]["acode"], 
                        acorp: wtab02Dto[i]["acorp"], 
                        asano1: wtab02Dto[i]["asano1"], 
                        asano2: wtab02Dto[i]["asano2"], 
                        asano3: wtab02Dto[i]["asano3"], 
                        asanotxt: wtab02Dto[i]["asanotxt"], 
                        aname: wtab02Dto[i]["aname"], 
                        aupte: wtab02Dto[i]["aupte"], 
                        ajong: wtab02Dto[i]["ajong"], 
                        apost1: wtab02Dto[i]["apost1"], 
                        ajuso1: wtab02Dto[i]["ajuso1"], 
                        ajuso2: wtab02Dto[i]["ajuso2"],
                        ajusotxt: wtab02Dto[i]["ajusotxt"],  
                        abigo: wtab02Dto[i]["abigo"], 
                        agita: wtab02Dto[i]["agita"], 
                        ajumi1: wtab02Dto[i]["ajumi1"], 
                        ajumi2: wtab02Dto[i]["ajumi2"],  
                        ajumitxt: wtab02Dto[i]["ajumitxt"], 
                        aascode1: wtab02Dto[i]["aascode1"], 
                        aascode2: wtab02Dto[i]["aascode2"], 
                        aascodetxt: wtab02Dto[i]["aascodetxt"],
                        atelno: wtab02Dto[i]["atelno"], 
                        atelno2: wtab02Dto[i]["atelno2"], 
                        aemail: wtab02Dto[i]["aemail"],   
                        ahand: wtab02Dto[i]["ahand"],   
                        abonsadam1: wtab02Dto[i]["abonsadam1"],   
                        abonsadam2: wtab02Dto[i]["abonsadam2"],   
                        abonsadam3: wtab02Dto[i]["abonsadam3"],   
                        adomain: wtab02Dto[i]["adomain"],   
                        afax: wtab02Dto[i]["afax"],  
                        abuse1: wtab02Dto[i]["abuse1"],   
                        adam1: wtab02Dto[i]["adam1"],  
                        inname01: wtab02Dto[i]["inname01"],   
                        inname02: wtab02Dto[i]["inname02"],   
                        inname03: wtab02Dto[i]["inname03"],       
                    });
                    cnt++;
                }   
 
                wtab02Grid.columns.clear();  
                wtab02Grid.autoGenerateColumns = false; 
                view_p01tab02page.sourceCollection  = wtab02_data;

                var cols = new wijmo.grid.Column(); 
                cols.binding = 'acode';
                cols.header = '코드';
                cols.align = "center";
                cols.width = 80;
                cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
                    text: '<b>${item.acode}</b>',
                    click: (e, ctx) => {
                        wcifChk_a(ctx.item.acorp1, ctx.item.acorp2, ctx.item.acorp3, ctx.item.acode, ctx.item.acorp,ctx.item.asano1, ctx.item.asano2, ctx.item.asano3, ctx.item.aname, ctx.item.aupte, ctx.item.ajong,ctx.item.apost1, ctx.item.ajuso1, ctx.item.ajuso2, ctx.item.abigo, ctx.item.agita, ctx.item.ajumi1, ctx.item.ajumi2,ctx.item.aascode1, ctx.item.aascode2, ctx.item.atelno, ctx.item.atelno2, ctx.item.aemail, ctx.item.ahand, ctx.item.abonsadam1, ctx.item.abonsadam2, ctx.item.abonsadam3, ctx.item.adomain, ctx.item.afax, ctx.item.inname01, ctx.item.inname02, ctx.item.inname03, ctx.item.abuse1, ctx.item.adam1 );                    
                        
                    }
                });
                wtab02Grid.columns.push(cols);  

                cols = new wijmo.grid.Column(); 
                cols.binding = 'acorp';
                cols.header = '거래처명'; 
                cols.align = "left"; 
                cols.width = 200;
                wtab02Grid.columns.push(cols);  
                
                cols = new wijmo.grid.Column(); 
                cols.binding = 'asanotxt';
                cols.header = '사업자번호'; 
                cols.align = "center";  
                cols.width = 150;     
                wtab02Grid.columns.push(cols); 

                
                cols = new wijmo.grid.Column(); 
                cols.binding = 'aname';
                cols.header = '대표자'; 
                cols.align = "center";  
                cols.width = 100;     
                wtab02Grid.columns.push(cols); 

                cols = new wijmo.grid.Column(); 
                cols.binding = 'aupte';
                cols.header = '업태'; 
                cols.align = "center";  
                cols.width = 80;     
                wtab02Grid.columns.push(cols); 

                cols = new wijmo.grid.Column(); 
                cols.binding = 'ajong';
                cols.header = '종목'; 
                cols.align = "center";  
                cols.width = 80;     
                wtab02Grid.columns.push(cols);  

                cols = new wijmo.grid.Column(); 
                cols.binding = 'atelno';
                cols.header = '전화번호';
                cols.align = "center";
                cols.width = 130; 
                cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
                    text: '<b>${item.atelno}</b>',
                    click: (e, ctx) => {
                        wcifChk_a(ctx.item.acorp1, ctx.item.acorp2, ctx.item.acorp3, ctx.item.acode, ctx.item.acorp,ctx.item.asano1, ctx.item.asano2, ctx.item.asano3, ctx.item.aname, ctx.item.aupte, ctx.item.ajong,ctx.item.apost1, ctx.item.ajuso1, ctx.item.ajuso2, ctx.item.abigo, ctx.item.agita, ctx.item.ajumi1, ctx.item.ajumi2,ctx.item.aascode1, ctx.item.aascode2, ctx.item.atelno, ctx.item.atelno2, ctx.item.aemail, ctx.item.ahand, ctx.item.abonsadam1, ctx.item.abonsadam2, ctx.item.abonsadam3, ctx.item.adomain, ctx.item.afax, ctx.item.inname01, ctx.item.inname02, ctx.item.inname03 );                    
                    }
                });
                wtab02Grid.columns.push(cols);  

                
                cols = new wijmo.grid.Column(); 
                cols.binding = 'atelno2';
                cols.header = '전화번호2'; 
                cols.align = "center";  
                cols.width = 130;     
                wtab02Grid.columns.push(cols); 

                cols = new wijmo.grid.Column(); 
                cols.binding = 'ahand';
                cols.header = '핸드폰'; 
                cols.align = "center"; 
                cols.width = 130;      
                wtab02Grid.columns.push(cols);  
                
                cols = new wijmo.grid.Column(); 
                cols.binding = 'aemail';
                cols.header = '메일'; 
                cols.align = "center";  
                cols.width = 200;     
                wtab02Grid.columns.push(cols); 
                
                cols = new wijmo.grid.Column(); 
                cols.binding = 'apost1';
                cols.header = '우편번호'; 
                cols.align = "center";  
                cols.width = 80;     
                wtab02Grid.columns.push(cols); 
    
                cols = new wijmo.grid.Column(); 
                cols.binding = 'ajusotxt';
                cols.header = '주소';
                cols.align = "left";
                cols.width = 200;           
                wtab02Grid.columns.push(cols);
    
                cols = new wijmo.grid.Column(); 
                cols.binding = 'inname01';
                cols.header = '담당(현)';
                cols.align = "center";
                cols.width = 100;           
                wtab02Grid.columns.push(cols);

                cols = new wijmo.grid.Column(); 
                cols.binding = 'inname02';
                cols.header = '담당';
                cols.align = "center";
                cols.width = 100;           
                wtab02Grid.columns.push(cols);

                cols = new wijmo.grid.Column(); 
                cols.binding = 'inname03';
                cols.header = '담당';
                cols.align = "center";
                cols.width = 100;           
                wtab02Grid.columns.push(cols);

                cols = new wijmo.grid.Column(); 
                cols.binding = 'adomain';
                cols.header = '홈페이지';
                cols.align = "left";
                cols.width = 200;           
                wtab02Grid.columns.push(cols);
        
            }   






    // ####################################################################################################  
    
    // 우편번호  script 
    function sample4_execDaumPostcode() {
            new daum.Postcode({
                oncomplete: function(data) {
                    // 팝업에서 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분.

                    // 도로명 주소의 노출 규칙에 따라 주소를 표시한다.
                    // 내려오는 변수가 값이 없는 경우엔 공백('')값을 가지므로, 이를 참고하여 분기 한다.
                    var roadAddr = data.roadAddress; // 도로명 주소 변수
                    var extraRoadAddr = ''; // 참고 항목 변수

                    // 법정동명이 있을 경우 추가한다. (법정리는 제외)
                    // 법정동의 경우 마지막 문자가 "동/로/가"로 끝난다.
                    if(data.bname !== '' && /[동|로|가]$/g.test(data.bname)){
                        extraRoadAddr += data.bname;
                    }
                    // 건물명이 있고, 공동주택일 경우 추가한다.
                    if(data.buildingName !== '' && data.apartment === 'Y'){
                    extraRoadAddr += (extraRoadAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                    }
                    // 표시할 참고항목이 있을 경우, 괄호까지 추가한 최종 문자열을 만든다.
                    if(extraRoadAddr !== ''){
                        extraRoadAddr = ' (' + extraRoadAddr + ')';
                    }

                    // 우편번호와 주소 정보를 해당 필드에 넣는다.
                    document.getElementById('apost1').value = data.zonecode;
                    document.getElementById("ajuso1").value = roadAddr;
                    document.getElementById("ajuso2").focus();
                    // alert(data.zonecode);
                    // document.getElementById("ajuso2").value = data.jibunAddress;
                    
                    // 참고항목 문자열이 있을 경우 해당 필드에 넣는다.
                    // if(roadAddr !== ''){
                    //     document.getElementById("sample4_extraAddress").value = extraRoadAddr;
                    // } else {
                    //     document.getElementById("sample4_extraAddress").value = '';
                    // }

                    // var guideTextBox = document.getElementById("guide");
                    // 사용자가 '선택 안함'을 클릭한 경우, 예상 주소라는 표시를 해준다.
                    // if(data.autoRoadAddress) {
                    //     var expRoadAddr = data.autoRoadAddress + extraRoadAddr;
                    //     guideTextBox.innerHTML = '(예상 도로명 주소 : ' + expRoadAddr + ')';
                    //     guideTextBox.style.display = 'block';

                    // } else if(data.autoJibunAddress) {
                    //     var expJibunAddr = data.autoJibunAddress;
                    //     guideTextBox.innerHTML = '(예상 지번 주소 : ' + expJibunAddr + ')';
                    //     guideTextBox.style.display = 'block';
                    // } else {
                    //     guideTextBox.innerHTML = '';
                    //     guideTextBox.style.display = 'none';
                    // }
                }
            }).open();
        }


    // 날짜 및 시간 표현 script     
            //gettoday,init_date script
            $(document).ready(function() {             
                getToday()
                //fn_egov_init_date()  
                
            })       
        
            // function timeFunction() {
            //     var actarrivtimez = document.getElementById("#actarrivtimez").value;
            //     var actcomptimez = document.getElementById("#actcomptimez").value;
            // }
            function getToday(){
                let today = new Date();   
                let year = today.getFullYear(); // 년도
                let month = today.getMonth() + 1;  // 월
                let date = today.getDate();  // 날짜d
                let day = today.getDay();  // 요일
                let hours = today.getHours();
                let minutes = today.getMinutes();
                if(month > 0 && month < 10) {month = "0" + month};
                if(date > 0 && date < 10) {date = "0" + date};
                if(minutes > 0 && minutes < 10) {minutes = "0" + minutes};
                if(hours > 0 && hours < 10) {hours = "0" + hours};
                let ls_time = hours + ':' + minutes
                let ls_dddd = year + '-' + month + '-' + '01'
                let ls_frday = year + '-' + month + '-' + date
                let ls_today = year + '-' + month + '-' + date  
            }
            function convert_time(timestamp){ 
                //현재시간
                var date = new Date(timestamp); 
                var year = date.getFullYear();
                var month = ("0" + (1 + date.getMonth())).slice(-2);
                var day = ("0" + date.getDate()).slice(-2); 
                var hh = date.getHours();  
                var min = ('0' + date.getMinutes()).slice(-2) 
                time = year +  month +  day   ;
                return time;  
            
            }
            function fn_egov_init_date(){
                    //from_untill date pick 선택창
                var $frdate = $('#frdate');    //날짜조회from
                var $todate = $('#todate');    //날짜조회untill
                var $arrivdatez = $('#arrivdatez'); //도착일
                var $actcompdatez = $('#actcompdatez'); //완료일자 
                var $stdate = $('#stdate'); //도착일
                var $enddate = $('#enddate'); //완료일자
                var $actcomptimez = $('#actcomptimez'); 
                var $actarrivtimez = $('#actarrivtimez'); 
                $frdate.flatpickr({ 
                    enableTime: false,
                    dateFormat: 'Y-m-d',   
                
                });
                $todate.flatpickr({ 
                    enableTime: false,
                    dateFormat: 'Y-m-d',   
                
                });
                $actcompdatez.flatpickr({ 
                    enableTime: false,
                    dateFormat: 'Y-m-d',   
                
                });
                $arrivdatez.flatpickr({ 
                    enableTime: false,
                    dateFormat: 'Y-m-d',
                
                });
                $actcomptimez.flatpickr({ 
                    enableTime: true,
                    noCalendar : true,
                    timeFormat: 'HH:ii',  
                
                });
                $actarrivtimez.flatpickr({ 
                    enableTime: true,
                    noCalendar : true,
                    timeFormat: 'HH:ii',   
                
                });

            }  
            
            
            
            
            // <!--######################################## 그리드 메뉴-->
            class FlexGridContextMenu {
                constructor(grid) {
                    let host = grid.hostElement, menu = this._buildMenu(grid);
                    host.addEventListener('contextmenu', (e) => {
                        // 클릭된 셀/열 선택
                        let sel = grid.selection, ht = grid.hitTest(e), row = ht.getRow();

                        switch (ht.panel) {
                            case grid.cells:
                            let colIndex = ht.col;
                            // 만약 그룹 헤더이면, 그룹 열 선택
                            if (row instanceof wijmo.grid.GroupRow && row.dataItem instanceof wijmo.collections.CollectionViewGroup) {
                                let gd = row.dataItem.groupDescription;
                                if (gd instanceof wijmo.collections.PropertyGroupDescription) {
                                let col = grid.getColumn(gd.propertyName);
                                if (col && col.index > -1) {
                                    colIndex = col.index;
                                }
                                }
                            }
                            grid.select(ht.row, colIndex);
                            break;
                            case grid.columnHeaders:
                            grid.select(sel.row, ht.col);
                            break;
                            case grid.rowHeaders:
                            grid.select(ht.row, sel.col);
                            break;
                            default:
                            return; // 유효하지 않는 패널
                        }
                        // 현재 열에 대한 메뉴 표시
                        if (grid.selection.col > -1) {
                            e.preventDefault(); // 브라우저의 기본 메뉴 취소
                            menu.show(e); // Wijmo 메뉴 표시
                        }
                    }, true);
                }
                _buildMenu(grid) {
                    let menu = new wijmo.input.Menu(document.createElement('div'), {
                    owner: grid.hostElement,
                    displayMemberPath: 'header',
                    subItemsPath: 'items',
                    commandParameterPath: 'cmd',
                    dropDownCssClass: 'ctx-menu',
                    openOnHover: true,
                    closeOnLeave: true,
                    itemsSource: [
                        {
                        header: '정렬', items: [
                            { header: 'Ascending', cmd: 'SRT_ASC' },
                            { header: 'Descending', cmd: 'SRT_DESC' },
                            { header: 'No Sort', cmd: 'SRT_NONE' },
                            { header: '-' },
                            { header: 'Clear All Sorts', cmd: 'SRT_CLR' }
                        ]
                        },
                        { header: '-' },
                        { header: 'Pin/Unpin', cmd: 'PIN' },
                        { header: '-' },
                        { header: 'AutoSize', cmd: 'ASZ' },
                        { header: 'AutoSize All', cmd: 'ASZ_ALL' },
                        { header: '-' },
                        { header: 'Group/Ungroup', cmd: 'GRP' },
                        { header: 'Clear All Groups', cmd: 'GRP_CLR' },
                        { header: '-' },
                        {
                        header: '내려받기', items: [
                            { header: 'CSV', cmd: 'X_CSV' },
                            { header: 'XLSX', cmd: 'X_XLSX' },
                            { header: 'PDF', cmd: 'X_PDF' },
                        ]
                        }
                    ],
                    command: {
                        // 메뉴 명령 활성화/비활성화
                        canExecuteCommand: (cmd) => {
                        let view = grid.collectionView, col = grid.columns[grid.selection.col];
                        switch (cmd) {
                            case 'SRT_ASC':
                            return col.currentSort != '+';
                            case 'SRT_DESC':
                            return col.currentSort != '-';
                            case 'SRT_NONE':
                            return col.currentSort != null;
                            case 'SRT_CLR':
                            return view.sortDescriptions.length > 0;
                            case 'PIN':
                            return true; // toggle pin
                            case 'ASZ':
                            case 'ASZ_ALL':
                            return true;
                            case 'GRP':
                            return col.dataType != wijmo.DataType.Number; // don't group numbers
                            case 'GRP_CLR':
                            return view.groupDescriptions.length > 0;
                        }
                        return true;
                        },
                        // 메뉴 명령 실행
                        
                        executeCommand: (cmd) => {
                            let view = grid.collectionView, cols = grid.columns, col = cols[grid.selection.col], sd = view.sortDescriptions, gd = view.groupDescriptions;
                                            
                            switch (cmd) {
                                case 'SRT_ASC':
                                case 'SRT_DESC':
                                case 'SRT_NONE':
                                if (grid.allowSorting != wijmo.grid.AllowSorting.MultiColumn) {
                                    sd.clear();
                                }
                                else {
                                    for (let i = 0; i < sd.length; i++) {
                                    if (sd[i].property == col.binding) {
                                        sd.removeAt(i);
                                        break;
                                    }
                                    }
                                }
                                if (cmd != 'SRT_NONE') {
                                    sd.push(new wijmo.collections.SortDescription(col.binding, cmd == 'SRT_ASC'));
                                }
                                    break;
                                case 'SRT_CLR':
                                    sd.clear();
                                    break;
                                case 'PIN':
                                    let fCols = grid.frozenColumns;
                                    if (col.index >= fCols) { // pinning
                                        cols.moveElement(col.index, fCols, false);
                                        cols.frozen++;
                                    }
                                    else { // unpinning
                                        cols.moveElement(col.index, fCols - 1, false);
                                        cols.frozen--;
                                    }
                                    break;
                                case 'ASZ':
                                    grid.autoSizeColumn(col.index);
                                    break;
                                case 'ASZ_ALL':
                                    grid.autoSizeColumns(0, grid.columns.length - 1);
                                    break;
                                case 'GRP':
                                // 그룹 삭제
                                    for (let i = 0; i < gd.length; i++) {
                                        if (gd[i].propertyName == col.binding) {
                                        gd.removeAt(i);
                                        return; // we're done
                                        }
                                    }
                                    // 그룹 추가
                                    gd.push(new wijmo.collections.PropertyGroupDescription(col.binding));
                                    break;
                                case 'GRP_CLR':
                                    gd.clear();
                                    break;
                                // 내보내기
                                case 'X_CSV':
                                    let rng = new wijmo.grid.CellRange(0, 0, grid.rows.length - 1, grid.columns.length - 1), csv = grid.getClipString(rng, wijmo.grid.ClipStringOptions.CSV, true, false);
                                    wijmo.saveFile(csv, '거래처현황.csv');
                                    break;
                                case 'X_XLSX':
                                    //엑셀수정
                                    const gridView = grid.collectionView;
                                    let oldPgSize = gridView.pageSize, oldPgIndex = gridView.pageIndex;

                                    grid.beginUpdate();
                                    gridView.pageSize = 0;

                                    wijmo.grid.xlsx.FlexGridXlsxConverter.saveAsync(grid, {includeCellStyles: true, includeColumnHeaders: true}, '거래처현황.xlsx',
                                    saved => {
                                    gridView.pageSize = oldPgSize;
                                    gridView.moveToPage(oldPgIndex);
                                    grid.endUpdate();
                                    }, null
                                    );                          
                                    break;
                                case 'X_PDF':
                                    wijmo.grid.pdf.FlexGridPdfConverter.export(grid,'거래처현황.pdf', {
                                        maxPages: 10,
                                        scaleMode: wijmo.grid.pdf.ScaleMode.PageWidth,
                                        // exportMode = wijmo.grid.pdf.ExportMode.All,
                                        documentOptions: {
                                                compress: true,
                                                pageSettings: {
                                                layout: orientation
                                                },
                                            header: { declarative: { text: '\t&[Page] of &[Pages]' } },
                                            footer: { declarative: { text: '\t&[Page] of &[Pages]' } },
                                            info: { author: 'Actas', title: '거래처현황' }
                                        },
                                        //내장된 폰트 정보
                                        embeddedFonts: [
                                            {
                                            source: "https://assets.codepen.io/975719/BMHANNAPro.ttf",
                                            name: "BMHANNAPro",
                                            style: "normal",
                                            weight: "normal",
                                            sansSerif: true
                                            }
                                        ],
                                        styles: {
                                            cellStyle: { backgroundColor: '#ffffff', borderColor: '#c6c6c6', font: {family: "BMHANNAPro"} },
                                            altCellStyle: { backgroundColor: '#f9f9f9' },
                                            groupCellStyle: { backgroundColor: '#dddddd' },
                                            headerCellStyle: { backgroundColor: '#eaeaea' }
                                        } 
                                    });
                                    // let doc = new pdf.PdfDocument({
                                    // header: {
                                    //     declarative: {
                                    //         text: '\t&[Page]\\&[Pages]'
                                    //     }
                                    // },
                                    // footer: {
                                    //     declarative: {
                                    //         text: '\t&[Page]\\&[Pages]'
                                    //     }
                                    // },
                                    // ended: (sender, args) => pdf.saveBlob(args.blob, 'FlexGrid.pdf')
                                    // });
                                    // let settings = {
                                    // styles: {
                                    //     cellStyle: {
                                    //         backgroundColor: '#ffffff',
                                    //         borderColor: '#c6c6c6'
                                    //     },
                                    //     altCellStyle: {
                                    //         backgroundColor: '#f9f9f9'
                                    //     },
                                    //     groupCellStyle: {
                                    //         backgroundColor: '#dddddd'
                                    //     },
                                    //     headerCellStyle: {
                                    //         backgroundColor: '#eaeaea'
                                    //     }
                                    // }}
                                    // doc.drawText('This grid is drawn in its original size using the draw method and is split into multiple pages.', 0, 400);
                                    // doc.moveDown();
                                    // gridPdf.FlexGridPdfConverter.draw(flexGrid, doc, null, null, settings);
                                    // //
                                    // doc.end();
                                    break;
                            }
                            // 활성화 그리드 셀에 포커스 복원
                            grid.refresh();
                            let sel = grid.selection, cell = grid.cells.getCellElement(sel.row, sel.col);
                            if (cell) {
                                cell.focus();
                            }
                        }
                    }
                    });
                    // 완료
                    return menu;
                }
            }


            //모달 끝
    // 자바 끝
    </script> 
</div>   
                    
<!-- ######################### ######################### ######################### ######################### ######################### ######################### -->
</body> 
                    <!------footer ------>
                    <!-- <footer th:replace="layouts/XDashBoard/XDashBoard_footer :: XDashBoard_footer"></footer> -->
                    <!--------------------->  
                </div> 
            <!-- </div> -->
        </main>
    </div>
</header>