<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<header th:fragment="headerFragment">
    <!-- py-md-2 px-1 py-1 -->
    <div class="card-body d-flex align-items-center py-md-2 px-auto py-auto ">
        <main class="main" id="top"> 
            <div class="container-fluid"> 
                <script>
                    var isFluid = JSON.parse(localStorage.getItem('isFluid'));
                    if (isFluid) {
                        var container = document.querySelector('[data-layout]');
                        container.classList.remove('container');
                        container.classList.add('container-fluid');
                    }
                </script>

                <nav class="navbar navbar-light navbar-vertical navbar-expand-xl">
                    <script>
                        var navbarStyle = localStorage.getItem("navbarStyle");
                        if (navbarStyle && navbarStyle !== 'transparent') {
                            document.querySelector('.navbar-vertical').classList.add(`navbar-${navbarStyle}`);
                        }
                    </script>
                    <div class="d-flex align-items-center">
                        <div class="toggle-icon-wrapper">

                            <button class="btn navbar-toggler-humburger-icon navbar-vertical-toggle"
                                data-bs-toggle="tooltip" data-bs-placement="left" title="Toggle Navigation"><span
                                    class="navbar-toggle-icon"><span class="toggle-line"></span></span></button>

                        </div><a class="navbar-brand" href="@{/user}">
                            <!-- <div class="d-flex align-items-center py-3"><img class="me-2"
                                    th:src="@{assets/img/icons/spot-illustrations/falcon.png}" alt="" width="40" /><span
                                    class="font-sans-serif">ActasErp</span>
                            </div> -->
                        </a>
                    </div> 
                    <!------navbar vertical------>     
                    <div th:replace="layouts/layout01/navbarMemWeb :: navbar"></div>  
                </nav>
                <div class="content" id="index11"> 
                    <!------nav ------>
                    <!-- <div th:replace="layouts/layout01/headerNavWeb :: headerNav"></div>   -->

                    <body layout:fragment="index11"> 
                    <!-- ######################### ######################### ######################### ######################### ######################### ######################### -->
                    <div class="con">
                        <!-- ## header top include -->
                        <th:block th:include="layouts/APPHeader/appheadTop" /> 
                        <div class="card-body bg-light">
                            <ul class="nav nav-tabs">
                                <li class="nav-item">
                                    <a class="nav-link active" data-toggle="tab" href="#step01" onclick="tabchk_rtn('A')">기초재고</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#step02"  onclick="tabchk_rtn('B')">재고조정</a>
                                </li>
                                <!-- <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#step03"  onclick="tabchk_rtn('C')">검사이력현황</a>
                                </li> -->
                                <input type="hidden" id="tabvalue" value="A">
                                </ul>
                                <div class="tab-content">
                                    <div class="tab-pane fade show active" id="step01">  
                                        <div class="row gx-3" style="  margin: 10px 10px 10px;">   
                                            <div class="col-auto">
                                                <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">등록일자</span>
                                                    <input type="text"  class="form-control datetimepicker" id="frdate" autocomplete="off"  placeholder="Y-m-d"     >
                                                    <input class="form-control form-control-sm" id="jpbgubn" type="hidden"  /> 
                                                </div>
                                            </div>
                                            <div class="col-auto">  
                                                <button class="btn btn-falcon-danger me-1 mb-1 btn-sm" type="button" onclick="save_btn()">재고등록
                                                </button>
                                            </div> 
                                            <div class="col-auto">
                                                <input type="file" class="form-control" id="importFile" accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" />                                               
                                            </div>
                                            <div class="col-auto">
                                                <button class="btn btn-falcon-primary me-1 mb-1 btn-sm" type="button" id="loadXlsx">엑셀적용
                                                </button> 
                                            </div> 
                                        </div> 
                                        <div class="container-fluid">   
                                            <div id="wtab01Grid_div" style="overflow:scroll;   height:680px;      margin:0 auto; "></div> 
                                            <!-- <div id="tab01Pager"></div> -->
                                        </div>   
                                    </div> 
            
                                    <div class="tab-pane fade show " id="step02">  
                                        <div class="row gx-3" style="  margin: 10px 10px 10px;">   
                                            <div class="col-auto">
                                                <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">조정기간</span>
                                                    <input type="text"  class="form-control datetimepicker" id="ipfrdate" autocomplete="off"  placeholder="Y-m-d"     >
                                                </div> 
                                            </div>   
                                            <div class="col-auto"> 
                                                <div class="input-group input-group-sm mb-3"> 
                                                    <input type="text"  class="form-control datetimepicker" id="iptodate" autocomplete="off"  placeholder="Y-m-d"     >
                                                </div>
                                            </div>  
                                            <div class="col-auto">
                                                <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">품목</span> 
                                                    <input class="form-control form-control-sm" id="jpumname02" type="text"    autocomplete="off"  placeholder=""     >
                                                    <input class="form-control form-control-sm" id="jkey02" type="hidden"  /> 
                                                </div>
                                            </div>
                                            <div class="col-auto">  
                                                <button class="btn btn-falcon-danger me-1 mb-1 btn-sm" type="button"  id="retrieveBtn" >조회
                                                </button> 
                                            </div>  
                                            <div class="col-auto">   
                                                <button class="btn btn-falcon-danger me-1 mb-1 btn-sm" type="button" onclick="delete_btn()">삭제
                                                </button>
                                            </div>  
                                            <div class="col-auto">
                                                <button class="btn btn-falcon-primary me-1 mb-1 btn-sm" type="button" id="saveInd">개별등록
                                                </button> 
                                            </div> 
                                        </div> 
                                        <div class="container-fluid">
                                            <div id="wtab02Grid_div" style="overflow:scroll;   height:750px;    margin:0 auto; "></div>
                                            <!-- <div id="tab02Pager"></div> -->
                                        </div>
                                    </div> 
                                    
                                </div>
                        </div> 
                    </div> 
 

  
    <!--  모달 처리 -->
    <input class="form-control form-control-sm"  type="hidden" id="innamebtn" data-bs-toggle="modal" data-bs-target="#cifmodal"  /> 
    <!--------------------------------------------------------------------------------------->   
    <div class="modal fade" id="cifmodal" data-bs-keyboard="false"
    data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel"
    aria-hidden="true">
        <div class="modal-dialog modal-lg mt-6" role="document" id = "modalForm01"
            style="max-width: 600px">
            <div class="modal-content border-0">
                <div class="modal-body p-0" > 
                    <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">                            
                        <div class="search">
                            <div class="input_wrap">  
                                <input class="form-control form-control-sm" id="searchCode" type="text"   onkeyup="if(window.event.keyCode==13){JpumSearchList_rtn('M')}"
                                placeholder="품목명 "     />                                      
                            </div>

                            <button id="winnameBtn">
                                <img th:src="@{/assets/images/i_search.png}" alt=""> 
                            </button>
                        </div>                             
                    </div>   
                    <div class="container-fluid"> 
                        <div id="winnameGrid_div" ></div>
                        <!-- <div id="thePager03"></div> -->
                    </div>   
                </div>  

                <div class="modal-footer">
                    <div class="row g-1">
                        <div class="col-auto">
                            <button class="badge-soft-primary dropdown-item rounded-1"
                                type="button"  id="winnamemodal_btn" data-bs-dismiss="modal">Close</button>
                        </div> 
                    </div>
                </div>   

            </div>
        </div> 
    </div>   



    <!--  개별등록 -->
    <input class="form-control form-control-sm"  type="hidden" id="insavebtn" data-bs-toggle="modal" data-bs-target="#savemodal"  /> 
    <!--------------------------------------------------------------------------------------->   
    <div class="modal fade" id="savemodal" data-bs-keyboard="false"
    data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel"
    aria-hidden="true">
        <div class="modal-dialog modal-lg mt-6" role="document" id = "modalForm01"
            style="max-width: 600px">
            <div class="modal-content border-0">
                <div class="modal-body p-0" > 
                    <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">                            
                        <div class="search">
                            <div class="input_wrap">  
                                <input class="form-control form-control-sm" id="searchCode02" type="text"   onkeyup="if(window.event.keyCode==13){JpumSearchList_rtn('S')}"
                                placeholder="품목명 "     />                                      
                            </div>

                            <button id="winnameBtn">
                                <img th:src="@{/assets/images/i_search.png}" alt=""> 
                            </button>
                        </div>                             
                    </div>   
                    <div class="container-fluid"> 
                        <div id="winjcodeGrid_div"  style="overflow:scroll;   height:300px;    margin:0 auto; "></div> 
                        <!-- <div id="thePager03"></div> -->
                    </div>    
                    <div class="row gx-4" style="  margin: 10px 10px 10px;">   
                        <div class="col-auto">
                            <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">등록일자</span>
                                <input type="text"  class="form-control datetimepicker" id="savedate" autocomplete="off"  placeholder="Y-m-d"     >
                            </div>
                        </div> 
                        <div class="col-auto">
                            <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">품목</span> 
                                <input class="form-control form-control-sm" id="bjpumname" type="text"    autocomplete="off"  placeholder=""     >
                                <input class="form-control form-control-sm" id="bjkey" type="hidden"  /> 
                            </div>
                        </div>
                        <div class="col-auto">
                            <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">조정수량</span> 
                                <input class="form-control form-control-sm" id="bjqty" type="number"    autocomplete="off"  placeholder=""     > 
                            </div>
                        </div>
                        <div class="col-auto">
                            <button class="btn btn-falcon-danger me-1 mb-1 btn-sm" type="button" onclick="saveone_btn()">재고조정
                            </button>
                        </div> 
                    </div> 
                </div>  

                <div class="modal-footer">
                    <div class="row g-1">
                        <div class="col-auto">
                            <button class="badge-soft-primary dropdown-item rounded-1"
                                type="button"  id="wsavemodalmodal_btn" data-bs-dismiss="modal">Close</button>
                        </div> 
                    </div>
                </div>   

            </div>
        </div> 
    </div>   
 
 
     
<input class="form-control form-control-sm"  type="hidden" id="actnmbtn" data-bs-toggle="modal" data-bs-target="#savemodal"  /> 
<!---------------------------------------------------------------------------------------> 


<script type="text/javascript" th:inline="javascript">
var view_p01tab01page;
var view_p01tab02page;
var view_p01tab03page; 
var view_p01tab04page; 
var view_innamepage; 
var view_injcodepage; 
var wtab01Grid;
var wtab02Grid;
var wtab03Grid; 
var wtab04Grid; 
var winnameGrid; 
var winjcodeGrid; 
let wfrdate;
let wipfrdate;   
let wiptodate;   
let wsavedate; 

let includeColumnHeader = false;
window.onload = function() {  
    wtab01Grid = new wijmo.grid.FlexGrid('#wtab01Grid_div', {  
        autoGenerateColumns: false,
        showMarquee: true,
        isReadOnly: false, 
        // selectionMode: 'RowRange',
        allowSorting: 'MultiColumn',
        alternatingRowStep: 0,
        columns: [     
            { binding: 'jcode', header: '품목코드', align: "center",   width: 200 }, 
            { binding: 'ipqty', header: '기초수량', align: "center",   width: 300},   
        ], 
        itemsSource: getData_tab01()
    });   
        
    setHeaderColumn(false);
    function setHeaderColumn(headerOn) {
        wtab01Grid.headersVisibility = headerOn
        ? wijmo.grid.HeadersVisibility.All
        : wijmo.grid.HeadersVisibility.Column; 
    } 
        // tab01검색 데이터 수집
    function getData_tab01(){       
        var wactnm_data = [];
        var cnt = 1;
        for (var i = 0; i < 20; i++) {
            wactnm_data.push({
                id: i, 
                index: cnt,
                jcode: '', 
                ipqty:  '', 
            });
            cnt++;
        }    
        return wactnm_data;                                          
    } 


    //재고조정현황 popup list
    view_p01tab02page = new wijmo.collections.CollectionView(getData_wlist(), {
        // sortDescriptions: [new wijmo.collections.SortDescription("jepm", false)],
        // pageSize: 20
    });     
    wtab02Grid = new wijmo.grid.FlexGrid('#wtab02Grid_div', {  
        autoGenerateColumns: false,
        isReadOnly: true, 
        allowSorting: 'MultiColumn',
        selectionMode: 'RowRange',
        alternatingRowStep: 0,
        columns: [     
            { binding: 'ipdate', header: '조정일자', align: "center", width: '1*' }, 
            { binding: 'acorp', header: '순번', align: "center", width: '1*' }, 
            { binding: 'jepm', header: '품목코드', align: "center", width: '1*' }, 
            { binding: 'jepmnm', header: '품목', align: "center", width: '1*' }, 
            { binding: 'jgugek', header: '규격', align: "center", width: '1*' }, 
            { binding: 'jchajong', header: '사이즈', align: "center", width: '1*' }, 
            // { binding: 'jmodel_code', header: '모델코드', align: "center", width: '1*' }, 
            // { binding: 'jcolor_code', header: '컬러코드', align: "center", width: '1*' }, 
            // { binding: 'jcustomer_code', header: '고객코드', align: "center", width: '1*' }, 
            { binding: 'ijaego_su1', header: '조정수량', align: "center", width: '1*',  format: 'n0' },  
        ], 
        itemsSource: view_p01tab02page, 
    });  
    // 그룹 전환 
    setGroups02(true); 
    function setGroups02(groupsOn) {
        let groups = view_p01tab02page.groupDescriptions;
        groups.clear();
        if (groupsOn) {
            groups.push(new wijmo.collections.PropertyGroupDescription('ipdate') );
        }
    }
    // 헤더 열 전환
    setHeaderColumn2(false);
    new FlexGridContextMenu(wtab02Grid);  
    function setHeaderColumn2(headerOn) {
        wtab02Grid.headersVisibility = headerOn
        ? wijmo.grid.HeadersVisibility.All
        : wijmo.grid.HeadersVisibility.Column; 
    } 
    wtab02Grid.showMarquee = true;
    wtab02Grid.focus();
    wijmo.toggleClass(wtab02Grid.hostElement, 'highlightActive', true);
    wtab02Grid.focus();



    //  데이터 수집
    function getData_wlist(){        
        var wactnm_data = [];
        var cnt = 1;
        for (var i = 0; i < 20; i++) {
            wactnm_data.push({
                id: i, 
                index: cnt,
                jepm: '', 
                jepmnm: '', 
                jgugek: '', 
                jchajong: '', 
                jmodel_code: '', 
                jcolor_code: '', 
                jcustomer_code: '', 
                ijaego_su1:  '', 
            });
            cnt++;
        }     
        return wactnm_data;                           
    }  

    
    // // ################################################################  
    //품목현황 Modalㅁ
    view_innamepage = new wijmo.collections.CollectionView(getData_wlist2(), {
        // pageSize: 12
    });
    // 품목 페이지 이동
    // new wijmo.input.CollectionViewNavigator('#thePager03', {
    //     byPage: true,
    //     headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
    //     cv: view_innamepage
    // });     
    winnameGrid = new wijmo.grid.FlexGrid('#winnameGrid_div', {  
        autoGenerateColumns: false,
        isReadOnly: false, 
        allowSorting: 'MultiColumn',
        selectionMode: 'RowRange',
        alternatingRowStep: 0,
        columns: [     
            { binding: 'jkey', header: '코드', align: "center", width: '1*' },
            { binding: 'pname', header: '품목', align: "left", width: '1*' },
            { binding: 'psize', header: '규격', align: "left", width: '1*' },
            { binding: 'jchajong', header: '차종', align: "center", width: '1*' }, 
        ], 
        itemsSource: view_innamepage
    });  
    
    winnameGrid.showMarquee = true; 
    wijmo.toggleClass(winnameGrid.hostElement, 'highlightActive', true);
    winnameGrid.focus();


    setHeaderColumn4(false);
    function setHeaderColumn4(headerOn) {
        winnameGrid.headersVisibility = headerOn
        ? wijmo.grid.HeadersVisibility.All
        : wijmo.grid.HeadersVisibility.Column; 
    } 
    // // ################################################################  
    //품목현황 Modalㅁ
    view_injcodepage = new wijmo.collections.CollectionView(getData_wlist2(), {
        // pageSize: 12
    });
    // 품목 페이지 이동
    // new wijmo.input.CollectionViewNavigator('#thePager03', {
    //     byPage: true,
    //     headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
    //     cv: view_injcodepage
    // });     
    winjcodeGrid = new wijmo.grid.FlexGrid('#winjcodeGrid_div', {  
        autoGenerateColumns: false,
        isReadOnly: false, 
        allowSorting: 'MultiColumn',
        selectionMode: 'RowRange',
        alternatingRowStep: 0,
        columns: [     
            { binding: 'jkey', header: '코드', align: "center", width: '1*' },
            { binding: 'pname', header: '품목', align: "left", width: '1*' },
            { binding: 'psize', header: '규격', align: "left", width: '1*' },
            { binding: 'jchajong', header: '차종', align: "center", width: '1*' }, 
        ], 
        itemsSource: view_injcodepage
    });  
    
    winjcodeGrid.showMarquee = true; 
    wijmo.toggleClass(winjcodeGrid.hostElement, 'highlightActive', true);
    winjcodeGrid.focus();

    setHeaderColumn10(false);
    function setHeaderColumn10(headerOn) {
        winjcodeGrid.headersVisibility = headerOn
        ? wijmo.grid.HeadersVisibility.All
        : wijmo.grid.HeadersVisibility.Column; 
    } 

    // 거래처 데이터 수집
    function getData_wlist2(){   
        var winname_data = []; 
        var cnt = 1;
        for (var i = 0; i < 12; i++) {
            winname_data.push({
                id: i, 
                index: cnt,
                jkey:"",
                pname: "",   
                psize: "",  
                pbonsa: "",  
                pmodel: "",  
                pcolor: "",                           
            });
            cnt++;
        }    
        return winname_data;                                      
    } 

} //onload function 

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
                                
// tab01 검색   
document.getElementById("retrieveBtn").addEventListener("click",function(){ 
    
    var ls_tab = document.getElementById('tabvalue').value;   
    searchList_rtn(ls_tab);
})   

function searchList_rtn(arg1){   
    switch(arg1){
        case 'A': 
            break;
        case 'B':   
            var  ls_ipfrdate     =  convert_date(wipfrdate.value);                    
            var  ls_iptodate     =  convert_date(wiptodate.value);     
            var ls_jkey = document.getElementById('jkey02').value;  
            var ls_jpumname = document.getElementById('jpumname02').value; 
            if(ls_jpumname == null || ls_jpumname.length == 0 || ls_jpumname == ""){ 
                ls_jkey = '%';            
            }    
            if(ls_ipfrdate == null || ls_ipfrdate.length == 0 || ls_ipfrdate == ""){ 
                alert("입고일자를 등록하세요") 
                document.getElementById("ipdate").focus(); 
                return ;               
            }  
            ls_jpbgubn = "%";
            //console.log(ls_jkey)
            $.ajax({
                url: '/app03m/index59/list',  
                type:"POST",
                data: { 
                    "ipfrdate"      : ls_ipfrdate,  
                    "iptodate"      : ls_iptodate,  
                    "jpbgubn" :ls_jpbgubn,  
                    "jkey" : ls_jkey,
                }, 
                async:false,
                success:function(data){ 
                    //chkLogin(data)  
                    tabB_grid(data);
                },error:function(e){
                    console.log("error");                            
                }
            }).done(function(fragment){           

            })    
            break;                  
        default:    
            break;                
    }


}        
function tabB_grid(data){
    var wtab02Dto  = data;    
    var wtab02_data = [];
    var cnt = 1;
    for (var i = 0; i < wtab02Dto.length; i++) {
        wtab02_data.push({
            id: i, 
            index: cnt,
            key1: wtab02Dto[i]["key1"],
            jepm: wtab02Dto[i]["jepm"],
            acorp: wtab02Dto[i]["acorp"],
            jpumnm: wtab02Dto[i]["jpumnm"],
            jgugek: wtab02Dto[i]["jgugek"], 
            jchajong: wtab02Dto[i]["jchajong"], 
            jmodel_code: wtab02Dto[i]["jmodel_code"],
            jcolor_code: wtab02Dto[i]["jcolor_code"], 
            jcustomer_code: wtab02Dto[i]["jcustomer_code"], 
            jqty: wtab02Dto[i]["jqty"], 
            ipdate: wtab02Dto[i]["ipdate"], 
            
            
        });
        cnt++;
    }    
    // console.log(wtab02_data.length);
    wtab02Grid.columns.clear();  
    wtab02Grid.autoGenerateColumns = false; 
    view_p01tab02page.sourceCollection  = wtab02_data;
    var cols = new wijmo.grid.Column(); 
    cols.binding = 'ipdate';
    cols.header = '입고일자';
    cols.align = "center";
    cols.width = 100; 
    wtab02Grid.columns.push(cols);  

    cols = new wijmo.grid.Column(); 
    cols.binding = 'acorp';
    cols.header = '순번';
    cols.align = "center";
    cols.width = 80; 
    wtab02Grid.columns.push(cols); 

    cols = new wijmo.grid.Column(); 
    cols.binding = 'jepm';
    cols.header = '코드';
    cols.align = "center";
    cols.width = 200; 
    wtab02Grid.columns.push(cols);  

    cols = new wijmo.grid.Column(); 
    cols.binding = 'jpumnm';
    cols.header = '품목';
    cols.align = "center";
    cols.width = 200;  
    cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
        text: '<b>${item.jpumnm}</b>',
        click: (e, ctx) => {
            wdelfun_a(ctx.item.key1, ctx.item.acorp, ctx.item.jepm, ctx.item.jpumnm );                    
            
        }
    });
    wtab02Grid.columns.push(cols);   

    cols = new wijmo.grid.Column(); 
    cols.binding = 'jgugek';
    cols.header = '규격';
    cols.align = "center";
    cols.width = 100;  
    wtab02Grid.columns.push(cols);   

    cols = new wijmo.grid.Column(); 
    cols.binding = 'jchajong';
    cols.header = '사이즈';
    cols.align = "center";
    cols.width = 100;  
    wtab02Grid.columns.push(cols);    

    cols = new wijmo.grid.Column(); 
    cols.binding = 'jqty';
    cols.header = '입고수량';
    cols.align = "center";
    cols.width = 100;  
    cols.aggregate = 'Sum';
    wtab02Grid.columns.push(cols);   

}
  


function save_btn(arg){
    var ls_tab = document.getElementById('tabvalue').value;
    var  ls_frdate     =  convert_date(wfrdate.value);                                            
    const warnning_grid = document.getElementById('inwarnning_grid'); 
    var ls_pcode  =  [];        
    var ll_qty    =  [];    
    var ls_jcode  =  [];        
    var ll_jqty    =  []; 
    var llCount = 0;         


    if (!confirm("저장하시겠습니까?")) {
            return ; 
    }   
    
    switch(ls_tab){
        case 'A':
    
            if(ls_frdate == null || ls_frdate.length == 0 || ls_frdate == ""){ 
                alert("입고일자를 등록하세요") 
                document.getElementById("frdate").focus(); 
                return ;               
            }   

            var gridrow = wtab01Grid.rows.length ; 
            for( i=0; i < gridrow; i++){
                //console.log(wtab01Grid.rows[i]);
                    ls_pcode[i] =  wtab01Grid.getCellData(i, 0, false); 
                    ll_qty[i]   =  parseInt(wtab01Grid.getCellData(i, 1, false));   
                    if(!ls_pcode[i] ){
                        ls_pcode[i] =  wtab01Grid.getCellData(i, 0, false);       //ubv.c
                        ll_qty[i]   =  wtab01Grid.getCellData(i, 1, false);   //_ubv.d

                    }  

                    if(!ls_pcode[i] ){
                        continue;
                    }
                    if(!ll_qty[i] ){ 
                        ll_qty[i] = 0;
                        //alert("수량을 등록하세요") 
                        //return                                           
                    } 
                    if (!ls_jcode.includes(ls_pcode[i])) {
                        ls_jcode[llCount] = ls_pcode[i]; 
                        ll_jqty[llCount] =  ll_qty[i] ;   
                        llCount++;
                    } 
            }    
            if(llCount ==0 ){
                alert("엑셀 자료를 등록하세요") 
                return     
            } 
            $.ajax({
                url: '/app03m/index59/save',  
                type:"POST",
                data: { 
                    "frdate"  : ls_frdate,  
                    "jcode"   : ls_jcode     ,
                    "jqty"     : ll_jqty   ,  
                }, 
                async:false,
                success:function(data){   
                    if(data == "success"){
                        alert("저장되었습니다.") 
                        // searchList_rtn(ls_tab);  
                        // clear_rtn(ls_tab);        
                    }else{                      
                        alert("저장중 오류가 발생했습니다. 관리자에게 문의하세요.")
                        // listUp();
                        console.log(data);  
                    }
                    
                },error:function(e){
                    console.log("error"); 
                }
            }).done(function(fragment){           

            })  
            break;              
        default:    
            break;                
    } 

} 

function saveone_btn(arg){ 
    //var ls_savedate =  document.getElementById('savedate').value; 
    var ls_savedate  =  convert_date(wsavedate.value);        
    var ls_bjkey = document.getElementById('bjkey').value; 
    var ls_bjqty = document.getElementById('bjqty').value;   
    var ls_pcode  =  [];        
    var ll_qty    =  [];    
    var ls_jcode  =  [];        
    var ll_jqty    =  []; 
    var llCount = 0;         


    if (!confirm("저장하시겠습니까?")) {
            return ; 
    }   
        
    if(ls_savedate == null || ls_savedate.length == 0 || ls_savedate == ""){ 
        alert("입고일자를 등록하세요") 
        document.getElementById("savedate").focus(); 
        return ;               
    }   
    if(ls_bjkey == null || ls_bjkey.length == 0 || ls_bjkey == ""){ 
        alert("품목을 선택하세요") 
        document.getElementById("bjpumname").focus(); 
        return ;               
    }   
    if(ls_bjqty == null || ls_bjqty == 0  ){ 
        alert("수량을 입력하세요") 
        document.getElementById("bjqty").focus(); 
        return ;               
    }   
    ls_jcode[0] = ls_bjkey;
    ll_jqty[0] = ls_bjqty; 
    $.ajax({
        url: '/app03m/index59/save',  
        type:"POST",
        data: { 
            "frdate"  : ls_savedate,  
            "jcode"   : ls_jcode     ,
            "jqty"     : ll_jqty   ,  
        }, 
        async:false,
        success:function(data){   
            if(data == "success"){
                alert("저장되었습니다.") 
                document.getElementById('bjkey').value = ""; 
                document.getElementById('bjpumname').value = ""; 
                document.getElementById('bjqty').value = 0;   
                // searchList_rtn(ls_tab);  
                // clear_rtn(ls_tab);        
            }else{                            
                alert("저장중 오류가 발생했습니다. 관리자에게 문의하세요.")
                // listUp();
                console.log(data);  
            }
            
        },error:function(e){
            console.log("error"); 
        }
    }).done(function(fragment){           

    })   

} 


function wdelfun_a(arg1, arg2, arg3, arg4 ){ 
    if (!confirm("입고일자 : " + arg1 + " (" +  arg2 + ") : " + arg4 + "   삭제하시겠습니까?")) {
        return ; 
    }   
    var ls_tab = document.getElementById('tabvalue').value; 
    $.ajax({
        url: '/app03m/index59/del',  
        type:"POST",
        data: { 
            "ipdate"      : arg1,    
            "acorp"       : arg2,    
            "jepm"        : arg3,    
        }, 
        async:false,
        success:function(data){   
            if(data == "success"){
                alert("삭제되었습니다.") 
                searchList_rtn(ls_tab);  
                clear_rtn(ls_tab);             
            }else{  
                if(data == "relogin"){
                    alert("다시 로그인해주세요")
                    window.location.href='http://mes.c-kd.com';
                    return 
                }                            
                alert("삭제중 오류가 발생했습니다. 관리자에게 문의하세요.")  
            }
        
        },error:function(e){
            console.log("error"); 
        }
    }).done(function(fragment){           

    })  


}    

function delete_btn(arg){
    var ls_tab = document.getElementById('tabvalue').value;
    var ls_ipdate =    convert_date(wipfrdate.value);    //document.getElementById('ipfrdate').value; 

    if (!confirm("입고일자 : " + ls_ipdate + " 자료를 삭제하시겠습니까?")) {
            return ; 
    }   
    
    switch(ls_tab){
        case 'B':

        if(ls_ipdate == null || ls_ipdate.length == 0 || ls_ipdate == ""){ 
            alert("입고일자를 등록하세요") 
            document.getElementById("ipfrdate").focus(); 
            return ;               
        }   
            var ls_acorp = "";
            var ls_jepm = "";
            $.ajax({
                url: '/app03m/index59/del',  
                type:"POST",
                data: { 
                    "ipdate"      : ls_ipdate,   
                    "acorp"       : ls_acorp,    
                    "jepm"        : ls_jepm,    
                }, 
                async:false,
                success:function(data){   
                    if(data == "success"){
                        alert("삭제되었습니다.") 
                        searchList_rtn(ls_tab);  
                        clear_rtn(ls_tab);             
                    }else{  
                        if(data == "relogin"){
                            alert("다시 로그인해주세요")
                            window.location.href='http://mes.c-kd.com';
                            return 
                        }                            
                        alert("삭제중 오류가 발생했습니다. 관리자에게 문의하세요.")  
                    }
                    
                },error:function(e){
                    console.log("error"); 
                }
            }).done(function(fragment){           

            })  
            break;                
        default:    
            break;                
    } 

}   

function clear_rtn(arg){
    switch(arg){
        case 'A': 
            document.getElementById('cifcode').value = "";
            document.getElementById('cifcodename').value = "";
            break;
        case 'B': 
            
            break;
        case 'C':
            
            break;                
        default:    
            break;                
    } 

}
     



//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
    
// tab01 엑셀적용   
document.getElementById("loadXlsx").addEventListener("click",function(){  
    let inputEle = document.querySelector('#importFile');
    if (inputEle.files[0]) {
    wijmo.grid.xlsx.FlexGridXlsxConverter.loadAsync(wtab01Grid, inputEle.files[0], { includeColumnHeaders: includeColumnHeader });
    } 
})  
document.getElementById("saveInd").addEventListener("click",function(){ 
    document.getElementById("actnmbtn").click(); 

})  
//입고조회 품목검색 
document.getElementById("jpumname02").addEventListener("keyup", (e)=>{ 
    if(e.keyCode === 13){  
        document.getElementById("innamebtn").click(); 
        JpumSearchList_rtn("B"); 
    }
});   

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
//선택한 탭 체크 
function tabchk_rtn(arg){
    document.getElementById('tabvalue').value = arg; 
} 

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
                            
// tab01 검색   
document.getElementById("retrieveBtn").addEventListener("click",function(){ 
    
    var ls_tab = document.getElementById('tabvalue').value;   
    searchList_rtn(ls_tab);
})   
 


function JpumSearchList_rtn(arg){   
    var searchCode = ""; 
    var ls_tab = document.getElementById('tabvalue').value;   
    if(arg == "M"){
        searchCode = document.getElementById('searchCode').value;   
    }else if(arg == "S"){
        searchCode = document.getElementById('searchCode02').value;   
    }else if(ls_tab == "C"){
        searchCode = document.getElementById('jpumname').value;   
    }else if(arg == "B"){
        searchCode = document.getElementById('jpumname02').value;   
    }else if(arg == "D"){
        searchCode = document.getElementById('jpumname03').value;   
    }   
    if(searchCode == null || searchCode.length == 0 || searchCode == ""){ 
        searchCode = "%"         ;
    }    
    console.log(arg) 
    console.log(searchCode) 
    var ls_jpbgubn = document.getElementById('jpbgubn').value;   
    if(ls_jpbgubn == null || ls_jpbgubn.length == 0 || ls_jpbgubn == ""){ 
        ls_jpbgubn = "%"         ;
    }    
    $.ajax({
            url: '/app01m/index03/list',  
            type:"POST",
            data: { 
                    "searchtxt" :searchCode, 
                    "jpbgubn" :ls_jpbgubn, 
            }, 
            async:false,
            success:function(data){   
                //chkLogin(data)  
                tabPop_grid(data, arg);
            },error:function(e){
                console.log("error");                            
            }
        }).done(function(fragment){           

        })  
}     
//  거래처팝업 grid data 수집
function tabPop_grid(data, arg){ 
    var wtab01Dto  = data;    
    var wtab01_data = [];
    var cnt = 1; 
    for (var i = 0; i < wtab01Dto.length; i++) {
        wtab01_data.push({
            id: i, 
            index: cnt, 
            id: i, 
            index: cnt, 
            jkey: wtab01Dto[i]["jkey"], 
            jpb_gubn: wtab01Dto[i]["jpb_gubn"], 
            jgong_code: wtab01Dto[i]["jgong_code"], 
            jdan_code: wtab01Dto[i]["jdan_code"], 
            jmodel_code: wtab01Dto[i]["jmodel_code"], 
            jcolor_code: wtab01Dto[i]["jcolor_code"], 
            jcustomer_code: wtab01Dto[i]["jcustomer_code"], 
            jbonsa_code: wtab01Dto[i]["jbonsa_code"], 
            jsayong_gubn: wtab01Dto[i]["jsayong_gubn"], 
            jpum: wtab01Dto[i]["jpum"], 
            jgugek: wtab01Dto[i]["jgugek"], 
            jchajong: wtab01Dto[i]["jchajong"], 
            jchgoga0: wtab01Dto[i]["jchgoga0"], 
            jchgoga0: wtab01Dto[i]["jchgoga0"],
            jbigo: wtab01Dto[i]["jbigo"],     
        });
        cnt++;
    }   

    
    if(arg == "M" || arg == 'C' || arg == 'B' || arg == 'D'){
        winnameGrid.columns.clear();  
        winnameGrid.autoGenerateColumns = false; 
        view_innamepage.sourceCollection  = wtab01_data;

        var cols = new wijmo.grid.Column(); 
        cols.binding = 'jkey';
        cols.header = '코드';
        cols.align = "center";
        cols.width = 180; 
        cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
            text: '<b>${item.jkey}</b>',
            click: (e, ctx) => {
                wcifChk_a(ctx.item.jkey, ctx.item.jpum, ctx.item.jgugek,  ctx.item.jchajong, ctx.item.jmodel_code, ctx.item.jcolor_code,   ctx.item.jbonsa_code );                    
                
            }
        });
        winnameGrid.columns.push(cols);  

        cols = new wijmo.grid.Column(); 
        cols.binding = 'jpum';
        cols.header = '품명'; 
        cols.align = "left"; 
        cols.width = 150;
        winnameGrid.columns.push(cols); 

        cols = new wijmo.grid.Column(); 
        cols.binding = 'jgugek';
        cols.header = '규격'; 
        cols.align = "center"; 
        cols.width = 100;
        winnameGrid.columns.push(cols);  

        cols = new wijmo.grid.Column(); 
        cols.binding = 'jchajong';
        cols.header = '차종'; 
        cols.align = "center"; 
        cols.width = 100;
        winnameGrid.columns.push(cols);   
    }else{
        
        winjcodeGrid.columns.clear();  
        winjcodeGrid.autoGenerateColumns = false; 
        view_injcodepage.sourceCollection  = wtab01_data;

        var cols = new wijmo.grid.Column(); 
        cols.binding = 'jkey';
        cols.header = '코드';
        cols.align = "center";
        cols.width = 180; 
        cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
            text: '<b>${item.jkey}</b>',
            click: (e, ctx) => {
                wcifChk_b(ctx.item.jkey, ctx.item.jpum, ctx.item.jgugek,  ctx.item.jchajong, ctx.item.jmodel_code, ctx.item.jcolor_code,   ctx.item.jbonsa_code );                    
                
            }
        });
        winjcodeGrid.columns.push(cols);  

        cols = new wijmo.grid.Column(); 
        cols.binding = 'jpum';
        cols.header = '품명'; 
        cols.align = "left"; 
        cols.width = 150;
        winjcodeGrid.columns.push(cols); 

        cols = new wijmo.grid.Column(); 
        cols.binding = 'jgugek';
        cols.header = '규격'; 
        cols.align = "center"; 
        cols.width = 100;
        winjcodeGrid.columns.push(cols);  

        cols = new wijmo.grid.Column(); 
        cols.binding = 'jchajong';
        cols.header = '차종'; 
        cols.align = "center"; 
        cols.width = 100;
        winjcodeGrid.columns.push(cols);  
    }    
}

function wcifChk_a( arg1, arg2, arg3, arg4, arg5){   
    var ls_tab = document.getElementById('tabvalue').value;   
    if(ls_tab == "C"){ 
        document.getElementById('jkey').value = arg1;   
        document.getElementById('jpumname').value = arg2;  
        searchList_rtn(ls_tab)
        $("#winnamemodal_btn").trigger("click");
    }else if(ls_tab == "B"){ 
        document.getElementById('jkey02').value = arg1;   
        document.getElementById('jpumname02').value = arg2;   
        searchList_rtn(ls_tab)
        $("#winnamemodal_btn").trigger("click");

    }else if(ls_tab == "D"){ 
        document.getElementById('jkey03').value = arg1;   
        document.getElementById('jpumname03').value = arg2;   
        searchList_rtn(ls_tab)
        $("#winnamemodal_btn").trigger("click");

    }  

}    
function wcifChk_b(arg1, arg2, arg3, arg4, arg5){   
    var ls_tab = document.getElementById('tabvalue').value;    
        document.getElementById('bjkey').value = arg1;   
        document.getElementById('bjpumname').value = arg2;  
        searchList_rtn(ls_tab)
        $("#winjcodemodal_btn").trigger("click");  

}    

function convert_date(arg_date){  
var ls_arg_date = String(arg_date); 
if(ls_arg_date == null || ls_arg_date.length == 0 || ls_arg_date == ""|| ls_arg_date == "null"){  
    return "";
}  
// Date 객체로 변환
const dateObj = new Date(arg_date);

// 년, 월, 일 추출 (월은 0부터 시작하므로 +1 필요)
const year = dateObj.getFullYear();
const month = String(dateObj.getMonth() + 1).padStart(2, '0');
const day = String(dateObj.getDate()).padStart(2, '0');

// "YYYY-MM-DD" 형식으로 변환
const formattedDate = `${year}${month}${day}`;
arg_date = formattedDate; 
return arg_date; 
}
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$


$(document).ready(function() {   
    init()          
    //getToday()
    fn_egov_init_date()
    // $('datetimepicker').datetimepicker({
        
    // }); 

    // $("#frdate").change(function(e){ 
    //     // console.log("달력클릭");
    //     // console.log(convert_time(e.timestamp));
    // })
    // $("#todate").change(function(e){ 
    //     // console.log("달력클릭");
    //     // console.log(convert_time(e.timestamp));
    // })
})      
function init(){ 
        
        wfrdate = new wijmo.input.InputDate('#frdate', {
            isRequired: false,
            value: null,
            placeholder: '',
            format: 'yyyy-MM-dd', 
        });
        
        wipfrdate = new wijmo.input.InputDate('#ipfrdate', {
            isRequired: false,
            value: null,
            placeholder: '',
            format: 'yyyy-MM-dd', 
        }); 

        wiptodate = new wijmo.input.InputDate('#iptodate', {
            isRequired: false,
            value: null,
            placeholder: '',
            format: 'yyyy-MM-dd', 
        }); 
        wsavedate = new wijmo.input.InputDate('#savedate', {
            isRequired: false,
            value: null,
            placeholder: '',
            format: 'yyyy-MM-dd', 
        }); 
        
        var result = new Date();
        result.setHours(result.getHours() + 9); 
        var ls_date = result.toISOString().substring(0,10);                                 
        wfrdate.value = ls_date;   
        wipfrdate.value = ls_date;  
        wiptodate.value = ls_date;    
        wsavedate.value = ls_date; 
        
} 



function getToday(){
    let today = new Date();   

    let year = today.getFullYear(); // 년도
    let month = today.getMonth() + 1;  // 월
    let date = today.getDate();  // 날짜
    let day = today.getDay();  // 요일
    if(month > 0 && month < 10) {month = "0" + month};
    if(date > 0 && date < 10) {date = "0" + date};
    let ls_frday = year + '-' + month + '-01' 
    let ls_today = year + '-' + month + '-' + date 
    document.getElementById('frdate').value = ls_frday;  
    document.getElementById('todate').value = ls_today;
    
    // document.getElementById('todate').value = ls_today;
}

function convert_time(timestamp){ 
    //현재시간
    var date = new Date(timestamp); 
    var year = date.getFullYear();
    var month = ("0" + (1 + date.getMonth())).slice(-2);
    var day = ("0" + date.getDate()).slice(-2); 
    var hh = date.getHours();  
    var min = ('0' + date.getMinutes()).slice(-2) 
    time = year +  month +  day   ;
    return time;  
}

function fn_egov_init_date(){
    // var $frdate = $('#frdate');
    // var $todate = $('#todate');
    // $frdate.datetimepicker({
    //     timepicker: false,
    //     lang: 'ko',
    //     format: 'Y-m-d',
    //     scrollMonth: false,
    //     scrollInput: false,
    //     onShow: function (ct) {                                    
    //         this.setOptions({
    //             // maxDate: $frdate.val() ? $frdate.val() : false
    //         })
    //     },
    // });

    // $todate.datetimepicker({
    //     timepicker: false,
    //     lang: 'ko',
    //     format: 'Y-m-d',    //'Y-m-d H:i',
    //     scrollMonth: false,
    //     scrollInput: false,
    //     onShow: function (ct) {
    //         this.setOptions({
    //             // minDate: $todate.val() ? $todate.val() : false
    //         })
    //     }
    // });

}

class FlexGridContextMenu {
    constructor(grid) {
        let host = grid.hostElement, menu = this._buildMenu(grid);
        host.addEventListener('contextmenu', (e) => {
            // 클릭된 셀/열 선택
            let sel = grid.selection, ht = grid.hitTest(e), row = ht.getRow();

            switch (ht.panel) {
                case grid.cells:
                let colIndex = ht.col;
                // 만약 그룹 헤더이면, 그룹 열 선택
                if (row instanceof wijmo.grid.GroupRow && row.dataItem instanceof wijmo.collections.CollectionViewGroup) {
                    let gd = row.dataItem.groupDescription;
                    if (gd instanceof wijmo.collections.PropertyGroupDescription) {
                    let col = grid.getColumn(gd.propertyName);
                    if (col && col.index > -1) {
                        colIndex = col.index;
                    }
                    }
                }
                grid.select(ht.row, colIndex);
                break;
                case grid.columnHeaders:
                grid.select(sel.row, ht.col);
                break;
                case grid.rowHeaders:
                grid.select(ht.row, sel.col);
                break;
                default:
                return; // 유효하지 않는 패널
            }
            // 현재 열에 대한 메뉴 표시
            if (grid.selection.col > -1) {
                e.preventDefault(); // 브라우저의 기본 메뉴 취소
                menu.show(e); // Wijmo 메뉴 표시
            }
        }, true);
    }
    _buildMenu(grid) {
        let menu = new wijmo.input.Menu(document.createElement('div'), {
        owner: grid.hostElement,
        displayMemberPath: 'header',
        subItemsPath: 'items',
        commandParameterPath: 'cmd',
        dropDownCssClass: 'ctx-menu',
        openOnHover: true,
        closeOnLeave: true,
        itemsSource: [
            {
            header: '정렬', items: [
                { header: 'Ascending', cmd: 'SRT_ASC' },
                { header: 'Descending', cmd: 'SRT_DESC' },
                { header: 'No Sort', cmd: 'SRT_NONE' },
                { header: '-' },
                { header: 'Clear All Sorts', cmd: 'SRT_CLR' }
            ]
            },
            { header: '-' },
            { header: 'Pin/Unpin', cmd: 'PIN' },
            { header: '-' },
            { header: 'AutoSize', cmd: 'ASZ' },
            { header: 'AutoSize All', cmd: 'ASZ_ALL' },
            { header: '-' },
            { header: 'Group/Ungroup', cmd: 'GRP' },
            { header: 'Clear All Groups', cmd: 'GRP_CLR' },
            { header: '-' },
            {
            header: '내려받기', items: [
                { header: 'CSV', cmd: 'X_CSV' },
                { header: 'XLSX', cmd: 'X_XLSX' },
                { header: 'PDF', cmd: 'X_PDF' },
            ]
            }
        ],
        command: {
            // 메뉴 명령 활성화/비활성화
            canExecuteCommand: (cmd) => {
            let view = grid.collectionView, col = grid.columns[grid.selection.col];
            switch (cmd) {
                case 'SRT_ASC':
                return col.currentSort != '+';
                case 'SRT_DESC':
                return col.currentSort != '-';
                case 'SRT_NONE':
                return col.currentSort != null;
                case 'SRT_CLR':
                return view.sortDescriptions.length > 0;
                case 'PIN':
                return true; // toggle pin
                case 'ASZ':
                case 'ASZ_ALL':
                return true;
                case 'GRP':
                return col.dataType != wijmo.DataType.Number; // don't group numbers
                case 'GRP_CLR':
                return view.groupDescriptions.length > 0;
            }
            return true;
            },
            // 메뉴 명령 실행
            executeCommand: (cmd) => {
                let view = grid.collectionView, cols = grid.columns, col = cols[grid.selection.col], sd = view.sortDescriptions, gd = view.groupDescriptions;
                switch (cmd) {
                    case 'SRT_ASC':
                    case 'SRT_DESC':
                    case 'SRT_NONE':
                    if (grid.allowSorting != wijmo.grid.AllowSorting.MultiColumn) {
                        sd.clear();
                    }
                    else {
                        for (let i = 0; i < sd.length; i++) {
                        if (sd[i].property == col.binding) {
                            sd.removeAt(i);
                            break;
                        }
                        }
                    }
                    if (cmd != 'SRT_NONE') {
                        sd.push(new wijmo.collections.SortDescription(col.binding, cmd == 'SRT_ASC'));
                    }
                        break;
                    case 'SRT_CLR':
                        sd.clear();
                        break;
                    case 'PIN':
                        let fCols = grid.frozenColumns;
                        if (col.index >= fCols) { // pinning
                            cols.moveElement(col.index, fCols, false);
                            cols.frozen++;
                        }
                        else { // unpinning
                            cols.moveElement(col.index, fCols - 1, false);
                            cols.frozen--;
                        }
                        break;
                    case 'ASZ':
                        grid.autoSizeColumn(col.index);
                        break;
                    case 'ASZ_ALL':
                        grid.autoSizeColumns(0, grid.columns.length - 1);
                        break;
                    case 'GRP':
                    // 그룹 삭제
                        for (let i = 0; i < gd.length; i++) {
                            if (gd[i].propertyName == col.binding) {
                            gd.removeAt(i);
                            return; // we're done
                            }
                        }
                        // 그룹 추가
                        gd.push(new wijmo.collections.PropertyGroupDescription(col.binding));
                        break;
                    case 'GRP_CLR':
                        gd.clear();
                        break;
                    // 내보내기
                    case 'X_CSV':
                        let rng = new wijmo.grid.CellRange(0, 0, grid.rows.length - 1, grid.columns.length - 1), csv = grid.getClipString(rng, wijmo.grid.ClipStringOptions.CSV, true, false);
                        wijmo.saveFile(csv, '재고등록.csv');
                        break;
                    case 'X_XLSX':
                        const gridView = grid.collectionView;
                        let oldPgSize = gridView.pageSize, oldPgIndex = gridView.pageIndex;

                        grid.beginUpdate();
                        gridView.pageSize = 0;

                        wijmo.grid.xlsx.FlexGridXlsxConverter.saveAsync(grid, {includeCellStyles: true, includeColumnHeaders: true}, '재고등록.xlsx',
                        saved => {
                        gridView.pageSize = oldPgSize;
                        gridView.moveToPage(oldPgIndex);
                        grid.endUpdate();
                        }, null
                        ); 
                        break;
                    case 'X_PDF':
                        wijmo.grid.pdf.FlexGridPdfConverter.export(grid, '재고등록.pdf', {
                            maxPages: 10,
                            scaleMode: wijmo.grid.pdf.ScaleMode.PageWidth,
                            documentOptions: {
                            compress: true,
                            header: { declarative: { text: '\t&[Page] of &[Pages]' } },
                            footer: { declarative: { text: '\t&[Page] of &[Pages]' } },
                            info: { author: 'GrapeCity', title: '재고등록' }
                            },
                            //내장된 폰트 정보
                            embeddedFonts: [
                                {
                                source: "https://assets.codepen.io/975719/BMHANNAPro.ttf",
                                name: "BMHANNAPro",
                                style: "normal",
                                weight: "normal",
                                sansSerif: true
                                }
                            ],
                            styles: {
                                cellStyle: { backgroundColor: '#ffffff', borderColor: '#c6c6c6', font: {family: "BMHANNAPro"} },
                                altCellStyle: { backgroundColor: '#f9f9f9' },
                                groupCellStyle: { backgroundColor: '#dddddd' },
                                headerCellStyle: { backgroundColor: '#eaeaea' }
                            }
                        });
                        break;
                }
                // 활성화 그리드 셀에 포커스 복원
                grid.refresh();
                let sel = grid.selection, cell = grid.cells.getCellElement(sel.row, sel.col);
                if (cell) {
                    cell.focus();
                }
            }
        }
        });
        // 완료
        return menu;
    }
}        


</script>
                            
                    <!-- ######################### ######################### ######################### ######################### ######################### ######################### -->
                    </body> 
                </div>
                    <!------footer ------>
                    <!-- <footer th:replace="layouts/XDashBoard/XDashBoard_footer :: XDashBoard_footer"></footer> -->
                    <!--------------------->  
            </div>
        </main>
    </div>
</header>