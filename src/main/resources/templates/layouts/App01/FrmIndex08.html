<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<header th:fragment="headerFragment">
    <!-- py-md-2 px-1 py-1 -->
    <div class="card-body d-flex align-items-center py-md-2 px-auto py-auto ">
        <main class="main" id="top"> 
            <div class="container-fluid"> 
                <script>
                    var isFluid = JSON.parse(localStorage.getItem('isFluid'));
                    if (isFluid) {
                        var container = document.querySelector('[data-layout]');
                        container.classList.remove('container');
                        container.classList.add('container-fluid');
                    }
                </script>

                <nav class="navbar navbar-light navbar-vertical navbar-expand-xl">
                    <script>
                        var navbarStyle = localStorage.getItem("navbarStyle");
                        if (navbarStyle && navbarStyle !== 'transparent') {
                            document.querySelector('.navbar-vertical').classList.add(`navbar-${navbarStyle}`);
                        }
                    </script>
                    <div class="d-flex align-items-center">
                        <div class="toggle-icon-wrapper">

                            <button class="btn navbar-toggler-humburger-icon navbar-vertical-toggle"
                                data-bs-toggle="tooltip" data-bs-placement="left" title="Toggle Navigation"><span
                                    class="navbar-toggle-icon"><span class="toggle-line"></span></span></button>

                        </div><a class="navbar-brand" href="@{/user}">
                            <!-- <div class="d-flex align-items-center py-3"><img class="me-2"
                                    th:src="@{assets/img/icons/spot-illustrations/falcon.png}" alt="" width="40" /><span
                                    class="font-sans-serif">ActasErp</span>
                            </div> -->
                        </a>
                    </div> 
                    <!------navbar vertical------>     
                    <div th:replace="layouts/layout01/navbarMemWeb :: navbar"></div>  
                </nav>
                <div class="content" id="index02"> 
                    <!------nav ------>
                    <!-- <div th:replace="layouts/layout01/headerNavWeb :: headerNav"></div>   -->

                    <body layout:fragment="index02"> 
                    <!-- ######################### ######################### ######################### ######################### ######################### ######################### -->

<!-- contents body 시작--> 
<!-- form 또는 action 으로 받아오기  --> 
<div class="con">  
    <div class="card-body bg-light">
        <ul class="nav nav-tabs">
            <li class="nav-item">
                <a class="nav-link active" data-toggle="tab" href="#step01" onclick="tabchk_rtn('A')">금형등록</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#step02"  onclick="tabchk_rtn('B')">금형수리등록</a>
            </li> 
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#step03"   onclick="tabchk_rtn('C')">금형주소록</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" data-toggle="tab" href="#step04"   onclick="tabchk_rtn('D')"><span style ="display:inline-block; color:rgb(250, 249, 249);  ">수리내역카드인쇄</span></a>
            </li>
                <input type="hidden" id="tabvalue" value="A">
        </ul>
        <div class="tab-content">
            <div class="tab-pane fade show active" id="step01">  
 
                <div class="card">
                    <div class="card-body p-3">
                        <div class="d-flex align-items-center gap-2 mb-3">
                            <input type="text" class="form-control form-control-sm" style="width: 200px;" placeholder="품명/품번 검색..." id="searchtxt"  />
                            <button class="btn btn-primary btn-sm"   id="retrieveBtn">검색</button> 
                            <label class="form-label d-block">&nbsp;</label>
                            <button type="button" class="btn btn-primary btn-sm" id="save" onclick="save_btn()">저장</button>
                            <button type="button" class="btn btn-outline-secondary btn-sm" onclick="clear_rtn('A')">신규</button>
                            <button type="button" class="btn btn-outline-danger btn-sm"  id="delete" onclick="delete_btn()">삭제</button> 
                        </div>
                        <!-- <input type="hidden" class="form-control datetimepicker" id="inmachdate" autocomplete="off"  placeholder="Y-m-d"  />  -->
                        <!-- <input type="hidden"  class="form-control datetimepicker" id="inmachstdate" autocomplete="off"  placeholder="Y-m-d"   /> 
                        <input type="hidden"  class="form-control datetimepicker" id="inmacheddate" autocomplete="off"  placeholder="Y-m-d"     >   -->
                        <input type="hidden"  id="jpum" autocomplete="off" class="form-control"  disabled  >
                        <input type="hidden"  id="pcode" autocomplete="off" class="form-control"  disabled  >
                        <input type="hidden"   id="jbigo" autocomplete="off"       >  
                        <!-- Grid Area -->
                        <!-- <div class="grid-container mb-3">  -->
                                <div id="wtab04Grid_div"  style="  height:200px;  width:1100px;   margin:0 auto; "></div>    
                        <!-- </div>  -->
                        <!-- Form Section -->
                
                        <!-- <div class="form-section"> -->
                             
                            <!-- <form class="row g-2">  
                                <div class="col-md-3">
                                    <label for="clientName" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">최초입고일</label>  
                                    <input type="text" class="form-control datetimepicker" id="inmachdate" autocomplete="off"  placeholder="Y-m-d"  /> 
                                </div> 
                                <div class="col-md-3">
                                    <label for="ceo" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">&nbsp;</label>
                                    <div class="input_wrap">                                               
                                        <button   class="btn btn-primary btn-sm" type="button" onclick="prtprocess_rtn()" style=" height:40px;  " id="wotqtyBtn">이력카드 </button>
                                    </div>
                                </div>
                                <div class="col-md-3">
                                    <label for="bizNumber" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">제작시작일자</label> 
                                    <input type="text"  class="form-control datetimepicker" id="inmachstdate" autocomplete="off"  placeholder="Y-m-d"     >  
                                </div> 
                                <div class="col-md-3">
                                    <label for="bizNumber" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">제작종료일자</label> 
                                    <input type="text"  class="form-control datetimepicker" id="inmacheddate" autocomplete="off"  placeholder="Y-m-d"     >
                                </div> 
                            </form> <br>     
                            <form class="row g-2"> 
                                <div class="col-md-3">
                                    <label for="acode" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">품목코드</label>
                                    <input class="form-control" id="pcode" type="text"    autocomplete="off"  placeholder="">    
                                </div> 
                                <div class="col-md-3">
                                    <label for="acorp" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0" >품목명</label>
                                    <input type="text"  id="jpum" autocomplete="off" class="form-control"  disabled  > 
                                </div> 
                                <div class="col-md-3">
                                    <label for="jdanwy" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">비고</label>
                                    <div class="input-group"> 
                                        <textarea class="form-control" aria-label="With textarea" name="jbigo" id="jbigo" ></textarea>
                                    </div>  
                                </div> 
                            </form>     -->
                            
                            <form class="row g-2"> 
                                <div class="col-md-3"> 
                                    <label for="ajuso1" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">금형번호<span class="text-danger">*</span></label>
                                    <input type="text"   class="form-control"  id="inmachno" autocomplete="off"  placeholder="" >      
                                </div> 
                            </form>   

                            <div class="col-12">
                                <h6 class="form-section"></h6>
                              </div>
                            <form class="row g-2"> 
                                
                                <div class="col-md-3">
                                    <label for="jpumcode" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">금형규격</label>
                                    <div class="d-flex gap-2 align-items-end">
                                        <input type="number" id="inmachgugek01" maxlength="6" class="form-control text-center" style="width: 80px;" oninput="limitTwoDigits(this)">
                                        <span class="mt-1">X</span>
                                        <input type="number" id="inmachgugek02" maxlength="6" class="form-control text-center" style="width: 80px;" oninput="limitTwoDigits(this)">
                                        <span class="mt-1">X</span>
                                        <input type="number" id="inmachgugek03" maxlength="6" class="form-control text-center" style="width: 80px;" oninput="limitTwoDigits(this)">
                                  </div>
                                </div> 
                                <div class="col-md-3">
                                    <label for="jsayang" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">n차금형</label>
                                    <input type="text"   class="form-control" id="inmachncha" autocomplete="off"   > 
                                </div> 
                                <div class="col-md-3">
                                    <label for="jpumcode" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">보증SHOT</label>
                                    <input type="text"   class="form-control" id="inmachshot" autocomplete="off"  placeholder="" >  
                                </div>
                                <div class="col-md-3">
                                    <label for="j_sr" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0"> 등급</label>
                                    <input type="text"   class="form-control" id="inmachgrade" autocomplete="off"  placeholder="" >  
                                </div>
                                <div class="col-md-3">
                                    <label for="jgugek" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">보관위치</label>
                                    <input type="text"  class="form-control"  id="inmachplace" placeholder=""  >
                                </div>
                                <div class="col-md-3">
                                    <label for="apost1" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">금형제작업체</label>
                                    <input type="text"  class="form-control"  id="inmachjaejak" placeholder=""  > 
                                </div>
                            </form>
                            <form class="row g-2"> 
                                <div class="col-md-3">
                                    <label for="ajuso1" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">거래선</label>
                                    <input type="text"  class="form-control"  id="inmachcltnm" placeholder=""  >
                                </div> 
                                <div class="col-md-3">
                                    <label for="ajuso1" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">차종(모델명)</label>
                                    <input type="text"  class="form-control"  id="inmachcha" placeholder=""  >
                                </div>  
                                <div class="col-md-3">
                                    <label for="ajumi1" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">품목명<span class="text-danger">*</span></label>
                                    <input type="text"   class="form-control"  id="inmachname" autocomplete="off"  placeholder=""> 
                                </div>
                                <div class="col-md-3">
                                    <label for="aupte" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">품번<span class="text-danger">*</span></label>  
                                    <input type="text"  class="form-control"  id="inmachcd" autocomplete="off"   >      
                                </div>
                            </form>
                            <form class="row g-2"> 
                                <div class="col-md-3">
                                    <label for="atelno" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">사용기계</label>
                                    <input type="text"   class="form-control" id="inmachuse" autocomplete="off"  placeholder="" >  
                                </div>
                                <div class="col-md-3">
                                    <label for="j_cavity" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">원재료명</label>
                                    <input type="text"   class="form-control" id="inmachwon" autocomplete="off"   > 
                                </div>
                                <div class="col-md-3">
                                    <label for="atelno" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">CAVITY 수</label>
                                    <input type="text"   class="form-control" id="inmachcavity" autocomplete="off"  placeholder="" >  
                                </div>
                                <div class="col-md-3">
                                    <label for="jboxsu1" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">제품중량(g)</label>
                                    <input type="number"   class="form-control" id="inmachgram" autocomplete="off"   > 
                                </div> 
                                <div class="col-md-3">
                                    <label for="jsayang" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">사출명</label>
                                    <input type="text"   class="form-control" id="inmachgumnm" autocomplete="off"   > 
                                </div> 
                            </form>                                    
                            <!-- <form class="row g-2"> 
                                <div class="col-md-3"> 
                                    <input type="text" class="upload-name" value="파일 찾기" readonly /> <label for="file_0" class="control-label">.</label>
                                    <input type="file" name="files_0" id="file_0" multiple='multiple'  class="upload-hidden" onchange="changeFilename(this)" />
 
                                </div> 
                                <div class="col-md-3">   
                                    <button type="button" onclick="addFile()" class="btn btn-bordered btn-xs visible-xs-inline visible-sm-inline visible-md-inline visible-lg-inline">
                                        <i class="fa fa-plus" aria-hidden="true"></i>
                                    </button>
                                    <button type="button" onclick="removeFile(this)" class="btn btn-bordered btn-xs visible-xs-inline visible-sm-inline visible-md-inline visible-lg-inline">
                                        <i class="fa fa-minus" aria-hidden="true"></i>
                                    </button>
                                </div> 
                                <div class="table table_style1"  >
                                    <table>
                                        <tbody> 
                                            <tr>
                                                <td id="cell1"></td>
                                                <td id="cell2"></td>
                                            </tr>   
                                        </tbody>
                                    </table>
                                </div>  
                            </form> -->
                                        
                        <!-- </div>       -->
                    </div>
                </div> 
            </div> 
            <div class="tab-pane fade show" id="step02"> 
                <div class="table-responsive">
                    <table class="table table-borderless" style="height: 100px;" >
                        <tbody>
                        <tr>  
                            <td class="align-top"> 
                                <div class="row gx-3" style="  margin: 10px 10px 10px;">
                                    <div class="col-auto">
                                        <div class="input-group input-group-sm"><span class="input-group-text" id="inputGroup-sizing-sm">품번</span> 
                                            <input type="text" class="form-control form-control-sm" id="infixmachcd" autocomplete="off" disabled    > 
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <div class="input-group input-group-sm"><span class="input-group-text" id="inputGroup-sizing-sm">품명</span> 
                                            <input type="text" class="form-control form-control-sm" id="infixmachname" autocomplete="off" disabled    > 
                                        </div>
                                    </div>                                                    
                                    <div class="col-auto">
                                        <div class="input-group input-group-sm"><span class="input-group-text" id="inputGroup-sizing-sm">금형번호</span> 
                                            <input type="text" class="form-control form-control-sm" id="infixmachno" autocomplete="off" disabled    > 
                                        </div>
                                    </div>   
                                </div>           
                                <div class="row gx-3" style="  margin: 10px 10px 10px;">   
                                    <div class="col-auto">
                                        <div class="input-group input-group-sm"><span class="input-group-text" id="inputGroup-sizing-sm">의뢰일</span> 
                                            <input type="text"  class="form-control datetimepicker" id="inreqdate" autocomplete="off"  placeholder="Y-m-d"     > 
                                            <input type="hidden"  id="infixid" autocomplete="off"   >  
                                        </div>
                                    </div>                                                
                                    <div class="col-auto">
                                        <div class="input-group input-group-sm"><span class="input-group-text" id="inputGroup-sizing-sm">의뢰내용</span> 
                                            <input class="form-control form-control-sm" id="inreqtext" type="text"    autocomplete="off" style="width: 400px;">  
                                        </div>
                                    </div>   
                                </div>                     
                                <div class="row gx-3" style="  margin: 10px 10px 10px;">   
                                    <div class="col-auto">
                                        <div class="input-group input-group-sm"><span class="input-group-text" id="inputGroup-sizing-sm">완료일</span> 
                                            <input type="text"  class="form-control datetimepicker" id="inrespdate" autocomplete="off"  placeholder="Y-m-d"  disabled   > 
                                        </div>
                                    </div>                                                    
                                    <div class="col-auto">
                                        <div class="input-group input-group-sm"><span class="input-group-text" id="inputGroup-sizing-sm">수리내용</span> 
                                            <input class="form-control form-control-sm" id="infixtext" type="text"    autocomplete="off" style="width: 400px;">  
                                        </div>
                                    </div>   
                                    <!-- 완료여부 -->
                                    <div class="col-auto d-flex align-items-center">
                                        <label for="infixflag" class="form-label fw-bold mb-0 me-2 text-primary">완료여부</label>
                                        <div class="form-check form-switch m-0">
                                            <input class="form-check-input" id="infixflag" type="checkbox" value="0" onchange="endflag()" >
                                        </div>
                                    </div>
                                </div>     
                                <div class="row gx-3" style="  margin: 10px 10px 10px;">                                                      
                                    <div class="col-auto">
                                        <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">수리업체</span> 
                                            <input class="form-control form-control-sm" id="infixcltnm" type="text"    autocomplete="off" style="width: 250px;">  
                                        </div>
                                    </div>   
                                    <!-- <div class="col-auto">
                                        <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">비고</span> 
                                            <input class="form-control form-control-sm" id="inremark" type="text"    autocomplete="off" style="width: 350px;">  
                                        </div>
                                    </div>     -->
                                    <!-- <div class="col-auto">  
                                        <button class="btn btn-falcon-danger me-1 mb-1 btn-sm" id="retrieveBtn"  type="button" onclick="retrieve_rtn()">조회
                                        </button>
                                    </div>   -->
                                    <div class="col-auto">  
                                        <button class="btn btn-falcon-danger me-1 mb-1 btn-sm" type="button" onclick="new_btn()">신규
                                        </button>
                                    </div>  
                                    <div class="col-auto">  
                                        <button class="btn btn-falcon-danger me-1 mb-1 btn-sm" type="button" onclick="save_btn()">저장
                                        </button>
                                    </div>  
                                    <div class="col-auto">  
                                        <button class="btn btn-falcon-danger me-1 mb-1 btn-sm" type="button" onclick="delete_btn()">삭제
                                        </button>
                                    </div>  
                                </div>       
                                <div class="row gx-3" style="  margin: 10px 10px 10px;">   
                                    
                                        <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">비고</span> 
                                            <textarea class="form-control" aria-label="With textarea" name="inremark" id="inremark" style="width: 100%; height: 120px;" ></textarea>
                                        </div>  
                                    
                                </div>                                             
                                <div class="container-fluid"  >                                                         
                                    <div id="wtab02Grid_div"  style="overflow:scroll;   height:385px;   margin:0 auto; "></div>  
                                </div>  
                            </td> 
                        </tr>
                        </tbody>
                    </table>
                </div> 
            </div> 
            
            <div class="tab-pane fade show" id="step03"> 
                <div class="table-responsive">
                    <table class="table table-borderless" style="height: 100px;" >
                        <tbody>
                        <tr>  
                            <td class="align-top"> 
                                <div class="row gx-3" style="  margin: 10px 10px 10px;">
                                    <div class="col-auto">
                                        <div class="input-group input-group-sm mb-3"><span class="input-group-text" id="inputGroup-sizing-sm">검색</span> 
                                            <input type="text" class="form-control form-control-sm" id="txtfixmachcd" autocomplete="off"    placeholder="품명/품번"  > 
                                        </div>
                                    </div>   
                                    <div class="col-auto">  
                                        <button class="btn btn-falcon-danger me-1 mb-1 btn-sm" type="button" onclick="searchList_rtn('C')">조회
                                        </button>
                                    </div>    
                                </div>                                                       
                                <div class="container-fluid"  >                                                         
                                    <div id="wtab03Grid_div"  style="overflow:scroll;   height:485px;   margin:0 auto; "></div>  
                                </div>  
                            </td> 
                        </tr>
                        </tbody>
                    </table>
                </div> 
            </div> 
            <div class="tab-pane fade show" id="step04"> 
                <div class="table-responsive">
                    <div class="container-fluid"  >                                                         
                        <div id="wtab01Grid_div"  style="overflow:scroll;   height:485px;   margin:0 auto; "></div> 
                        <div id="flexGridFooter" class="gridFooter"></div> 
                    </div>  
                </div> 
            </div> 
        </div>
    </div>  

</div>    

    <!--  모달 처리 -->
    <input class="form-control form-control-sm"  type="hidden" id="innamebtn" data-bs-toggle="modal" data-bs-target="#cifmodal"  /> 
    <!--------------------------------------------------------------------------------------->   
    <div class="modal fade" id="cifmodal" data-bs-keyboard="false"
    data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel"
    aria-hidden="true">
        <div class="modal-dialog modal-lg mt-6" role="document" id = "modalForm01"
            style="max-width: 800px">
            <div class="modal-content border-0">
                <div class="modal-body p-0" >  
                    <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">                            
                        <div class="search">
                            <div class="input_wrap">  
                                      이력현황                            
                            </div> 
                        </div>                             
                    </div>   
                    <div class="container-fluid"> 
                        <div id="wtabinGrid_div" ></div> 
                    </div>   
                </div>  

                <div class="modal-footer">
                    <div class="row g-1">
                        <div class="col-auto">
                            <button class="badge-soft-primary dropdown-item rounded-1"
                                type="button"  id="winnamemodal_btn" data-bs-dismiss="modal">Close</button>
                        </div> 
                    </div>
                </div>   

            </div>
        </div> 
    </div>  

<!--------------------------------------------------------------------------------------->     

    <!--  모달 처리 -->
    <input class="form-control form-control-sm"  type="hidden" id="innamebtn2" data-bs-toggle="modal" data-bs-target="#gomodal"  /> 
    <!--------------------------------------------------------------------------------------->   
    <div class="modal fade" id="gomodal" data-bs-keyboard="false"
    data-bs-backdrop="static" tabindex="-1" aria-labelledby="staticBackdropLabel"
    aria-hidden="true">
        <div class="modal-dialog modal-lg mt-6" role="document" id = "modalForm01"
            style="max-width: 850px">
            <div class="modal-content border-0">
                <div class="modal-body p-0" > 
                    <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">                            
                        <div class="search">
                            <div class="input_wrap">  
                                <input class="form-control form-control-sm" id="conacorp" type="text"   onkeyup="if(window.event.keyCode==13){searchListTot_rtn('M')}"
                                placeholder="품목명 "     />                                      
                            </div> 
                            <button id="wciflistBtn">
                                <img th:src="@{/assets/images/i_search.png}" alt=""> 
                            </button>
                        </div>                             
                    </div>   
                    <div class="container-fluid"> 
                        <div id="wtab05Grid_div"  style="overflow:scroll; width: 800px;  height:500px;   margin:0 auto; "></div> 
                    </div>   
                </div>  

                <div class="modal-footer">
                    <div class="row g-1">
                        <div class="col-auto">
                            <button class="badge-soft-primary dropdown-item rounded-1"
                                type="button"  id="wciflist_rtn" data-bs-dismiss="modal">Close</button>
                        </div> 
                    </div>
                </div>   

            </div>
        </div> 
    </div>  
      
 <!--------------------------------------------------------------------------------------->      

<script type="text/javascript" th:inline="javascript">
    var view_p01tab01page;
    var view_p01tab02page;
    var view_p01tab03page; 
    var view_p01tab04page; 
    var view_p01tab05page; 
    var view_innamepage
    var wtab01Grid;
    var wtab02Grid;
    var wtab03Grid; 
    var wtab04Grid; 
    var wtab05Grid;
    var wtabinGrid;  
    var typeMenu;  
    var treemap;   
    let wmachdate;
    let wmachstdate;
    let wmacheddate;
    let wreqdate;
    let wrespdate;
   var wseries_data = [0];
   
    let fileIdx = 0; /*[- 파일 인덱스 처리용 전역 변수 -]*/
    let formData = new FormData();  

    window.onload = function() {   

    view_p01tab04page = new wijmo.collections.CollectionView(getData_tab04(), {
                pageSize: 21
            }); 
    wtab04Grid = new wijmo.grid.FlexGrid('#wtab04Grid_div', {  
        autoGenerateColumns: false,
        showMarquee: true,
        isReadOnly: false, 
        // selectionMode: 'RowRange',
        allowSorting: 'MultiColumn',
        alternatingRowStep: 0,
        columns: [    
            { binding: 'machcd', header: '품번', align: "center", width: 120 }, 
            { binding: 'machname', 
                header: '품명', 
                align: "center", 
                width: 150,
                cellTemplate: wijmo.grid.cellmaker.CellMaker.makeLink({ 
                    text: '<b>${item.machname}</b>',
                    click: (e, ctx) => {
                        wcifChk_a( ctx.item.machcd,  ctx.item.machno, ctx.item.machname, 
                                   ctx.item.machdate, ctx.item.machstdate, 
                                   ctx.item.macheddate ,ctx.item.machshot, 
                                   ctx.item.machgugek01, 
                                   ctx.item.machcavity, 
                                   ctx.item.machuse,  ctx.item.machcha, 
                                   ctx.item.machcltnm,ctx.item.machplace, 
                                   ctx.item.machwon, ctx.item.machgrade, 
                                   ctx.item.machgram, ctx.item.machncha, 
                                   ctx.item.machjaejak, ctx.item.inpcode, ctx.item.injpum,
                                   ctx.item.machgugek02, ctx.item.machgugek03, ctx.item.machgumnm );                    
                    }
                }) 
            },      
            { binding: 'machno', header: '금형번호', align: "center", width: 120 },
            { binding: 'machwon', header: '원재료명', align: "left", width: 200 },
            { binding: 'machgugektxt', header: '금형규격', align: "left", width: 150 }, 
            { binding: 'machcltnm', header: '거래선', align: "left", width: 100 }, 
            { binding: 'machcavity', header: 'CAVITY수', align: "left", width: 100 }, 
            { binding: 'machshot', header: '예상SHOT', align: "right", width: 150 },        
            { binding: 'machdate', header: '최초일자', align: "center", width: 120 },        
        ], 
        itemsSource: view_p01tab04page
    });        

    new FlexGridContextMenu(wtab04Grid);  
    // 헤더 열 전환
    setHeaderColumn04(false);
    function setHeaderColumn04(headerOn) {
        wtab04Grid.headersVisibility = headerOn
        ? wijmo.grid.HeadersVisibility.All
        : wijmo.grid.HeadersVisibility.Column;
        // selector.column = headerOn
        // ? wtab04Grid.rowHeaders.columns[0]
        // : wtab04Grid.columns[0];
    } 
    wtab04Grid.showMarquee = true;
    wtab04Grid.focus();
    wijmo.toggleClass(wtab04Grid.hostElement, 'highlightActive', true);
    wtab04Grid.focus();


    // tab01검색 데이터 수집
    function getData_tab04(){    
                var wtab01Dto = [[${Index08List}]];   
                var wactnm_data = [];   
                var cnt = 1;  
                var machgugektxt = "";
                for (var i = 0; i < wtab01Dto.length; i++) {
                    machgugektxt = wtab01Dto[i]["machgugek01"] + 'X' + wtab01Dto[i]["machgugek02"] + 'X' + wtab01Dto[i]["machgugek03"]
                    wactnm_data.push({
                        id: i, 
                        index: cnt,
                        machcd: wtab01Dto[i]["machcd"], 
                        machno: wtab01Dto[i]["machno"], 
                        machname: wtab01Dto[i]["machname"], 
                        machdate: wtab01Dto[i]["machdate"], 
                        machstdate: wtab01Dto[i]["machstdate"], 
                        macheddate: wtab01Dto[i]["macheddate"], 
                        machshot: wtab01Dto[i]["machshot"], 
                        machgugek01: wtab01Dto[i]["machgugek01"], 
                        machgugek02: wtab01Dto[i]["machgugek02"], 
                        machgugek03: wtab01Dto[i]["machgugek03"], 
                        machgugektxt: machgugektxt, 
                        machcavity: wtab01Dto[i]["machcavity"], 
                        machuse: wtab01Dto[i]["machuse"], 
                        machcha: wtab01Dto[i]["machcha"], 
                        machcltnm: wtab01Dto[i]["machcltnm"], 
                        machjaejak: wtab01Dto[i]["machjaejak"], 
                        machplace: wtab01Dto[i]["machplace"], 
                        machamt: wtab01Dto[i]["machamt"], 
                        machwon: wtab01Dto[i]["machwon"], 
                        machgrade: wtab01Dto[i]["machgrade"],
                        machgram: wtab01Dto[i]["machgram"],  
                        machncha: wtab01Dto[i]["machncha"], 
                        machgumnm: wtab01Dto[i]["machgumnm"], 
                        remark: wtab01Dto[i]["remark"], 
                        indate: wtab01Dto[i]["indate"], 
                        inperid: wtab01Dto[i]["inperid"],   
                        inpcode: wtab01Dto[i]["inpcode"],  
                        injpum: wtab01Dto[i]["injpum"],  
                        view: '이력보기',   
                        
                    });
                    cnt++;
                }      
                return wactnm_data; 
        
    }


    
    view_p01tab03page = new wijmo.collections.CollectionView(getData_tab04(), {
                pageSize: 21
            }); 
    wtab03Grid = new wijmo.grid.FlexGrid('#wtab03Grid_div', {  
        autoGenerateColumns: false,
        showMarquee: true,
        isReadOnly: false, 
        // selectionMode: 'RowRange',
        allowSorting: 'MultiColumn',
        alternatingRowStep: 0,
        columns: [    
            { binding: 'machno', header: '금형번호', align: "center", width: 120 }, 
            { binding: 'machname', header: '품명', align: "center", width: 150 },  
            { binding: 'machcd', header: '품번', align: "center", width: 120 }, 
            { binding: 'machwon', header: '원재료명', align: "left", width: 200 },
            { binding: 'machgugek', header: '금형규격', align: "left", width: 90 }, 
            { binding: 'machcltnm', header: '거래선', align: "left", width: 100 }, 
            { binding: 'machcavity', header: 'CAVITY수', align: "left", width: 180 }, 
            { binding: 'machshot', header: '예상SHOT', align: "right", width: 150 }, 
            { binding: 'view', 
                header: '이력', 
                align: "center", 
                width: 100,
                cellTemplate: wijmo.grid.cellmaker.CellMaker.makeLink({ 
                    text: '<b>${item.view}</b>',
                    click: (e, ctx) => {
                        wcifChk_c( ctx.item.machcd);                    
                    }
                }) 
            },                    
        ], 
        itemsSource: view_p01tab03page
    });        
 
    new FlexGridContextMenu(wtab03Grid);  
    // 헤더 열 전환
    setHeaderColumn03(false);
    function setHeaderColumn03(headerOn) {
        wtab03Grid.headersVisibility = headerOn
        ? wijmo.grid.HeadersVisibility.All
        : wijmo.grid.HeadersVisibility.Column;
        // selector.column = headerOn
        // ? wtab04Grid.rowHeaders.columns[0]
        // : wtab04Grid.columns[0];
    } 
    wtab03Grid.showMarquee = true;
    wtab03Grid.focus();
    wijmo.toggleClass(wtab03Grid.hostElement, 'highlightActive', true);
    wtab03Grid.focus()




    view_p01tab02page = new wijmo.collections.CollectionView(getData_tab02(), {
        pageSize: 100
    }); 
    wtab02Grid = new wijmo.grid.FlexGrid('#wtab02Grid_div', {  
        autoGenerateColumns: false,
        showMarquee: true,
        isReadOnly: false, 
        // selectionMode: 'RowRange',
        allowSorting: 'MultiColumn',
        alternatingRowStep: 0,
        columns: [       
            { binding: 'rownum', header: '순번', align: "center", width: 50 }, 
            { binding: 'reqdate', header: '의뢰일', align: "center", width: 120 }, 
            { binding: 'reqtext', header: '의뢰내용', align: "center", width: 300 }, 
            { binding: 'respdate', header: '완료일', align: "center", width: 120 }, 
            { binding: 'fixtext', header: '수리내용', align: "center", width: 300 }, 
            { binding: 'fixcltnm', header: '수리업체', align: "center", width: 120 }, 
            { binding: 'fixflag', header: '완료', align: "center", width: 50 }, 
            { binding: 'remark', header: '비고', align: "center", width: 150 }, 
        ], 
            
        itemsSource: view_p01tab02page
        
    });   
    // 첫번째 항목(정렬/그룹화한 후)을 선택
    wtab02Grid.select(new wijmo.grid.CellRange(0, 0), true); 
    setHeaderColumn02(false);
    function setHeaderColumn02(headerOn) {
        wtab02Grid.headersVisibility = headerOn
        ? wijmo.grid.HeadersVisibility.All
        : wijmo.grid.HeadersVisibility.Column; 
    } 
        // tab01검색 데이터 수집
    function getData_tab02(){        
           var wactnm_data = [];
           var cnt = 1;
           for (var i = 0; i < 20; i++) {
               wactnm_data.push({
                   id: i, 
                   index: cnt,
                   wrmc: '', 
                   wrmcnm: '', 
                   wperid: '', 
                   wpernm: '', 
               });
               cnt++;
           }     
           return wactnm_data;                                              
    }  



    view_p01tab01page = new wijmo.collections.CollectionView(getData_tab02(), {
        pageSize: 100
    }); 
    wtab01Grid = new wijmo.grid.FlexGrid('#wtab01Grid_div', {  
        autoGenerateColumns: false,
        showMarquee: true,
        isReadOnly: false, 
        // selectionMode: 'RowRange',
        allowSorting: 'MultiColumn',
        alternatingRowStep: 0,
        columns: [       
            { binding: 'rownum', header: '순번', align: "center", width: 150 }, 
            { binding: 'reqdate', header: '의뢰일', align: "center", width: 150 }, 
            { binding: 'reqtext', header: '의뢰내용', align: "center", width: 200 },  
            { binding: 'respdate', header: '완료일', align: "center", width: 150 }, 
            { binding: 'fixtext', header: '수리내용', align: "center", width: 400 }, 
            { binding: 'fixcltnm', header: '수리업체', align: "center", width: 200 },
        ], 
            
        itemsSource: view_p01tab01page
        
    });   
    // 첫번째 항목(정렬/그룹화한 후)을 선택
    wtab01Grid.select(new wijmo.grid.CellRange(0, 0), true); 
    setHeaderColumn01(false);
    function setHeaderColumn01(headerOn) {
        wtab01Grid.headersVisibility = headerOn
        ? wijmo.grid.HeadersVisibility.All
        : wijmo.grid.HeadersVisibility.Column; 
    }     



    view_innamepage = new wijmo.collections.CollectionView(getData_tab02(), {
        pageSize: 100
    }); 
    wtabinGrid = new wijmo.grid.FlexGrid('#wtabinGrid_div', {  
        autoGenerateColumns: false,
        showMarquee: true,
        isReadOnly: false, 
        // selectionMode: 'RowRange',
        allowSorting: 'MultiColumn',
        alternatingRowStep: 0,
        columns: [       
            { binding: 'rownum', header: '순번', align: "center", width: 150 }, 
            { binding: 'reqdate', header: '의뢰일', align: "center", width: 150 }, 
            { binding: 'respdate', header: '완료일', align: "center", width: 150 }, 
            { binding: 'fixtext', header: '수리내용', align: "center", width: 400 }, 
            { binding: 'fixcltnm', header: '수리업체', align: "center", width: 200 }, 
            { binding: 'remark', header: '비고', align: "center", width: 150 }, 
        ], 
            
        itemsSource: view_innamepage
        
    });   
    
    new FlexGridContextMenu(wtabinGrid);  
    // 첫번째 항목(정렬/그룹화한 후)을 선택
    wtabinGrid.select(new wijmo.grid.CellRange(0, 0), true); 
    setHeaderColumn05(false);
    function setHeaderColumn05(headerOn) {
        wtabinGrid.headersVisibility = headerOn
        ? wijmo.grid.HeadersVisibility.All
        : wijmo.grid.HeadersVisibility.Column; 
    }  


    view_p01tab05page = new wijmo.collections.CollectionView(getData_tab03(), {
        sortDescriptions: [new wijmo.collections.SortDescription("acode", false)],
        //pageSize: 18
    });      
    wtab05Grid = new wijmo.grid.FlexGrid('#wtab05Grid_div', {  
        autoGenerateColumns: false,
        showMarquee: true,
        isReadOnly: false,   
        allowSorting: 'MultiColumn',
        alternatingRowStep: 0,
        columns: [     
            {
                binding: 'jkey',
                width: 180,
                header: '코드', 
                align:"center",
                cellTemplate: wijmo.grid.cellmaker.CellMaker.makeLink({ 
                    text: '<b>${item.jkey}</b>',
                    click: (e, ctx) => {
                        wcifChk_1(ctx.item.jkey, ctx.item.jpum, ctx.item.jgugek, ctx.item.jchajong, ctx.item.jsayang, ctx.item.jgugek2, ctx.item.j_sr, ctx.item.jpumcode, ctx.item.jdanwy);                    
                    }
                })
            }, 
            { binding: 'jpum', header: '제품명', align: "left", width: 250 }, 
            { binding: 'jgugek', header: '규격', align: "center", width: 200 },   
            { binding: 'jgugek2', header: '색상', align: "center", width: 100 },   
            { binding: 'jdanwy', header: '단위', align: "center", width: 100 },  
            { binding: 'jsayang', header: '사양구분', align: "center", width: 100 },
            { binding: 'j_net', header: '제품중량', align: "center", width: 100 },
            { binding: 'jchajong', header: '차종', align: "center", width: 100 },
            { binding: 'j_sr', header: '스프루', align: "center", width: 100 },
            { binding: 'j_ct', header: 'C/T', align: "center", width: 100 },   
            { binding: 'j_cavity', header: 'CAVITY', align: "center", width: 100 },
            { binding: 'jbigo', header: '비고', align: "center", width: 100 },
            { binding: 'w_b_gubn', header: '품목분류', align: "center", width: 100 },   
            { binding: 'j_dae', header: '대분류', align: "center", width: 0 },               
            { binding: 'j_jung', header: '중분류', align: "right", width: 0 },          
            
        ], 
        itemsSource: view_p01tab05page
    }); 

    // tab01검색 데이터 수집
    function getData_tab03(){         
        var wactnm_data = [];         
        var cnt = 1;   
        for (var i = 0; i < 20; i++) {
            wactnm_data.push({
                id: i, 
                index: cnt,
                jkey: "", 
                jpum: "", 
                jgugek: "", 
                jgugek2: "", 
                jdanwy: "", 
                jpumcode: "", 
                jsayang: "", 
                j_net: "", 
                jchajong: "", 
                j_sr: "", 
                j_ct: "", 
                j_cavity: "", 
                jbigo: "", 
                w_b_gubn: "",
                jchgoga0: "",
                j_dae: "",
                j_jung: "",
                j_misayong: "",
                j_sang: ""
            })    
            cnt++;
        }      
        return wactnm_data;                                         
    }  
        
}     
   
 

   //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
   //선택한 탭 체크 
    function tabchk_rtn(arg){
       document.getElementById('tabvalue').value = arg; 
   } 
  
   function endflag(){ 
        lb_endflag = document.getElementById('infixflag').checked ; 
        if(lb_endflag) {
             wrespdate.isDisabled = false; 
        }else{
             wrespdate.isDisabled = true; 
        } 
   }
   function new_btn(arg){  
       document.getElementById('infixid').value = "";
       document.getElementById('inreqtext').value = "";
       document.getElementById('infixtext').value = "";
       document.getElementById('infixcltnm').value = "";
       document.getElementById('inremark').value = "";
       document.getElementById('infixflag').checked = false;  
       document.getElementById('inrespdate').disabled = true;  
   }
   function save_btn(arg){
       var ls_tab = document.getElementById('tabvalue').value;  
   
       if (!confirm("저장하시겠습니까?")) {
               return ; 
       }   
       
       switch(ls_tab){
           case 'A': 
                var ls_inpcode = document.getElementById('pcode').value;
                var ls_injpum = document.getElementById('jpum').value;
                var ls_inmachcd = document.getElementById('inmachcd').value;
                var ls_inmachno = document.getElementById('inmachno').value;
                var ls_inmachname = document.getElementById('inmachname').value;
                var ls_inmachdate   =  "" //convert_date(wmachdate.value);                 
                var ls_inmachstdate =  "" //  convert_date(wmachstdate.value);  
                var ls_inmacheddate =   "" // convert_date(wmacheddate.value);   
                //    var ls_inmachdate = document.getElementById('inmachdate').value;
                //    var ls_inmachstdate = document.getElementById('inmachstdate').value;
                //    var ls_inmacheddate = document.getElementById('inmacheddate').value;
                var ls_inmachshot_raw  = document.getElementById('inmachshot')?.value ?? '';
                var ls_inmachshot = 0;
                if (ls_inmachshot_raw.trim() !== '') {
                    ls_inmachshot = parseInt(ls_inmachshot_raw.replace(/,/g, ''), 10) || 0;
                } 

                var ls_inmachgugek01 = document.getElementById('inmachgugek01').value;
                var ls_inmachgugek02 = document.getElementById('inmachgugek02').value;
                var ls_inmachgugek03 = document.getElementById('inmachgugek03').value;

                var ls_inmachcavity = document.getElementById('inmachcavity').value;
                var ls_inmachuse = document.getElementById('inmachuse').value;
                var ls_inmachcha = document.getElementById('inmachcha').value;
                var ls_inmachcltnm = document.getElementById('inmachcltnm').value;
                var ls_inmachjaejak = document.getElementById('inmachjaejak').value;
                var ls_inmachplace = document.getElementById('inmachplace').value;

                var ls_inmachwon = document.getElementById('inmachwon').value;
                var ls_inmachgrade = document.getElementById('inmachgrade').value;
                var ls_inmachgram = document.getElementById('inmachgram').value;
                var ls_inmachncha = document.getElementById('inmachncha').value; 
                var ls_inmachgumnm = document.getElementById('inmachgumnm').value; 
 
               if(ls_inmachcd == null || ls_inmachcd.length == 0 || ls_inmachcd == ""){ 
                   alert("품번을 등록하세요") 
                   document.getElementById("machcd").focus(); 
                   return ;               
               }  
               if(ls_inmachname == null || ls_inmachname.length == 0 || ls_inmachname == ""){ 
                   alert("품명을 등록하세요") 
                   document.getElementById("wrmcnm").focus(); 
                   return ;               
               }  
               if(ls_inmachdate == null || ls_inmachdate.length == 0 || ls_inmachdate == ""){ 
                //    alert("최초입고일을 등록하세요") 
                //    document.getElementById("inmachdate").focus(); 
                //    return ;               
               } 
               if(ls_inmachname == null || ls_inmachname.length == 0 || ls_inmachname == ""){ 
                //    alert("제작시작일을 등록하세요") 
                //    document.getElementById("inmachstdate").focus(); 
                //    return ;               
               } 
               if(ls_inmachname == null || ls_inmachname.length == 0 || ls_inmachname == ""){ 
                //    alert("제작종료일을 등록하세요") 
                //    document.getElementById("inmacheddate").focus(); 
                //    return ;               
               }  
               if(ls_inmachno == null || ls_inmachno.length == 0 || ls_inmachno == ""){
                   alert("금형번호를 등록하세요") 
                   document.getElementById("inmachno").focus(); 
                   return ;               
               }    
               if(ls_inmachshot == null || ls_inmachshot.length == 0  ){
                    ls_inmachshot = "0";
               }    
               if(ls_inmachgugek01 == null || ls_inmachgugek01.length == 0  ){
                    ls_inmachgugek01 = "0";
               }      
               if(ls_inmachgugek02 == null || ls_inmachgugek02.length == 0  ){
                    ls_inmachgugek02 = "0";
               }   
               if(ls_inmachgugek03 == null || ls_inmachgugek03.length == 0  ){
                    ls_inmachgugek03 = "0";
               }  
               if(ls_inmachcavity == null || ls_inmachcavity.length == 0  ){
                    ls_inmachcavity = "";
               }       
               if(ls_inmachuse == null || ls_inmachuse.length == 0  ){
                    ls_inmachuse = "";
               }      
               if(ls_inmachcha == null || ls_inmachcha.length == 0  ){
                    ls_inmachcha = "";
               }     
               if(ls_inmachcltnm == null || ls_inmachcltnm.length == 0  ){
                    ls_inmachcltnm = "";
               }     
               if(ls_inmachjaejak == null || ls_inmachjaejak.length == 0  ){
                    ls_inmachjaejak = "";
               }     
               if(ls_inmachplace == null || ls_inmachplace.length == 0  ){
                    ls_inmachplace = "";
               }     
               if(ls_inmachwon == null || ls_inmachwon.length == 0  ){
                    ls_inmachwon = "";
               }     
               if(ls_inmachgrade == null || ls_inmachgrade.length == 0  ){
                    ls_inmachgrade = "";
               }    
               if(ls_inmachgram == null || ls_inmachgram.length == 0  ){
                    ls_inmachgram = "0";
               }      
               if(ls_inmachncha == null || ls_inmachncha.length == 0  ){
                    ls_inmachncha = "";
               }         
               if(ls_inmachgumnm == null || ls_inmachgumnm.length == 0  ){
                    ls_inmachgumnm = "";
               }    
               if(ls_inpcode == null || ls_inpcode.length == 0  ){
                ls_inpcode = "";
               }     
               if(ls_injpum == null || ls_injpum.length == 0  ){
                ls_injpum = "";
               } 
               
            //    for (h = 0; h <= fileIdx; h++ ){
            //         ls_fileid = 'file_' + h;

            //         const fileInput = document.getElementById(ls_fileid);
            //         // const selectedFile = fileInput.files[0];
            //         const selectedFile = [...fileInput.files];
            //         for (s = 0; s <= selectedFile.length - 1; s++){
            //             formData.append("file", selectedFile[s]);
            //             // console.log(selectedFile[s]);
            //         }

            //     }

            // "inpcode"       : ls_inpcode, 
            // "injpum"       : ls_injpum, 
            // "inmachdate"    : ls_inmachdate, 
            // "inmachstdate"         : ls_inmachstdate , 
            // "inmacheddate"         : ls_inmacheddate, 
               var inputdata = {  
                    "inmachcd"       : ls_inmachcd,
                    "inmachno"        : ls_inmachno,
                    "inmachname"    : ls_inmachname , 
                    "inmachshot"        : ls_inmachshot,
                    "inmachgugek01"         : ls_inmachgugek01,
                    "inmachgugek02"         : ls_inmachgugek02,
                    "inmachgugek03"         : ls_inmachgugek03,
                    "inmachcavity"        : ls_inmachcavity,
                    "inmachuse"        : ls_inmachuse , 
                    "inmachcha"         : ls_inmachcha,
                    "inmachcha"      : ls_inmachcha,
                    "inmachcltnm"      : ls_inmachcltnm,
                    "inmachjaejak"      : ls_inmachjaejak,
                    "inmachplace"        : ls_inmachplace, 
                    "inmachwon"        : ls_inmachwon,
                    "inmachgrade"        : ls_inmachgrade,
                    "inmachgram"        : ls_inmachgram,  
                    "inmachncha"        : ls_inmachncha, 
                    "inmachgumnm"        : ls_inmachgumnm, 
                    
                } 
                //직전 데이타가 메모리에 남아 폼데이타 키를 삭제후 다시 데이타를 전송해야함. 
                formData.delete("key");    
                formData.append("key", new Blob([ JSON.stringify(inputdata) ], {type : "application/json"}));
        
               $.ajax({
                   url: '/app01m/index08/save',  
                    type: "POST",   
                    processData : false,                //  processData : false로 선언 시 formData를 string으로 변환하지 않음
                    contentType : false,                // contentType : false 로 선언 시 content-type 헤더가 multipart/form-data로 전송되게     
                    data: formData,                   
                    async:false,
                    success:function(data){
                        if(data == "success"){
                            alert("저장되었습니다.")
                            // console.log(formData);
                            // searchList_rtn(ls_tab);
                            // clear_rtn();       
                            listUp01()       
                        }else if(data == "dupulchk"){
                            alert("이미 등록된 품번입니다.")  
                        }else{                       
                            alert("저장중 오류가 발생했습니다. 관리자에게 문의하세요.") 
                            console.log(data);  
                        }
                    },error:function(e){
                        console.log('error',e);
                    }
               }).done(function(fragment){           

               })  
               break;   
           case 'B': 
           
                var ls_infixid = document.getElementById('infixid').value;
                var ls_infixmachcd = document.getElementById('infixmachcd').value;
                var ls_inreqtext   = document.getElementById('inreqtext').value;
                var ls_infixtext   = document.getElementById('infixtext').value;
                var ls_infixcltnm = document.getElementById('infixcltnm').value;
                var ls_inremark   = document.getElementById('inremark').value; 
                var ls_infixflag   = document.getElementById('infixflag').value;   
                var ls_inreqdate   =  convert_date(wreqdate.value);                 
                var ls_inrespdate =  convert_date(wrespdate.value);
                const j_fixflag = document.getElementById('infixflag'); 
                const is_checked = j_fixflag.checked;  
                if (!is_checked){
                    ls_infixflag = "0"
                }else{
                    ls_infixflag = "1"
                }   

               if(ls_infixmachcd == null || ls_infixmachcd.length == 0 || ls_infixmachcd == ""){ 
                   alert("품번을 선택하세요")  
                   return ;               
               }  
               if(ls_infixtext == null || ls_infixtext.length == 0 || ls_infixtext == ""){ 
                //    alert("수리내용을 등록하세요") 
                //    document.getElementById("infixtext").focus(); 
                //    return ;   
                ls_infixtext == ""            
               }  
               if(ls_inreqdate == null || ls_inreqdate.length == 0 || ls_inreqdate == ""){ 
                   alert("의뢰일을 등록하세요")  
                   return ;               
               } 
               if(is_checked){
                    if(ls_inrespdate == null || ls_inrespdate.length == 0 || ls_inrespdate == ""){ 
                        alert("완료일을 등록하세요")  
                        return ;               
                    }   
               }else{
                    ls_inrespdate = ""
               } 
               if(ls_infixcltnm == null || ls_infixcltnm.length == 0  ){
                    ls_infixcltnm = "";
               }    
               if(ls_inremark == null || ls_inremark.length == 0  ){
                    ls_inremark = "";
               }      
               if(ls_infixid == null || ls_infixid.length == 0  ){
                    ls_infixid = "0";
               }   
     

               var inputdata = {  
                    "infixid"           : ls_infixid,
                    "infixmachcd"       : ls_infixmachcd,
                    "inreqtext"         : ls_inreqtext,
                    "infixtext"         : ls_infixtext,
                    "infixcltnm"        : ls_infixcltnm , 
                    "inremark"          : ls_inremark, 
                    "inreqdate"         : ls_inreqdate , 
                    "inrespdate"        : ls_inrespdate,  
                    "infixflag"        : ls_infixflag,  
                    
                } 
                //직전 데이타가 메모리에 남아 폼데이타 키를 삭제후 다시 데이타를 전송해야함. 
                formData.delete("key");    
                formData.append("key", new Blob([ JSON.stringify(inputdata) ], {type : "application/json"}));
        
               $.ajax({
                   url: '/app01m/index08/fixsave',  
                    type: "POST",   
                    processData : false,                //  processData : false로 선언 시 formData를 string으로 변환하지 않음
                    contentType : false,                // contentType : false 로 선언 시 content-type 헤더가 multipart/form-data로 전송되게     
                    data: formData,                   
                    async:false,
                    success:function(data){
                        if(data == "success"){
                            alert("저장되었습니다.")
                            // console.log(formData);
                            searchList_rtn(ls_tab);    
                        }else{                       
                            alert("저장중 오류가 발생했습니다. 관리자에게 문의하세요.") 
                            console.log(data);  
                        }
                    },error:function(e){
                        console.log('error',e);
                    }
               }).done(function(fragment){           

               })  
               break;           
           default:    
               break;                
       } 

   } 

   function delete_btn(){ 
   
        var ls_tab = document.getElementById('tabvalue').value;  
       
       switch(ls_tab){
           case 'A': 
                var ls_inmachcd = document.getElementById('inmachcd').value;
                var ls_inmachno = document.getElementById('inmachno').value;
                var ls_inmachname = document.getElementById('inmachname').value;
                if(ls_inmachcd == null || ls_inmachcd.length == 0 || ls_inmachcd == ""){ 
                    alert("품번을 확인하세요") 
                    document.getElementById("inmachcd").focus(); 
                    return ;               
                }    

                if (!confirm("이력과 사진정보도 함께 삭제됩니다. 삭제하시겠습니까?")) {
                        return ; 
                }   
               $.ajax({
                   url: '/app01m/index08/del',  
                   type:"POST",
                   data: { 
                       "inmachcd"      : ls_inmachcd,  
                   }, 
                   async:false,
                   success:function(data){   
                       if(data == "success"){
                           alert("삭제되었습니다.")  
                           searchList_rtn(ls_tab);   
                           clear_rtn(ls_tab);   
                           clear_rtn("B");       
                           searchList_rtn("B");        
                       }else{                       
                           alert("삭제중 오류가 발생했습니다. 관리자에게 문의하세요.")  
                       }
                      
                   },error:function(e){
                       console.log("error"); 
                   }
               }).done(function(fragment){           

               })  
               break;
           case 'B': 
              var ls_infixid = document.getElementById('infixid').value;
                if(ls_infixid == null || ls_infixid.length == 0 || ls_infixid == ""){ 
                    alert("삭제할 자료를 선택하세요")  
                    return ;               
                }    
               $.ajax({
                   url: '/app01m/index08/delfix',   
                   type:"POST",
                   data: { 
                       "infixid"      : ls_infixid 
                   }, 
                   async:false,
                   success:function(data){   
                       if(data == "success"){
                           alert("삭제되었습니다.") 
                           searchList_rtn(ls_tab);  
                           clear_rtn("B");             
                       }else{                       
                           alert("삭제중 오류가 발생했습니다. 관리자에게 문의하세요.")  
                       }
                      
                   },error:function(e){
                       console.log("error"); 
                   }
               }).done(function(fragment){           

               })  
               break;
           case 'C':
               break;                
           default:    
               break;                
       } 

   }         
   function clear_rtn(ls_tab){ 
        //var ls_tab = document.getElementById('tabvalue').value;  
       switch(ls_tab){
           case 'A':  
                document.getElementById('inmachcd').value = "";
                document.getElementById('infixmachcd').value = "";
                document.getElementById('infixmachname').value = "";
                document.getElementById('infixmachno').value = "";
                document.getElementById('inmachno').value = "";
                document.getElementById('inmachname').value = "";
                document.getElementById('inmachshot').value = 0;

                document.getElementById('inmachgugek01').value = 0;
                document.getElementById('inmachgugek02').value = 0;
                document.getElementById('inmachgugek03').value = 0;
                document.getElementById('inmachcavity').value = "";
                document.getElementById('inmachuse').value = "";
                document.getElementById('inmachcha').value = "";
                document.getElementById('inmachcltnm').value = "";
                document.getElementById('inmachplace').value = "";
                document.getElementById('inmachjaejak').value = "";

                document.getElementById('inmachwon').value = "";
                document.getElementById('inmachgrade').value = "";
                document.getElementById('inmachgram').value = 0;
                document.getElementById('inmachncha').value = ""; 
                document.getElementById('inmachgumnm').value = ""; 
                
                document.getElementById('pcode').value = ""; 
                document.getElementById('jpum').value = ""; 
               break;
           case 'B':   
                document.getElementById('infixmachcd').value = "";
                document.getElementById('infixid').value = "";
                document.getElementById('infixtext').value = "";
                document.getElementById('infixcltnm').value = "";
                document.getElementById('inremark').value = "";
               break;                
           default:    
               break;                
       } 

   }
   //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
    
   function prtprocess_rtn(){    
        var ls_tab = document.getElementById('tabvalue').value;  

        switch(ls_tab){
            case 'A': 
                    var ls_inmachcd = document.getElementById('inmachcd').value;
                    var ls_inmachno = document.getElementById('inmachno').value;  
                    //선택된 매출그룹조회     
                    $.ajax({
                        url: '/app01m/index08/printview',  
                        type:"POST",
                        data: { 
                            "inmachcd"  : ls_inmachcd,  
                            "inmachno"   : ls_inmachno   ,  
                        }, 
                        async:false,
                        success:function(data){  
                            print_rtn(data)
                            // misdateArr.pop() 
                        },error:function(e){
                            console.log("error");
                            // alert(data.code);
                            // alert(data.message);
                        }
                    }).done(function(fragment){           

                    })  

                    break;           
            default:    
                break;  

        }


        //@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@ 인쇄 @@@@@@@@@@@@@@@@@@@@@@@@@@@
        //$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
     function print_rtn(getData){ 
            var ls_inmachcd = document.getElementById('inmachcd').value;
            var ls_inmachno = document.getElementById('inmachno').value;  
            
            var doc = new wijmo.pdf.PdfDocument({   
                compress: true,
                pageSettings: {
                    layout: wijmo.pdf.PdfPageOrientation.Portrait,
                    size: wijmo.pdf.PdfPageSize.Letter,
                    margins: {
                        left: 36,
                        right: 36,
                        top: 40,
                        bottom: 16
                    }
                },
                footer: {
                    declarative: {
                        text: 'mes.c-kd.com \t&[Page]\\&[Pages]',                             //text: 'EEAN Optic\t&[Page]\\&[Pages]',
                        font: new wijmo.pdf.PdfFont('times', 12),
                        brush: '#bfc1c2'
                    }
                },
                ended: (sender, args) => wijmo.pdf.saveBlob(args.blob, ls_inmachcd + '_금형이력카드.pdf')
            }) 
            
            doc.registerFont({
                source: "https://assets.codepen.io/975719/UnDotum.ttf",
                name: "BMHANNAPro",
                style: "normal",
                weight: "normal",
                sansSerif: true
            }); 

            var ls_image01 = ""
            var ls_image02 = ""
            //이력조회     
            $.ajax({
                url: '/app01m/index08/printimg',  
                type:"POST",
                data: { 
                    "inmachcd" : ls_inmachcd, 
                }, 
                async:false,
                success:function(data){  
                    ls_image01 = data[0].save_name;
                    ls_image02 = data[1].save_name;
                },error:function(e){
                    console.log("error");                            
                }
            }).done(function(fragment){           

            })  

            const addImageToPDF = async () => {
                const ls_imgstr =
                    'assets/upload/' + ls_inmachcd + '/' + ls_image01;
                 
                const imageUrl = `http://mes.c-kd.com:8500/${ls_imgstr}`;
 
                console.log(imageUrl)
                try {
                    const response = await fetch(imageUrl);
                    if (!response.ok) {
                        throw new Error('이미지 로드 실패');
                    }
                    const blob = await response.blob();
                    const reader = new FileReader();

                    return new Promise((resolve) => {
                        reader.onloadend = function () {
                            const base64EncodedImage = reader.result; // Base64 데이터
                             
                            doc.drawImage(base64EncodedImage, 36, 190, {
                                width: 250,
                                height: 150,
                            });
                            resolve();
                        };
                        reader.readAsDataURL(blob); // Blob을 Base64로 변환
                    });
                } catch (error) {
                    console.error('이미지 로드 중 오류 발생:', error);
                }
            };

            const addImageToPDF02 = async () => {
                const ls_imgstr =
                    'assets/upload/' + ls_inmachcd + '/' + ls_image02;
                 
                const imageUrl = `http://mes.c-kd.com:8500/${ls_imgstr}`;

                console.log(imageUrl)
                try {
                    const response = await fetch(imageUrl);
                    if (!response.ok) {
                        throw new Error('이미지 로드 실패');
                    }
                    const blob = await response.blob();
                    const reader = new FileReader();

                    return new Promise((resolve) => {
                        reader.onloadend = function () {
                            const base64EncodedImage = reader.result; // Base64 데이터
                             
                            doc.drawImage(base64EncodedImage, 300, 190, {
                                width: 250,
                                height: 150,
                            });
                            resolve();
                        };
                        reader.readAsDataURL(blob); // Blob을 Base64로 변환
                    });
                } catch (error) {
                    console.error('이미지 로드 중 오류 발생:', error);
                }
            };
            const processPDF = async () => {

                //getData.forEach((saledata, i, arr) => {
                    drawHeader(doc, getData);
                    
                    await addImageToPDF();
                    await addImageToPDF02();

                    drawSales(doc, getData);
                     
               // });

                doc.end(); // PDF 생성 완료
            };

            processPDF(); // 비동기 작업 호출 
      }

        function drawHeader(doc, salesdata) {
            var ls_inmachcd = document.getElementById('inmachcd').value;
            var ls_inmachno = document.getElementById('inmachno').value;  
            let tot = 0; //salesdata.expenses.totals;  

            try {  
                
            var ls_machncha = salesdata[0].machncha    
            var ls_machstdate = salesdata[0].machstdate   
            var ls_macheddate = salesdata[0].macheddate 
            var ls_gram = String(salesdata[0].machgram)
                let y = doc.y;
                doc.header.drawText("금형 이력 CARD", null, null, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 25), align: 1, baseline: 5, underline: false});   //align 1 center baseline 5 bottom
                    
                // doc.moveDown(1);
                // * draw captions *
                //doc.drawText('작  성   일  자 : ' + ls_misdatetxt + ' [' + ls_misnum + ']', 10, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11), align: 0, underline:false});
                 
                y = doc.y; 
                doc.drawText(ls_machncha  , 10, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11), align: 0, underline:true}); 
                doc.drawText('제작 : ' + ls_machstdate + ' - '  + ls_macheddate  , 380, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:true});  
                //
                //doc.drawText('등록번호 : ' + ls_eeasano, 320, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),  underline:false});                     
                //
                doc.moveDown(1);
                //  
                y = doc.y; 
                doc.drawText('[품       명] '  , 10, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11), underline:false});
                doc.drawText(  salesdata[0].machname   , 100, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false});  
                doc.drawText('[금형제작업체] '  , 300, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false}); 
                doc.drawText(  salesdata[0].machjaejak   , 400, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false});     
                //
                //doc.moveDown(1);
                //
                y = doc.y;
                doc.drawText('[품       번] '  , 10, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11), underline:false}); 
                doc.drawText(  salesdata[0].machcd   , 100, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false});
                doc.drawText('[금형보관위치] '  , 300, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false}); 
                doc.drawText(  salesdata[0].machplace   , 400, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false});    
                //
                //doc.moveDown(1); 
                //
                y = doc.y;
                doc.drawText('[거   래  선]'  , 10, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11), underline:false}); 
                doc.drawText(  salesdata[0].machcltnm   , 100, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false});
                doc.drawText('[차            종]'  , 300, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false}); 
                doc.drawText(  salesdata[0].machcha   , 400, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false});    
                //
                //doc.moveDown(1);
                // 
                y = doc.y;
                doc.drawText('[금 형  번 호]'  , 10, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11), underline:false}); 
                doc.drawText(  salesdata[0].machno   , 100, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false});
                doc.drawText('[사  용    기  계] '  , 300, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false}); 
                doc.drawText(  salesdata[0].machuse   , 400, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false});    
                //
                //doc.moveDown(1);
                // 
                y = doc.y;
                doc.drawText('[CAVITY  수]'  , 10, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11), underline:false}); 
                doc.drawText(  salesdata[0].machcavity   , 100, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false});
                doc.drawText('[원  재  료  명] '  , 300, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false}); 
                doc.drawText(  salesdata[0].machwon   , 400, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false});   

                y = doc.y;
                doc.drawText('[금  형  등  급]'  , 10, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11), underline:false}); 
                doc.drawText(  salesdata[0].machgrade   , 100, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false});
                doc.drawText('[제품 중량 (g)] '  , 300, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false}); 
                doc.drawText(  ls_gram   , 400, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false});    
                 
                y = doc.y;
                doc.drawText('[금  형  규  격]'  , 10, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11), underline:false}); 
                doc.drawText(  salesdata[0].machgugek   , 100, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false});
                doc.drawText('[수명예상 SHOT] '  , 300, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false}); 
                doc.drawText(  String(salesdata[0].machshot)   , 400, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false});    
                // 
                y = doc.y;
                doc.drawText('[최 초 입 고 일]'  , 10, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11), underline:false}); 
                doc.drawText(  salesdata[0].machdate   , 100, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false}); 
                doc.moveDown(3);                  
                y = doc.y;
                doc.drawText('사진 및 위치', 10, y, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:true}); 
                doc.moveDown(10);   
                doc.moveDown(5);                   

            }
            finally {  
            }
        }
        
      function drawSales(doc, salesdata) {
            var ls_inmachcd = document.getElementById('inmachcd').value;
            var ls_inmachno = document.getElementById('inmachno').value;  
            let tot = 0; //salesdata.expenses.totals; 
            //컬럼 수정시 footer.cells 수정할것.
            let expenses = salesdata;
            let font_url = "https://assets.codepen.io/975719/UnDotum.ttf"; 
            let minDate = expenses.machno, maxDate = salesdata.machname, columns = [
                { header: '순번', binding: 'rownum', width: 60 , align : "center"},
                { header: '의뢰일', binding: 'reqdate', format: 'c', width: 150, align : "center" },
                { header: '완료일', binding: 'respdate', format: 'c', width: 150, align : "center" }, 
                { header: '수리내용', binding: 'fixtext', format: 'c', width: 400 , align : "left"},
                { header: '수리업체', binding: 'fixcltnm', format: 'c', width: 200, align : "center" }, 
                { header: '비고', binding: 'remark', format: 'c', width: 100, align : "left" } 
            ], bold = new wijmo.pdf.PdfFont('BMHANNAPro', 10, 'normal', 'bold'), thinPen = new wijmo.pdf.PdfPen('#000000', 0.5);
            
            let flexGrid, footer;  
            //이력조회     
            $.ajax({
                url: '/app01m/index08/listtotfix',  
                type:"POST",
                data: { 
                    "searchtxt" : ls_inmachcd, 
                }, 
                async:false,
                success:function(data){  
                    tabB_grid(data);
                },error:function(e){
                    console.log("error");                            
                }
            }).done(function(fragment){           

            })  

            try { 
                footer = new wijmo.grid.FlexGrid('#flexGridFooter');
                wtab01Grid.initialize({
                    autoGenerateColumns: false,
                    allowMerging: wijmo.grid.AllowMerging.All,
                    columns: columns,
                    headersVisibility: wijmo.grid.HeadersVisibility.Column,
                    itemsSource: view_p01tab01page
                });
                //
                footer.initialize({
                    allowMerging: wijmo.grid.AllowMerging.All,
                    autoGenerateColumns: false,
                    headersVisibility: wijmo.grid.HeadersVisibility.None,
                    columns: columns,
                    itemsSource: [{
                        rownum: null,
                        reqdate: null,
                        respdate: null,
                        fixtext: null,
                        fixcltnm: null,
                        remark: null,  
                    }]
                });
                //
                footer.cells.setCellData(0, 'rownum', '', false);
                footer.cells.setCellData(0, 'reqdate', '', false);
                footer.cells.setCellData(0, 'respdate', '', false);
                footer.cells.setCellData(0, 'fixtext', '', false);
                footer.cells.setCellData(0, 'fixcltnm', '', false);
                footer.cells.setCellData(0, 'remark', '', false);   
                footer.cells.rows[0].allowMerging = true;  
                let y = doc.y;
                doc.moveDown(5);
                y = doc.y; 
                doc.drawText("금형 수리 내역", null, null, {font: new wijmo.pdf.PdfFont("BMHANNAPro", 18), align: 1, baseline: 5, underline: false});   //align 1 center baseline 5 bottom
                 
                // draw FlexGrid 
                 
                wijmo.grid.pdf.FlexGridPdfConverter.draw(wtab01Grid, doc, doc.width, null, { 
                    //내장된 폰트 정보
                    embeddedFonts: [
                        {
                        source: "https://assets.codepen.io/975719/BMHANNAPro.ttf",
                        name: "BMHANNAPro",
                        style: "normal",
                        weight: "normal",
                        sansSerif: true
                        }
                    ],
                    styles: {
                        cellStyle: { backgroundColor: '#ffffff', borderColor: '#c6c6c6', font: {family: "BMHANNAPro"} },
                        altCellStyle: { backgroundColor: '#f9f9f9' },
                        groupCellStyle: { backgroundColor: '#dddddd' },
                        headerCellStyle: { backgroundColor: '#eaeaea' }
                    } , 
                });
                
                // draw footer
                wijmo.grid.pdf.FlexGridPdfConverter.draw(footer, doc, doc.width, null, {
                    styles: {
                        cellStyle: {
                        font: { weight: 'bold', size : 13 },
                        backgroundColor: '#dddddd',
                        borderColor: '#c6c6c6'
                        }
                    }
                }); 

                doc.moveDown(1);
                y = doc.y; 
                // * draw captions *
                doc.drawText('양식QP-0903-01(0) '  , 10,  y , {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false}); 
                doc.drawText(' 주식회사 경덕산업'  , 250,  y , {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false}); 
                doc.drawText('A4(210×297mm) '  , 420,  y , {font: new wijmo.pdf.PdfFont("BMHANNAPro", 11),   underline:false});  
            }
            finally { 
                if (footer) {
                      footer.dispose();
                }
            }
        }
        


   }


    
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
    //품목현황 검색  
    document.getElementById("pcode").addEventListener("keyup", (e)=>{ 
        if(e.keyCode === 13){ 
            document.getElementById("innamebtn2").click();
            searchListTot_rtn("A"); 
        }
    });  

    function searchListTot_rtn(arg){ 
                    
        if(arg == "M"){
            searchCode = document.getElementById('conacorp').value; 
        }
        if(arg == "A"){
            searchCode = document.getElementById('pcode').value; 
        }    
        $.ajax({
            url: '/app01m/index03/list',  
            type:"POST",
            data: { 
                "searchtxt" :searchCode,
            }, 
            async:false,
            success:function(data){  
                tabF_grid(data);
            },error:function(e){
                console.log("error");                            
            }
        }).done(function(fragment){           

        })        

    } 
 
    //  tab02 grid data 수집
    function tabF_grid(data){
        var wtab05Dto  = data;    
        var wtab05_data = [];
        var cnt = 1;
        for (var i = 0; i < wtab05Dto.length; i++) {
            wtab05_data.push({
                id: i, 
                index: cnt, 
                jkey: wtab05Dto[i]["jkey"], 
                jpum: wtab05Dto[i]["jpum"], 
                jgugek: wtab05Dto[i]["jgugek"], 
                jgugek2: wtab05Dto[i]["jgugek2"], 
                jdanwy: wtab05Dto[i]["jdanwy"], 
                jpumcode: wtab05Dto[i]["jpumcode"], 
                jsayang: wtab05Dto[i]["jsayang"], 
                j_net: wtab05Dto[i]["j_net"], 
                jchajong: wtab05Dto[i]["jchajong"], 
                j_sr: wtab05Dto[i]["j_sr"], 
                j_ct: wtab05Dto[i]["j_ct"], 
                j_cavity: wtab05Dto[i]["j_cavity"], 
                jbigo: wtab05Dto[i]["jbigo"], 
                w_b_gubn: wtab05Dto[i]["w_b_gubn"],
                jchgoga0: wtab05Dto[i]["jchgoga0"], 
                j_dae: wtab05Dto[i]["j_dae"], 
                j_jung: wtab05Dto[i]["j_jung"],
                j_misayong: wtab05Dto[i]["j_misayong"],
                j_sang: wtab05Dto[i]["j_sang"]     ,
                cltcd: wtab05Dto[i]["cltcd"]        ,
                acorp: wtab05Dto[i]["acorp"]    ,
                jgumtype: wtab05Dto[i]["jgumtype"] ,  
                jgumtypenm: wtab05Dto[i]["jgumtypenm"] ,  
                jdoor1: wtab05Dto[i]["jdoor1"] ,  
                jdoor2: wtab05Dto[i]["jdoor2"] ,  
                jpumname: wtab05Dto[i]["jpumname"] , 
                            
            });
            cnt++;
        }   

        // console.log(wtab02_data); 

        wtab05Grid.columns.clear();  
        wtab05Grid.autoGenerateColumns = false; 
        view_p01tab05page.sourceCollection  = wtab05_data;

        var cols = new wijmo.grid.Column(); 
        cols.binding = 'jchajong';
        cols.header = '차종';
        cols.align = "center";
        cols.width = 100;
        wtab05Grid.columns.push(cols);  

        cols = new wijmo.grid.Column(); 
        cols.binding = 'jpum';
        cols.header = '제품명';
        cols.align = "left";
        cols.width = 150;       
        cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
            text: '<b>${item.jpum}</b>',
            click: (e, ctx) => {
                wcifChk_JKEY(ctx.item.jkey, ctx.item.jpum, ctx.item.jgugek, ctx.item.jchajong, ctx.item.jsayang, ctx.item.jgugek2, ctx.item.j_sr, ctx.item.jpumcode, ctx.item.jdanwy, ctx.item.cltcd, ctx.item.acorp);                 
                
            }
        });    
        wtab05Grid.columns.push(cols);  

        cols = new wijmo.grid.Column(); 
        cols.binding = 'jpumname';
        cols.header = '유형'; 
        cols.align = "center"; 
        cols.width = 100;
        wtab05Grid.columns.push(cols);  
        
        cols = new wijmo.grid.Column(); 
        cols.binding = 'jdoor1';
        cols.header = 'Door1'; 
        cols.align = "center"; 
        cols.width = 100;
        wtab05Grid.columns.push(cols);  
        
        cols = new wijmo.grid.Column(); 
        cols.binding = 'jdoor2';
        cols.header = 'Door2'; 
        cols.align = "center"; 
        cols.width = 100;
        wtab05Grid.columns.push(cols);  

        cols = new wijmo.grid.Column(); 
        cols.binding = 'jgugek2';
        cols.header = '색상';
        cols.align = "center";
        cols.width = 100;           
        wtab05Grid.columns.push(cols);  
    }   
     
    //                   jkey, jpum, jgugek, jchajong, jsayang, jgugek2, j_sr, jpumcode, jdanwy, cltcd, acorp  
    function wcifChk_JKEY(arg1, arg2, arg3, arg4,      arg5,     arg6, arg7,    arg8,    arg9,   arg10, arg11, arg12){  
        
        document.getElementById('pcode').value = arg1;  
        document.getElementById('jpum').value = arg2;   
        document.getElementById('inmachcha').value = arg4;   
        //document.getElementById('inmachgugek').value = arg3;   
        document.getElementById('inmachcd').value = arg8;   
        document.getElementById('inmachcltnm').value = arg11;  
        document.getElementById('inmachname').value = arg2;     
        document.getElementById('inmachgumnm').value = arg12;      

        $("#wciflist_rtn").trigger("click");
    }
               
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$
   // tab01 검색   
   document.getElementById("retrieveBtn").addEventListener("click",function(){ 
       
       var ls_tab = document.getElementById('tabvalue').value;   
       searchList_rtn(ls_tab);
   })   

   function searchList_rtn(arg1){ 
        
       switch(arg1){
           case 'A':
            var ls_searchtxt = document.getElementById('searchtxt').value; 
           $.ajax({
                   url: '/app01m/index08/listtot',  
                   type:"POST",
                   data: { 
                       "searchtxt" : ls_searchtxt, 
                   }, 
                   async:false,
                   success:function(data){ 
                       tabC_grid(data);
                   },error:function(e){
                       console.log("error");                            
                   }
               }).done(function(fragment){           

               })  
               break;
           case 'B': 
               var ls_infixmachcd = document.getElementById('infixmachcd').value;
               $.ajax({
                   url: '/app01m/index08/listtotfix',  
                   type:"POST",
                   data: { 
                       "searchtxt" : ls_infixmachcd, 
                   }, 
                   async:false,
                   success:function(data){  
                        tabA_grid(data);
                        new_btn()
                   },error:function(e){
                       console.log("error");                            
                   }
               }).done(function(fragment){           

               })  
               break; 
           case 'C': 
            var ls_searchtxt = document.getElementById('txtfixmachcd').value; 
           $.ajax({
                   url: '/app01m/index08/listtot',  
                   type:"POST",
                   data: { 
                       "searchtxt" : ls_searchtxt, 
                   }, 
                   async:false,
                   success:function(data){  
                       tabD_grid(data);
                   },error:function(e){
                       console.log("error");                            
                   }
               }).done(function(fragment){           

               })  
               break;              
           default:    
               break;                
       }
   

   }        
   function tabA_grid(data){
       var wtab02Dto  = data;    
       var wtab02_data = [];
       var cnt = 1;
       var ls_fixflag = ''
       for (var i = 0; i < wtab02Dto.length; i++) {
            if(wtab02Dto[i]["fixflag"] == '1'){
                ls_fixflag = 'O'
            }else{
                ls_fixflag = ''
            }
           
           wtab02_data.push({
               id: i, 
               index: cnt,
               rownum: wtab02Dto[i]["rownum"],
               fixid: wtab02Dto[i]["fixid"],
               fixmachcd: wtab02Dto[i]["fixmachcd"],   
               reqdate: wtab02Dto[i]["reqdate"],  
               respdate: wtab02Dto[i]["respdate"], 
               reqtext: wtab02Dto[i]["reqtext"], 
               fixtext: wtab02Dto[i]["fixtext"], 
               fixflag: wtab02Dto[i]["fixflag"], 
               fixflagtxt: ls_fixflag, 
               fixcltnm: wtab02Dto[i]["fixcltnm"], 
               remark: wtab02Dto[i]["remark"]                               
           });
           cnt++;
       }    
       wtab02Grid.columns.clear();  
       wtab02Grid.autoGenerateColumns = false; 
       view_p01tab02page.sourceCollection  = wtab02_data;

    var cols = new wijmo.grid.Column(); 
        cols.binding = 'rownum';
        cols.header = '순번';
        cols.align = "center";
        cols.width = 50;  
        wtab02Grid.columns.push(cols);    


       cols = new wijmo.grid.Column(); 
       cols.binding = 'reqdate';
       cols.header = '의뢰일';
       cols.align = "center";
       cols.width = 120; 
       cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
           text: '<b>${item.reqdate}</b>',
           click: (e, ctx) => {
            wcifChk_b(ctx.item.fixid, ctx.item.fixmachcd, ctx.item.reqdate, ctx.item.respdate, ctx.item.fixtext, ctx.item.fixcltnm, ctx.item.remark, ctx.item.reqtext, ctx.item.fixflag );
           }
       });
       wtab02Grid.columns.push(cols);    

        cols = new wijmo.grid.Column(); 
        cols.binding = 'reqtext';
        cols.header = '의뢰내용';
        cols.align = "left";
        cols.width = 300;  
        wtab02Grid.columns.push(cols);     

       cols = new wijmo.grid.Column(); 
       cols.binding = 'respdate';
       cols.header = '완료일';
       cols.align = "center";
       cols.width = 120;  
       wtab02Grid.columns.push(cols);     

        cols = new wijmo.grid.Column(); 
        cols.binding = 'fixtext';
        cols.header = '수리내용';
        cols.align = "left";
        cols.width = 300;  
        wtab02Grid.columns.push(cols);     

        cols = new wijmo.grid.Column(); 
        cols.binding = 'fixcltnm';
        cols.header = '수리업체';
        cols.align = "left";
        cols.width = 120;  
        wtab02Grid.columns.push(cols);        

        cols = new wijmo.grid.Column(); 
        cols.binding = 'fixflagtxt';
        cols.header = '완료';
        cols.align = "center";
        cols.width = 50;  
        wtab02Grid.columns.push(cols);     


        cols = new wijmo.grid.Column(); 
        cols.binding = 'remark';
        cols.header = '비고';
        cols.align = "left";
        cols.width = 150;  
        wtab02Grid.columns.push(cols);     

   }
       
   function tabB_grid(data){
       var wtab02Dto  = data;    
       var wtab02_data = [];
       var cnt = 1;
       for (var i = 0; i < wtab02Dto.length; i++) {
           wtab02_data.push({
               id: i, 
               index: cnt,
               rownum: wtab02Dto[i]["rownum"],
               fixid: wtab02Dto[i]["fixid"],
               fixmachcd: wtab02Dto[i]["fixmachcd"],   
               reqdate: wtab02Dto[i]["reqdate"], 
               respdate: wtab02Dto[i]["respdate"], 
               fixtext: wtab02Dto[i]["fixtext"], 
               fixcltnm: wtab02Dto[i]["fixcltnm"], 
               remark: wtab02Dto[i]["remark"]                               
           });
           cnt++;
       }    

        
       var ll_length =  wtab02Dto.length;
        var ll_num01 = 10;
        var ll_num02 = 0;


        ll_num02 = ll_num01 + 1;
        if (wtab02Dto.length <= ll_num01){ 
            for (var p = wtab02Dto.length + 1; p < ll_num02; p++) { 
                wtab02_data.push({
                    id: p, 
                    index: cnt,
                    rownum: '',
                    fixid: '',
                    fixmachcd: '', 
                    reqdate: '',
                    respdate: '',
                    fixtext: '',
                    fixcltnm: '',
                    remark: '',   
                });
            cnt++;
            }
        }  
 
       wtab01Grid.columns.clear();  
       wtab01Grid.autoGenerateColumns = false; 
       view_p01tab01page.sourceCollection  = wtab02_data;

    var cols = new wijmo.grid.Column(); 
        cols.binding = 'rownum';
        cols.header = '순번';
        cols.align = "center";
        cols.width = 80;  
        wtab01Grid.columns.push(cols);    


       cols = new wijmo.grid.Column(); 
       cols.binding = 'reqdate';
       cols.header = '의뢰일';
       cols.align = "center";
       cols.width = 150;  
       wtab01Grid.columns.push(cols);    

       cols = new wijmo.grid.Column(); 
       cols.binding = 'respdate';
       cols.header = '완료일';
       cols.align = "center";
       cols.width = 150;  
       wtab01Grid.columns.push(cols);     

        cols = new wijmo.grid.Column(); 
        cols.binding = 'fixtext';
        cols.header = '수리내용';
        cols.align = "left";
        cols.width = 400;  
        wtab01Grid.columns.push(cols);     

        cols = new wijmo.grid.Column(); 
        cols.binding = 'fixcltnm';
        cols.header = '수리업체';
        cols.align = "left";
        cols.width = 200;  
        wtab01Grid.columns.push(cols);     

        cols = new wijmo.grid.Column(); 
        cols.binding = 'remark';
        cols.header = '비고';
        cols.align = "left";
        cols.width = 150;  
        wtab01Grid.columns.push(cols);     

   }
 
   function tabC_grid(data){
       var wtab03Dto  = data;    
       var wtab03_data = [];
       var cnt = 1;
       for (var i = 0; i < wtab03Dto.length; i++) {
           wtab03_data.push({
               id: i, 
               index: cnt,
                machcd: wtab03Dto[i]["machcd"], 
                machno: wtab03Dto[i]["machno"], 
                machname: wtab03Dto[i]["machname"], 
                machdate: wtab03Dto[i]["machdate"], 
                machstdate: wtab03Dto[i]["machstdate"], 
                macheddate: wtab03Dto[i]["macheddate"], 
                machshot: wtab03Dto[i]["machshot"], 
                machgugek: wtab03Dto[i]["machgugek"], 
                machcavity: wtab03Dto[i]["machcavity"], 
                machuse: wtab03Dto[i]["machuse"], 
                machcha: wtab03Dto[i]["machcha"], 
                machcltnm: wtab03Dto[i]["machcltnm"], 
                machjaejak: wtab03Dto[i]["machjaejak"], 
                machplace: wtab03Dto[i]["machplace"], 
                machamt: wtab03Dto[i]["machamt"], 
                machwon: wtab03Dto[i]["machwon"], 
                machgrade: wtab03Dto[i]["machgrade"],
                machgram: wtab03Dto[i]["machgram"],  
                machncha: wtab03Dto[i]["machncha"],  
                machgumnm: wtab03Dto[i]["machgumnm"], 
                remark: wtab03Dto[i]["remark"], 
                indate: wtab03Dto[i]["indate"], 
                inperid: wtab03Dto[i]["inperid"],                            
           });
           cnt++;
       }   
       // console.log("wtab01_data",wactnm_data) +
       // console.log(wtab01_data.length);
       wtab04Grid.columns.clear();  
       wtab04Grid.autoGenerateColumns = false; 
       view_p01tab04page.sourceCollection  = wtab03_data;
       var cols = new wijmo.grid.Column(); 
       cols = new wijmo.grid.Column(); 
       cols.binding = 'machcd';
       cols.header = '품번';
       cols.align = "center";
       cols.width = 100; 
       wtab04Grid.columns.push(cols);   

       cols = new wijmo.grid.Column(); 
       cols.binding = 'machname';
       cols.header = '품명';
       cols.align = "center";
       cols.width = 150;  
       cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
           text: '<b>${item.machname}</b>',
            click: (e, ctx) => {                
                wcifChk_JKEY(ctx.item.machcd,  ctx.item.machno, ctx.item.machname,ctx.item.machdate, ctx.item.machstdate,ctx.item.macheddate ,ctx.item.machshot,ctx.item.machgugek, ctx.item.machcavity,ctx.item.machuse,  ctx.item.machcha,ctx.item.machcltnm,ctx.item.machplace,ctx.item.machwon, ctx.item.machgrade,ctx.item.machgram, ctx.item.machncha,ctx.item.machjaejak, ctx.item.machgumnm );  
            }
        }); 
       wtab04Grid.columns.push(cols);
       
       cols = new wijmo.grid.Column(); 
       cols.binding = 'machno';
       cols.header = '금형번호';
       cols.align = "center";
       cols.width = 120;  
       wtab04Grid.columns.push(cols);  

       cols = new wijmo.grid.Column(); 
       cols.binding = 'machwon';
       cols.header = '원재료명';
       cols.align = "left";
       cols.width = 120;  
       wtab04Grid.columns.push(cols);

        cols = new wijmo.grid.Column(); 
        cols.binding = 'machgugek';
        cols.header = '금형규격';
        cols.align = "left";
        cols.width = 90;  
        wtab04Grid.columns.push(cols);

        cols = new wijmo.grid.Column(); 
        cols.binding = 'machcltnm';
        cols.header = '거래선';
        cols.align = "left";
        cols.width = 100;  
        wtab04Grid.columns.push(cols);

        cols = new wijmo.grid.Column(); 
        cols.binding = 'machcavity';
        cols.header = 'CAVITY수';
        cols.align = "left";
        cols.width = 180;  
        wtab04Grid.columns.push(cols);

        cols = new wijmo.grid.Column(); 
        cols.binding = 'machshot';
        cols.header = '예상SHOT';
        cols.align = "right";
        cols.width = 150;  
        wtab04Grid.columns.push(cols);

        cols = new wijmo.grid.Column(); 
        cols.binding = 'machdate';
        cols.header = '최초일자';
        cols.align = "center";
        cols.width = 120;  
        wtab04Grid.columns.push(cols); 
   }


   function tabD_grid(data){
  
       var wtab03Dto  = data;    
       var wtab03_data = [];
       var cnt = 1;
       for (var i = 0; i < wtab03Dto.length; i++) {
           wtab03_data.push({
               id: i, 
               index: cnt,
                machcd: wtab03Dto[i]["machcd"], 
                machno: wtab03Dto[i]["machno"], 
                machname: wtab03Dto[i]["machname"], 
                machdate: wtab03Dto[i]["machdate"], 
                machstdate: wtab03Dto[i]["machstdate"], 
                macheddate: wtab03Dto[i]["macheddate"], 
                machshot: wtab03Dto[i]["machshot"], 
                machgugek: wtab03Dto[i]["machgugek"], 
                machcavity: wtab03Dto[i]["machcavity"], 
                machuse: wtab03Dto[i]["machuse"], 
                machcha: wtab03Dto[i]["machcha"], 
                machcltnm: wtab03Dto[i]["machcltnm"], 
                machjaejak: wtab03Dto[i]["machjaejak"], 
                machplace: wtab03Dto[i]["machplace"], 
                machamt: wtab03Dto[i]["machamt"], 
                machwon: wtab03Dto[i]["machwon"], 
                machgrade: wtab03Dto[i]["machgrade"],
                machgram: wtab03Dto[i]["machgram"],  
                machncha: wtab03Dto[i]["machncha"], 
                remark: wtab03Dto[i]["remark"], 
                indate: wtab03Dto[i]["indate"], 
                inperid: wtab03Dto[i]["inperid"],    
                view: '이력보기',                          
           });
           cnt++;
       }   
       // console.log("wtab01_data",wactnm_data) +
       // console.log(wtab01_data.length);
       wtab03Grid.columns.clear();  
       wtab03Grid.autoGenerateColumns = false; 
       view_p01tab03page.sourceCollection  = wtab03_data;
       
       var cols = new wijmo.grid.Column(); 
       cols.binding = 'machno';
       cols.header = '금형번호';
       cols.align = "center";
       cols.width = 120;  
       wtab03Grid.columns.push(cols);  

       cols = new wijmo.grid.Column(); 
       cols.binding = 'machname';
       cols.header = '품명';
       cols.align = "center";
       cols.width = 150;  
       wtab03Grid.columns.push(cols);

        cols = new wijmo.grid.Column(); 
        cols = new wijmo.grid.Column(); 
        cols.binding = 'machcd';
        cols.header = '품번';
        cols.align = "center";
        cols.width = 100; 
        wtab03Grid.columns.push(cols);   
       
       cols = new wijmo.grid.Column(); 
       cols.binding = 'machno';
       cols.header = '금형번호';
       cols.align = "center";
       cols.width = 120;  
       wtab03Grid.columns.push(cols);  

       cols = new wijmo.grid.Column(); 
       cols.binding = 'machwon';
       cols.header = '원재료명';
       cols.align = "left";
       cols.width = 120;  
       wtab03Grid.columns.push(cols);

        cols = new wijmo.grid.Column(); 
        cols.binding = 'machgugek';
        cols.header = '금형규격';
        cols.align = "left";
        cols.width = 90;  
        wtab03Grid.columns.push(cols);

        cols = new wijmo.grid.Column(); 
        cols.binding = 'machcltnm';
        cols.header = '거래선';
        cols.align = "left";
        cols.width = 100;  
        wtab03Grid.columns.push(cols);

        cols = new wijmo.grid.Column(); 
        cols.binding = 'machcavity';
        cols.header = 'CAVITY수';
        cols.align = "left";
        cols.width = 180;  
        wtab03Grid.columns.push(cols);

        cols = new wijmo.grid.Column(); 
        cols.binding = 'machshot';
        cols.header = '예상SHOT';
        cols.align = "right";
        cols.width = 150;  
        wtab03Grid.columns.push(cols);

        cols = new wijmo.grid.Column(); 
        cols.binding = 'view';
        cols.header = '이력';
        cols.align = "center";
        cols.width = 100;  
       cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
           text: '<b>${item.view}</b>',
            click: (e, ctx) => {                
                wcifChk_c(ctx.item.machcd);  
            }
        }); 
        wtab03Grid.columns.push(cols); 
   }

   
   function tabE_grid(data){ 
       var wtab02Dto  = data;    
       var wtab02_data = [];
       var cnt = 1;
       for (var i = 0; i < wtab02Dto.length; i++) {
           if(wtab02Dto[i]["fixflag"] == '1'){
            ls_fixflag = 'O'
           }else{
            ls_fixflag = ''
           }
        
           wtab02_data.push({
               id: i, 
               index: cnt,
               rownum: wtab02Dto[i]["rownum"],
               fixid: wtab02Dto[i]["fixid"],
               fixmachcd: wtab02Dto[i]["fixmachcd"],   
               reqdate: wtab02Dto[i]["reqdate"], 
               reqtext: wtab02Dto[i]["reqtext"], 
               respdate: wtab02Dto[i]["respdate"], 
               fixtext: wtab02Dto[i]["fixtext"], 
               fixcltnm: wtab02Dto[i]["fixcltnm"], 
               fixflag: wtab02Dto[i]["fixflag"],  
               fixflagtxt: ls_fixflag, 
               remark: wtab02Dto[i]["remark"]                               
           });
           cnt++;
       }    

        
       var ll_length =  wtab02Dto.length;
        var ll_num01 = 10;
        var ll_num02 = 0;


        ll_num02 = ll_num01 + 1;
        if (wtab02Dto.length <= ll_num01){ 
            for (var p = wtab02Dto.length + 1; p < ll_num02; p++) { 
                wtab02_data.push({
                    id: p, 
                    index: cnt,
                    rownum: '',
                    fixid: '',
                    fixmachcd: '', 
                    reqdate: '',
                    reqtext: '',
                    respdate: '',
                    fixtext: '',
                    fixcltnm: '',
                    fixflagtxt: '',
                    remark: '',   
                });
            cnt++;
            }
        }  
 
       wtabinGrid.columns.clear();  
       wtabinGrid.autoGenerateColumns = false; 
       view_innamepage.sourceCollection  = wtab02_data;

    // var cols = new wijmo.grid.Column(); 
    //     cols.binding = 'rownum';
    //     cols.header = '순번';
    //     cols.align = "center";
    //     cols.width = 50;  
    //     wtabinGrid.columns.push(cols);    


    var  cols = new wijmo.grid.Column(); 
       cols.binding = 'reqdate';
       cols.header = '의뢰일';
       cols.align = "center";
       cols.width = 120;  
       wtabinGrid.columns.push(cols);    

        cols = new wijmo.grid.Column(); 
        cols.binding = 'reqtext';
        cols.header = '의뢰내용';
        cols.align = "left";
        cols.width = 300;  
        wtabinGrid.columns.push(cols);      

       cols = new wijmo.grid.Column(); 
       cols.binding = 'respdate';
       cols.header = '완료일';
       cols.align = "center";
       cols.width = 120;  
       wtabinGrid.columns.push(cols);     

        cols = new wijmo.grid.Column(); 
        cols.binding = 'fixtext';
        cols.header = '수리내용';
        cols.align = "left";
        cols.width = 300;  
        wtabinGrid.columns.push(cols);     

        cols = new wijmo.grid.Column(); 
        cols.binding = 'fixcltnm';
        cols.header = '수리업체';
        cols.align = "left";
        cols.width = 200;  
        wtabinGrid.columns.push(cols);     

        cols = new wijmo.grid.Column(); 
        cols.binding = 'fixflagtxt';
        cols.header = '완료';
        cols.align = "center";
        cols.width = 80;  
        wtabinGrid.columns.push(cols);     

   }
 
   
   function wcifChk_a(arg0, arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9,arg10,arg11,arg12,arg13,arg14,arg15,arg16,arg17,arg18,arg19,arg20,arg21,arg22){   
        // machcd machno, machname,       machdate, machstdate, macheddate ,machshot, 
        // machgugek01, machcavity,  machuse,  machcha,    machcltnm,machplace, 
        // machwon, machgrade,     machgram, machncha,   machjaejak , machgugek02
        // machgugek03
       var ls_tab = document.getElementById('tabvalue').value; 
        
       document.getElementById('inmachcd').value = arg0;
       document.getElementById('infixmachcd').value = arg0;
       document.getElementById('inmachno').value = arg1;
       document.getElementById('infixmachno').value = arg1;
       document.getElementById('inmachname').value = arg2;       
       document.getElementById('infixmachname').value = arg2;
    //    wmachdate.value   = arg3;
    //    wmachstdate.value = arg4;
    //    wmacheddate.value = arg5;
    //    document.getElementById('inmachdate').value = arg3;
    //    document.getElementById('inmachstdate').value = arg4;
    //    document.getElementById('inmacheddate').value = arg5; 
       document.getElementById('inmachshot').value = arg6.toLocaleString();;

       document.getElementById('inmachgugek01').value = arg7;
       document.getElementById('inmachcavity').value = arg8;
       document.getElementById('inmachuse').value = arg9;
       document.getElementById('inmachcha').value = arg10;
       document.getElementById('inmachcltnm').value = arg11;
       document.getElementById('inmachplace').value = arg12;

       document.getElementById('inmachwon').value = arg13;
       document.getElementById('inmachgrade').value = arg14;
       document.getElementById('inmachgram').value = arg15;
       document.getElementById('inmachncha').value = arg16; 
       document.getElementById('inmachjaejak').value = arg17; 

       
       document.getElementById('pcode').value = arg18;
       document.getElementById('jpum').value = arg19;
       
       document.getElementById('inmachgugek02').value = arg20;
       document.getElementById('inmachgugek03').value = arg21;
       document.getElementById('inmachgumnm').value = arg22;


       var ls_image01 = "" ;
       var ls_image02 = "" ;
        // //이력조회     
        // $.ajax({
        //     url: '/app01m/index08/printimg',  
        //     type:"POST",
        //     data: { 
        //         "inmachcd" : arg0, 
        //     }, 
        //     async:false,
        //     success:function(data){  
        //         ls_image01 = data[0].file_url;
        //         ls_image02 = data[1].file_url;
        //         console.log(ls_image01)
        //         console.log(ls_image02)
        //     },error:function(e){
        //         console.log("error");                            
        //     }
        // }).done(function(fragment){           

        // })  

        // th:src="@{assets/img/icons/spot-illustrations/falcon.png}"
    //     const timestamp = new Date().getTime();
    //     var ls_src01 = "assets/upload/" + arg0 + "/" + ls_image01;
    //     var ls_src02 = "assets/upload/" + arg0 + "/" + ls_image02; 
    //     const imageUrl01 = `http://mes.c-kd.com:8500/${ls_src01}`;
    //     const imageUrl02 = `http://mes.c-kd.com:8500/${ls_src02}`; 
        //  document.getElementById('cell1').innerHTML = '<img src="' + ls_image01 + '" alt="Image 1" style="max-width:100%; max-height:100%;"  >';
        //  document.getElementById('cell2').innerHTML = '<img src="' + ls_image02 + '" alt="Image 2" style="max-width:100%; max-height:100%;"  >';
    




        searchList_rtn("B");  

   }   
   function wcifChk_c(arg){  
        $.ajax({
            url: '/app01m/index08/listtotfix',  
            type:"POST",
            data: { 
                "searchtxt" : arg, 
            }, 
            async:false,
            success:function(data){  
                tabE_grid(data);
            },error:function(e){
                console.log("error");                            
            }
        }).done(function(fragment){           

        })  
        document.getElementById("innamebtn").click();
     
   }
   
   function confirmDeletion(imgElement, arg){
        if (confirm("이미지를 삭제하시겠습니까?")) {
                //이미지삭제     
                $.ajax({
                    url: '/app01m/index08/printimgdel',  
                    type:"POST",
                    data: { 
                        "savename" : arg, 
                    }, 
                    async:false,
                    success:function(data){  
                           alert("삭제되었습니다.") 
                    },error:function(e){
                        console.log("error");                            
                    }
                }).done(function(fragment){           

                })  

                imgElement.parentElement.innerHTML = "";
         }    
   }
   function wcifChk_b(arg1,arg2,arg3,arg4,arg5,arg6,arg7,arg8,arg9  ){   
        // fixid, fixmachcd, reqdate, respdate, fixtext, fixcltnm, remark  
       var ls_tab = document.getElementById('tabvalue').value; 
          
       document.getElementById('infixid').value = arg1; 
       document.getElementById('infixtext').value = arg5;
       document.getElementById('infixcltnm').value = arg6;
       document.getElementById('inremark').value = arg7;   
       document.getElementById('inreqtext').value = arg8;  
       if(arg9 == '1') { 
        document.getElementById('infixflag').checked = true;    
        wrespdate.isDisabled = false; 
       }else{
        document.getElementById('infixflag').checked = false;    
        wrespdate.isDisabled = true; 
       }
       wreqdate.value   = arg3;
       wrespdate.value = arg4; 
       

   }   


function addFile() {

    const fileDivs = $('div[data-name="fileDiv"]');
    if (fileDivs.length > 2) {
        alert('파일은 최대 세 개까지 업로드 할 수 있습니다.');
        return false;
    } 
    fileIdx++;
    const fileHtml = `
    <div data-name="fileDiv" class="form-group filebox bs3-primary">
        <div class="table table_style3">
            <table>
                <tr>
                    <th>첨부사진 #${fileIdx}</th>
                    <td colspan="5">
                        <!-- <label for="file_${fileIdx}" class="col-sm-2 control-label">파일1</label> -->
                        <div class="col-sm-15">
                            <input type="text" class="upload-name" value="파일 찾기" readonly />
                            <label for="file_${fileIdx}" class="control-label">찾아보기</label>
                            <input type="file" name="files_${fileIdx}" id="file_${fileIdx}" multiple='multiple'  class="upload-hidden" onchange="changeFilename(this)" />

                            <button type="button" onclick="removeFile(this)" class="btn btn-bordered btn-xs visible-xs-inline visible-sm-inline visible-md-inline visible-lg-inline">
                                <i class="fa fa-minus" aria-hidden="true"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            </table>
        </div>
    </div>
    `;


    $('#btnDiv').before(fileHtml);
}

function removeFile(elem) {

    const prevTag = $(elem).prev().prop('tagName');
    if (prevTag === 'BUTTON') {
        const file = $(elem).prevAll('input[type="file"]');
        const filename = $(elem).prevAll('input[type="text"]');
        file.val('');
        filename.val('파일 찾기');
        return false;
    }

    const target = $(elem).parents('div[data-name="fileDiv"]');
    fileIdx = fileIdx - 1;
    target.remove();
}


function deleteFile(elem, arg1, arg2) {

    if (!confirm("파일을 삭제하시겠습니까?")) {
        return ;
    }

    //도면 파일 삭제
    $.ajax({
        url: '/appadmod/filedel',
        type:"POST",
        data: {
            "actidxz"     : arg1 ,
            "actnseqz"    : arg2 ,
            "actnflagz"    : "NN"
        },
        async:false,
        success:function(data){
            if(data == "success"){
                // console.log("deletefile", data);
                const target = $(elem).parents('div[data-name="fileDiv"]');
                target.remove();
            }else{
                alert("삭제중 오류가 발생했습니다. 관리자에게 문의하세요.")
            }
        },error:function(e){
            console.log('error',e);
        }
    }).done(function(fragment){

    })


} 
function changeFilename(file) { 
    file = $(file);
    const filename = file[0].files[0].name;
    const target = file.prevAll('input');
    target.val(filename);
}

function listUp01(){
    window.location.href = '/app01/index08';
}; 

//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$


   $(document).ready(function() {   
       init()          
       getToday()
    //    fn_egov_init_date() 
       $("#frdate").change(function(e){ 
           // console.log("달력클릭");
           // console.log(convert_time(e.timestamp));
       })
       $("#todate").change(function(e){ 
           // console.log("달력클릭");
           // console.log(convert_time(e.timestamp));
       })
   })
 
   function init(){
        // 일반 입력 날짜
        // wmachdate = new wijmo.input.InputDate('#inmachdate', {
        //     isRequired: false,
        //     value: null,
        //     placeholder: '',
        //     format: 'yyyy-MM-dd', 
        // });
        
        // wmachstdate = new wijmo.input.InputDate('#inmachstdate', {
        //     isRequired: false,
        //     value: null,
        //     placeholder: '',
        //     format: 'yyyy-MM-dd', 
        // });
        
        // wmacheddate = new wijmo.input.InputDate('#inmacheddate', {
        //     isRequired: false,
        //     value: null,
        //     placeholder: '',
        //     format: 'yyyy-MM-dd', 
        // });
        
        
        wreqdate = new wijmo.input.InputDate('#inreqdate', {
            isRequired: false,
            value: null,
            placeholder: '',
            format: 'yyyy-MM-dd', 
        });
        
        
        wrespdate = new wijmo.input.InputDate('#inrespdate', {
            isRequired: false,
            value: null,
            placeholder: '',
            format: 'yyyy-MM-dd',  
        });

        var result = new Date();
        result.setHours(result.getHours() + 9);
        var ls_date = result.toISOString().substring(0,10);
        wmachdate.value = ls_date; 
        wmachstdate.value = ls_date;  
        wmacheddate.value = ls_date;   
        wreqdate.value = ls_date;  
        wrespdate.value = ls_date; 
        // 비활성화
        wrespdate.isDisabled = true; 
         

    } 


   function getToday(){
       let today = new Date();   

       let year = today.getFullYear(); // 년도
       let month = today.getMonth() + 1;  // 월
       let date = today.getDate();  // 날짜
       let day = today.getDay();  // 요일
       if(month > 0 && month < 10) {month = "0" + month};
       if(date > 0 && date < 10) {date = "0" + date};
       let ls_frday = year + '-' + month + '-01' 
       let ls_today = year + '-' + month + '-' + date 
       // document.getElementById('frdate').value = ls_frday;
       // document.getElementById('todate').value = ls_today; 
   }

   function convert_date(arg_date){  
        var ls_arg_date = String(arg_date); 
        if(ls_arg_date == null || ls_arg_date.length == 0 || ls_arg_date == ""|| ls_arg_date == "null"){  
            return "";
        }  
        // Date 객체로 변환
        const dateObj = new Date(arg_date);

        // 년, 월, 일 추출 (월은 0부터 시작하므로 +1 필요)
        const year = dateObj.getFullYear();
        const month = String(dateObj.getMonth() + 1).padStart(2, '0');
        const day = String(dateObj.getDate()).padStart(2, '0');

        // "YYYY-MM-DD" 형식으로 변환
        const formattedDate = `${year}${month}${day}`;
        arg_date = formattedDate; 
        return arg_date;  
    }
   function convert_time(timestamp){ 
       //현재시간
       var date = new Date(timestamp); 
       var year = date.getFullYear();
       var month = ("0" + (1 + date.getMonth())).slice(-2);
       var day = ("0" + date.getDate()).slice(-2); 
       var hh = date.getHours();  
       var min = ('0' + date.getMinutes()).slice(-2) 
       time = year +  month +  day   ;
       return time;  
   }
 

   class FlexGridContextMenu {
       constructor(grid) {
           let host = grid.hostElement, menu = this._buildMenu(grid);
           host.addEventListener('contextmenu', (e) => {
               // 클릭된 셀/열 선택
               let sel = grid.selection, ht = grid.hitTest(e), row = ht.getRow();

               switch (ht.panel) {
                   case grid.cells:
                   let colIndex = ht.col;
                   // 만약 그룹 헤더이면, 그룹 열 선택
                   if (row instanceof wijmo.grid.GroupRow && row.dataItem instanceof wijmo.collections.CollectionViewGroup) {
                       let gd = row.dataItem.groupDescription;
                       if (gd instanceof wijmo.collections.PropertyGroupDescription) {
                       let col = grid.getColumn(gd.propertyName);
                       if (col && col.index > -1) {
                           colIndex = col.index;
                       }
                       }
                   }
                   grid.select(ht.row, colIndex);
                   break;
                   case grid.columnHeaders:
                   grid.select(sel.row, ht.col);
                   break;
                   case grid.rowHeaders:
                   grid.select(ht.row, sel.col);
                   break;
                   default:
                   return; // 유효하지 않는 패널
               }
               // 현재 열에 대한 메뉴 표시
               if (grid.selection.col > -1) {
                   e.preventDefault(); // 브라우저의 기본 메뉴 취소
                   menu.show(e); // Wijmo 메뉴 표시
               }
           }, true);
       }
       _buildMenu(grid) {
           let menu = new wijmo.input.Menu(document.createElement('div'), {
           owner: grid.hostElement,
           displayMemberPath: 'header',
           subItemsPath: 'items',
           commandParameterPath: 'cmd',
           dropDownCssClass: 'ctx-menu',
           openOnHover: true,
           closeOnLeave: true,
           itemsSource: [
               {
               header: '정렬', items: [
                   { header: 'Ascending', cmd: 'SRT_ASC' },
                   { header: 'Descending', cmd: 'SRT_DESC' },
                   { header: 'No Sort', cmd: 'SRT_NONE' },
                   { header: '-' },
                   { header: 'Clear All Sorts', cmd: 'SRT_CLR' }
               ]
               },
               { header: '-' },
               { header: 'Pin/Unpin', cmd: 'PIN' },
               { header: '-' },
               { header: 'AutoSize', cmd: 'ASZ' },
               { header: 'AutoSize All', cmd: 'ASZ_ALL' },
               { header: '-' },
               { header: 'Group/Ungroup', cmd: 'GRP' },
               { header: 'Clear All Groups', cmd: 'GRP_CLR' },
               { header: '-' },
               {
               header: '내려받기', items: [
                   { header: 'CSV', cmd: 'X_CSV' },
                   { header: 'XLSX', cmd: 'X_XLSX' },
                   { header: 'PDF', cmd: 'X_PDF' },
               ]
               }
           ],
           command: {
               // 메뉴 명령 활성화/비활성화
               canExecuteCommand: (cmd) => {
               let view = grid.collectionView, col = grid.columns[grid.selection.col];
               switch (cmd) {
                   case 'SRT_ASC':
                   return col.currentSort != '+';
                   case 'SRT_DESC':
                   return col.currentSort != '-';
                   case 'SRT_NONE':
                   return col.currentSort != null;
                   case 'SRT_CLR':
                   return view.sortDescriptions.length > 0;
                   case 'PIN':
                   return true; // toggle pin
                   case 'ASZ':
                   case 'ASZ_ALL':
                   return true;
                   case 'GRP':
                   return col.dataType != wijmo.DataType.Number; // don't group numbers
                   case 'GRP_CLR':
                   return view.groupDescriptions.length > 0;
               }
               return true;
               },
               // 메뉴 명령 실행
               executeCommand: (cmd) => {
                   let view = grid.collectionView, cols = grid.columns, col = cols[grid.selection.col], sd = view.sortDescriptions, gd = view.groupDescriptions;
                   switch (cmd) {
                       case 'SRT_ASC':
                       case 'SRT_DESC':
                       case 'SRT_NONE':
                       if (grid.allowSorting != wijmo.grid.AllowSorting.MultiColumn) {
                           sd.clear();
                       }
                       else {
                           for (let i = 0; i < sd.length; i++) {
                           if (sd[i].property == col.binding) {
                               sd.removeAt(i);
                               break;
                           }
                           }
                       }
                       if (cmd != 'SRT_NONE') {
                           sd.push(new wijmo.collections.SortDescription(col.binding, cmd == 'SRT_ASC'));
                       }
                           break;
                       case 'SRT_CLR':
                           sd.clear();
                           break;
                       case 'PIN':
                           let fCols = grid.frozenColumns;
                           if (col.index >= fCols) { // pinning
                               cols.moveElement(col.index, fCols, false);
                               cols.frozen++;
                           }
                           else { // unpinning
                               cols.moveElement(col.index, fCols - 1, false);
                               cols.frozen--;
                           }
                           break;
                       case 'ASZ':
                           grid.autoSizeColumn(col.index);
                           break;
                       case 'ASZ_ALL':
                           grid.autoSizeColumns(0, grid.columns.length - 1);
                           break;
                       case 'GRP':
                       // 그룹 삭제
                           for (let i = 0; i < gd.length; i++) {
                               if (gd[i].propertyName == col.binding) {
                               gd.removeAt(i);
                               return; // we're done
                               }
                           }
                           // 그룹 추가
                           gd.push(new wijmo.collections.PropertyGroupDescription(col.binding));
                           break;
                       case 'GRP_CLR':
                           gd.clear();
                           break;
                       // 내보내기
                       case 'X_CSV':
                           let rng = new wijmo.grid.CellRange(0, 0, grid.rows.length - 1, grid.columns.length - 1), csv = grid.getClipString(rng, wijmo.grid.ClipStringOptions.CSV, true, false);
                           wijmo.saveFile(csv, 'FlexGrid.csv');
                           break;
                       case 'X_XLSX':
                           const gridView = grid.collectionView;
                           let oldPgSize = gridView.pageSize, oldPgIndex = gridView.pageIndex;

                           grid.beginUpdate();
                           gridView.pageSize = 0;

                           wijmo.grid.xlsx.FlexGridXlsxConverter.saveAsync(grid, {includeCellStyles: true, includeColumnHeaders: true}, 'FlexGrid.xlsx',
                           saved => {
                           gridView.pageSize = oldPgSize;
                           gridView.moveToPage(oldPgIndex);
                           grid.endUpdate();
                           }, null
                           ); 
                           break;
                       case 'X_PDF':
                           wijmo.grid.pdf.FlexGridPdfConverter.export(grid, 'FlexGrid.pdf', {
                               maxPages: 10,
                               scaleMode: wijmo.grid.pdf.ScaleMode.PageWidth,
                               documentOptions: {
                               compress: true,
                               header: { declarative: { text: '\t&[Page] of &[Pages]' } },
                               footer: { declarative: { text: '\t&[Page] of &[Pages]' } },
                               info: { author: 'GrapeCity', title: 'FlexGrid' }
                               },
                               styles: {
                               cellStyle: { backgroundColor: '#ffffff', borderColor: '#c6c6c6' },
                               altCellStyle: { backgroundColor: '#f9f9f9' },
                               groupCellStyle: { backgroundColor: '#dddddd' },
                               headerCellStyle: { backgroundColor: '#eaeaea' }
                               }
                           });
                           break;
                   }
                   // 활성화 그리드 셀에 포커스 복원
                   grid.refresh();
                   let sel = grid.selection, cell = grid.cells.getCellElement(sel.row, sel.col);
                   if (cell) {
                       cell.focus();
                   }
               }
           }
           });
           // 완료
           return menu;
       }
   }        


</script>


                            
                    <!-- ######################### ######################### ######################### ######################### ######################### ######################### -->
                    </body> 
                </div>
                    <!------footer ------>
                    <!-- <footer th:replace="layouts/XDashBoard/XDashBoard_footer :: XDashBoard_footer"></footer> -->
                    <!--------------------->  
            </div>
        </main>
    </div>
</header>