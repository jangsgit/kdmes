<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<header th:fragment="headerFragment">
    <!-- py-md-2 px-1 py-1 -->
    <div class="card-body  d-flex align-items-center py-md-2 px-auto py-auto ">  <!--   d-flex align-items-center py-md-2 px-auto py-auto  body에 scroll이 생김-->
        <main class="main" id="top"> 
            <div class="container-fluid">  
                <script>
                    var isFluid = JSON.parse(localStorage.getItem('isFluid'));
                    if (isFluid) {
                        var container = document.querySelector('[data-layout]');
                        container.classList.remove('container');
                        container.classList.add('container-fluid');
                    }
                </script>
                

                <nav class="navbar navbar-light navbar-vertical navbar-expand-xl">
                    <script>
                        var navbarStyle = localStorage.getItem("navbarStyle");
                        if (navbarStyle && navbarStyle !== 'transparent') {
                            document.querySelector('.navbar-vertical').classList.add(`navbar-${navbarStyle}`);
                        }
                    </script>
                    <div class="d-flex align-items-center">
                        <div class="toggle-icon-wrapper">

                            <button class="btn navbar-toggler-humburger-icon navbar-vertical-toggle"
                                data-bs-toggle="tooltip" data-bs-placement="left" title="Toggle Navigation"><span
                                    class="navbar-toggle-icon"><span class="toggle-line"></span></span></button>

                        </div><a class="navbar-brand" href="@{/user}">
                            <!-- <div class="d-flex align-items-center py-3"><img class="me-2"
                                    th:src="@{assets/img/icons/spot-illustrations/falcon.png}" alt="" width="40" /><span
                                    class="font-sans-serif">ActasErp</span>
                            </div> -->
                        </a>
                    </div> 
                    <!------navbar vertical------>     
                    <div th:replace="layouts/layout01/navbarMemWeb :: navbar"></div>  
                </nav>
                <div class="content" id="index051"> 
                    <!------nav ------>
                    <!-- <div th:replace="layouts/layout01/headerNavWeb :: headerNav"></div>   -->

<body layout:fragment="index051"> 
<!-- ######################### ######################### ######################### ######################### ######################### ######################### -->
<!-- contents body 시작-->  
<!-- form 또는 action 으로 받아오기  -->
<div class="con">
    <!-- contents header -->
    <th:block th:include="layouts/APPHeader/appheadTop"/>
    <!-- 정리된 품목 등록 Form - 라벨 위치 정렬 및 구성 정돈 + 구분선 및 정렬 개선 -->
    <style>
        .form-label {
        font-weight: 600;
        text-align: left;
        }
        .form-section {
        border-top: 1px solid #ccc;
        padding-top: 1rem;
        margin-top: 1rem;
        }
    </style>
        
    <!-- contents body 시작--> 
    <div class="card">
        <div class="card-body p-3">
            <div class="d-flex align-items-center gap-2 mb-3">
                <!-- 품목분류 콤보박스 -->
                <select class="form-select form-select-sm" style="width: 120px;" id="con_gubn" name="con_gubn"  >
                    <!-- <option value="">전체</option>
                    <option value="J">제품</option> -->
                    <option value="W" checked>원자재</option>
                    <option value="B">부자재</option>
                    <!--  <option value="H">예비부품</option>
                    <option value="G">기타</option> -->
                </select>
                <input type="text" class="form-control form-control-sm" style="width: 200px;" placeholder="품목 검색..." id="searchtxt"  />
                <button class="btn btn-primary btn-sm"   id="retrieveBtn">검색</button>
                <!-- <button class="btn btn-primary btn-sm"     id="gogobtn" data-bs-toggle="modal" data-bs-target="#gomodal">제품현황</button>  -->
                <label class="form-label d-block">&nbsp;</label>
                <button type="button" class="btn btn-primary btn-sm" id="save" onclick="save_btn()">저장</button>
                <button type="button" class="btn btn-outline-secondary btn-sm" onclick="clear_rtn()">신규</button>
                <button type="button" class="btn btn-outline-danger btn-sm"  id="delete" onclick="delete_btn()">삭제</button>
                <!-- <div class="col-md-6 text-end">
                    <label class="form-label d-block">&nbsp;</label>
                    <button type="button" class="btn btn-primary btn-sm" id="save" onclick="save_btn()">저장</button>
                    <button type="button" class="btn btn-outline-secondary btn-sm" onclick="clear_rtn()">신규</button>
                    <button type="button" class="btn btn-outline-danger btn-sm"  id="delete" onclick="delete_btn()">삭제</button>
                </div>   -->
            </div>
            <!-- Grid Area -->
            <!-- <div class="grid-container mb-3">  -->
                    <div id="wtab01Grid_div"  style="  height:200px;  width:1100px;   margin:0 auto; "></div>    
            <!-- </div>  -->
            <!-- Form Section -->
    
            <!-- <div class="form-section"> -->
                 
                <form class="row g-2"> 
                    <div class="col-md-3">
                        <div class="input_wrap" style="max-width: 230px;"> 
                            <label for="companyType" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">대분류<span class="text-danger">*</span></label>
                            <select th:field="*{j1_keyList}" name="j_dae" id="j_dae" onchange="handleItemCategoryChange()" disabled>
                            <option value="">선택</option>
                            <option th:each="val : ${j1_keyList}" th:value="${val.j1_key}" th:text="${val.j1_name}">
                            </select>    
                        </div>    
                    </div>
                    <!-- <div class="col-md-3">   
                        <div class="input_wrap" style="max-width: 230px;"> 
                            <label for="companyType" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">중분류<span class="text-danger">*</span></label>
                            <select th:field="*{j2_keyList}" name="j_jung" id="j_jung">
                                <option value="">선택</option>
                                <option th:each="val : ${j2_keyList}" th:value="${val.j2_key}" th:text="${val.j2_name}">
                            </select>                                              
                        </div>     
                    </div> -->
                    <!-- <div class="col-auto">
                        <label for="clientName" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">제품코드 <span class="text-danger">*</span></label>  
                        
                    </div>  -->
                    <!-- <div class="col-auto">
                        <label for="ceo" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">차종<span class="text-danger">*</span></label>
                        <input type="text" id="jchajong"  class="form-control" />
                        <input type="hidden" id="jkey"   class="form-control"  onclick="barcode_prt()" disabled  required /> 
                    </div> -->
                    <!-- <div class="col-auto">
                        <label for="bizNumber" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">양산</label> 
                        <div class="form-check form-switch">
                            <input class="form-check-input" id="j_yangsan" value="0" type="checkbox"/>                                         
                        </div> 
                    </div> 
                    <div class="col-auto">
                        <label for="bizNumber" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">A/S</label>
                        <div class="form-check form-switch">
                            <input class="form-check-input" id="j_misayong" value="0" type="checkbox"/>                                         
                        </div>
                    </div>  -->
                    <div class="col-auto">
                        <label class="form-label" for="w_b_gubn">품목분류</label>
                        <select class="form-select" id="w_b_gubn" name="w_b_gubn" >
                          <!-- <option value="J" >제품</option> -->
                          <option value="W" checked>원자재</option>
                          <option value="B">부자재</option>
                          <!-- <option value="H">예비부품</option>
                          <option value="G">기타</option> -->
                        </select>
                      </div> 
                    <!-- <div class="col-auto">
                        <label class="form-label">품목분류</label>
                        <div class="d-flex flex-wrap gap-2">
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" id="w_b_gubn_J" name="w_b_gubn" type="radio" value="J" />
                            <label class="form-check-label" for="w_b_gubn_J">제품</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" id="w_b_gubn_W" name="w_b_gubn" type="radio" value="W" />
                            <label class="form-check-label" for="w_b_gubn_W">원자재</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" id="w_b_gubn_B" name="w_b_gubn" type="radio" value="B" />
                            <label class="form-check-label" for="w_b_gubn_B">부자재</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" id="w_b_gubn_H" name="w_b_gubn" type="radio" value="H" />
                            <label class="form-check-label" for="w_b_gubn_H">예비부품</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" id="w_b_gubn_G" name="w_b_gubn" type="radio" value="G" />
                            <label class="form-check-label" for="w_b_gubn_G">기타</label>
                          </div>
                        </div>
                    </div> -->
                </form> <br>
                <!-- <form class="row g-2">  
                    <div class="col-auto">
                        <label class="form-label">품목분류</label>
                        <div class="d-flex flex-wrap gap-2">
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" id="w_b_gubn_J" name="w_b_gubn" type="radio" value="J" />
                            <label class="form-check-label" for="w_b_gubn_J">제품</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" id="w_b_gubn_W" name="w_b_gubn" type="radio" value="W" />
                            <label class="form-check-label" for="w_b_gubn_W">원자재</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" id="w_b_gubn_B" name="w_b_gubn" type="radio" value="B" />
                            <label class="form-check-label" for="w_b_gubn_B">부자재</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" id="w_b_gubn_H" name="w_b_gubn" type="radio" value="H" />
                            <label class="form-check-label" for="w_b_gubn_H">예비부품</label>
                          </div>
                          <div class="form-check form-check-inline">
                            <input class="form-check-input" id="w_b_gubn_G" name="w_b_gubn" type="radio" value="G" />
                            <label class="form-check-label" for="w_b_gubn_G">기타</label>
                          </div>
                        </div>
                    </div>
                </form>  -->
                <div class="col-12">
                    <h6 class="form-section"></h6>
                  </div>
                <form class="row g-2">    
                    <div class="col-md-3">
                        <label for="ajumi1" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">제품명<span class="text-danger">*</span></label>
                        <div class="input_wrap" style="max-width: 225px;"  id="jpum_wrap"> 
                            <select th:field="*{jpumList}" name="jpum" id="jpum">
                                <option value="">선택</option>
                                <option th:each="val : ${jpumList}" th:value="${val.pcode}" th:text="${val.pname}">
                            </select>                                              
                        </div>
                    </div>
                    <div class="col-md-3">
                        <label for="jgugek" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">규격</label>
                        <div class="input_wrap" style="max-width: 225px;"  id="jpum_wrap"> 
                            <input type="text" id="jgugek" class="form-control"  /> 
                            <input type="hidden" id="jgumtype" class="form-control"  /> <!---  금형코드  -->
                            <input type="hidden" id="jthick" class="form-control"  />   <!---  유리두께  -->
                            <input type="hidden" id="j_cavity" class="form-control"  /> <!---  CAVITY  -->
                            <input type="hidden" id="j_sr" class="form-control"  />     <!---  스프루  -->
                            <input type="hidden" id="jboxsu1" class="form-control"  /> <!---  적입수량  -->
                            <input type="hidden" id="jpumcode" class="form-control"  /> <!---  KCC품번  -->
                            <input type="hidden" id="jsayang" class="form-control"  /> <!---  포장박스규격  -->
                            <input type="hidden" id="j_ct" class="form-control"  /> <!---  C/T  -->
                            <input type="hidden" id="acode" class="form-control"  /> <!---  거래처코드  -->   
                            <input type="hidden" id="acorp1"   >      
                            <input type="hidden" id="acorp2"   >      
                            <input type="hidden" id="acorp3"   >    
                            <input type="hidden" id="acorp"   >    
                            <input type="hidden" id="jbigo"   >    
                            <input type="hidden" id="j_yangsan"   >    
                            <input type="hidden" id="j_misayong"   >  
                            <input type="hidden" id="jchajong"  class="form-control" />
                            <input type="hidden" id="jkey"   class="form-control"  onclick="barcode_prt()" disabled  required /> 
                        </div>
                    </div>  
                    <div class="col-md-3">
                        <label for="apost1" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">색상</label>  
                        <div class="input_wrap" style="max-width: 225px;"    id="jgugek2_wrap"> 
                            <select th:field="*{colorList}" name="jgugek2" id="jgugek2">
                                <option value="">선택</option>
                                <option th:each="val : ${colorList}" th:value="${val.pcode}" th:text="${val.pname}">
                            </select>                                              
                        </div>   
                    </div> 
                    <div class="col-md-3">
                        <label for="jdanwy" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">기본단위</label>
                        <div class="input_wrap" style="max-width: 225px;"    id="jgugek2_wrap"> 
                            <input type="text" id="jdanwy" class="form-control"  />    
                            <!-- <button class="btn btn-outline-primary" type="button" id="btnSoyo">소요량</button>                  -->
                        </div>                            
                        <input type="hidden" id="j_net" class="form-control"  />   
                    </div>      
                    <div class="col-md-3">
                        <label for="ajuso1" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">GRADE</label>   <!---  금형코드  -->
                        <div class="input_wrap"  id="jpumname_wrap">     
                            <select th:field="*{formList}" name="jpumname" id="jpumname"  >  
                                <option value="">선택</option>
                                <option th:each="val : ${formList}" th:value="${val.pcode}" th:text="${val.pname}">
                            </select>    
                        </div>
                    </div> 
                    <div class="col-md-3"> 
                        <label for="ajuso1" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">제조사</label>   <!---  Door1  -->
                        <div class="input_wrap" style="max-width: 225px;"  id="jdoor1_wrap">   
                            <select th:field="*{door1List}" name="jdoor1" id="jdoor1">
                                <option value="">선택</option>
                                <option th:each="val : ${door1List}" th:value="${val.pcode}" th:text="${val.pname}">
                            </select>                                              
                        </div>   
                    </div> 
                    <div class="col-md-3">
                        <label for="atelno" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">공급처</label>   <!---  Door2  -->
                        <div class="input_wrap"  id="jdoor2_wrap">      
                            <select th:field="*{door2List}" name="jdoor2" id="jdoor2">
                                <option value="">선택</option>
                                <option th:each="val : ${door2List}" th:value="${val.pcode}" th:text="${val.pname}">
                            </select>    
                        </div>
                    </div>  
                    <!-- <div class="col-md-3">
                        <label for="atelno" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">유리두께</label>
                        <div class="input_wrap"  id="jthick_wrap">      
                            <select th:field="*{jthickList}" name="jthick" id="jthick">
                                <option value="">선택</option>
                                <option th:each="val : ${jthickList}" th:value="${val.pcode}" th:text="${val.pname}">
                            </select>    
                        </div>
                    </div> -->
                    <!-- <div class="col-md-3">
                        <label for="j_cavity" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">CAVITY</label>
                        <input type="text" id="j_cavity" class="form-control"  />
                    </div>
                    <div class="col-md-3">
                        <label for="j_sr" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">스프루</label>
                        <input type="text" id="j_sr" class="form-control"  />
                    </div>
                    <div class="col-md-3">
                        <label for="jboxsu1" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">적입수량</label>
                        <input type="number" id="jboxsu1" class="form-control"  />
                    </div>
                    <div class="col-md-3">
                        <label for="jpumcode" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">KCC품번</label>
                        <input type="text" id="jpumcode" class="form-control"  />
                    </div>
                    <div class="col-md-3">
                        <label for="jsayang" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">포장박스규격</label>
                        <input type="text" id="jsayang" class="form-control"  />
                    </div>
                    <div class="col-md-3">
                        <label for="j_ct" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">C/T</label>
                        <input type="text" id="j_ct" class="form-control"  />
                    </div>                 -->
                    <!-- <div class="col-md-3">
                        <label for="j_net" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">제품중량</label>
                        
                    </div>  -->
                </form>                    
                <!-- <form class="row g-2"> 
                    <div class="col-md-3">
                        <label for="acode" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">거래처코드</label>
                        <input type="text" id="acode" class="form-control"  />     
                        <input type="hidden" id="acorp1"   >      
                        <input type="hidden" id="acorp2"   >      
                        <input type="hidden" id="acorp3"   >  
                    </div> 
                    <div class="col-md-3">
                        <label for="acorp" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0" >거래처명</label>
                        <input type="text" id="acorp" class="form-control"  disabled />  
                    </div> 
                    <div class="col-md-3">
                        <label for="jdanwy" class="form-label ls text-uppercase text-600 fw-semi-bold mb-0">비고</label>
                        <div class="input-group"> 
                            <textarea class="form-control" aria-label="With textarea" name="jbigo" id="jbigo" ></textarea>
                        </div>  
                    </div> 
                </form> -->
            <!-- </div>       -->
        </div>
    </div>

     
 
    <!--------------------------------------------------------------------------------------->   
    <!-- 제품현황 MODAL ForM  -->  
    <div class="modal fade" id="gomodal" data-bs-keyboard="false"
    data-bs-backdrop="static" aria-labelledby="staticBackdropLabel"
    aria-hidden="true">
        <div class="modal-dialog modal-lg mt-6" role="document" id ="modalForm01" style="max-width: 80%">
            <div class="modal-content">                   
                <div class="modal-body p-0" > 
                    <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light">
                        <div class="infor_bar type2" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
                            
                            <!-- 좌측 제목 -->
                            <div class="left" style="font-weight: bold; font-size: 14px;">
                                제품현황
                            </div>
                            
                            <!-- 우측 검색영역 -->
                            <div class="right" style="display: flex; align-items: center; gap: 10px; margin-top: 5px;">
                                
                                <!-- 검색어 입력 -->
                                <div class="input-group" style="height: 28px; font-size: 13px;">
                                    <span class="input-group-text" style="height: 28px; font-size: 13px; background: #e9eff2; border: 1px solid #ccc;">
                                        검색어
                                    </span>
                                    <input class="form-control" id="conjpum" type="text" placeholder="품명  검색"
                                        onkeyup="if(window.event.keyCode==13){searchListTot_rtn('M')}"
                                        style="height: 28px; font-size: 13px; border: 1px solid #ccc; min-width: 180px;">
                                </div>

                                <!-- 조회 버튼 -->
                                <button type="button" class="color2" id="wjpumlistBtn"
                                        style="height: 30px; padding: 0 10px; background: #1c6b92; color: white; font-size: 13px; border: none; border-radius: 3px; display: flex; align-items: center; gap: 4px;">
                                    <img th:src="@{/assets/images/i_search.png}" alt="" style="width: 14px; height: 14px; vertical-align: middle;">
                                    <span style="letter-spacing: -0.15px;">조회</span>
                                </button>
                            </div>

                        </div>
                    </div>
                    
                    <div class="box_wrap with_tit" style="padding: 10px;">
                        <div class="container-fluid" style="padding: 10px;">
                            <div id="wtab02Grid_div" ></div>
                            <!-- <div  id="tab02Pager"></div> -->
                        </div>   
                    </div>
                </div>  

                <div class="modal-footer">
                    <div class="row g-1">
                        <div class="col-auto">
                            <button class="badge-soft-primary dropdown-item rounded-1"
                                type="button"  id="wjcodelist_rtn" data-bs-dismiss="modal">Close</button>
                        </div> 
                    </div>
                </div>   

            </div>
        </div> 
    </div>  
    <!--------------------------------------------------------------------------------------->   

    <!--------------------------------------------------------------------------------------->  
    
            
    <!--  모달 처리 -->
    <input class="form-control form-control-sm"  type="hidden" id="incifbtn" data-bs-toggle="modal" data-bs-target="#cifmodal"  />  
    <!-- 거래처현황 MODAL ForM  -->  
    <div class="modal fade" id="cifmodal" data-bs-keyboard="false"
    data-bs-backdrop="static" aria-labelledby="staticBackdropLabel"
    aria-hidden="true">
        <div class="modal-dialog modal-lg mt-6" role="document" id ="modalForm02" >
            <div class="modal-content">                   
                <div class="modal-body p-0" > 
                    <div class="rounded-top-lg py-3 ps-4 pe-6 bg-light"> 
                        <div class="infor_bar type2">
                            <!-- 좌측 검색영역 -->
                            <div class="left" style="display: flex; gap: 20px; flex-wrap: wrap;"> 
                        
                                <!-- 검색어 -->
                                <div style="display: flex; align-items: center;">
                                    <span class="input-group-text" style="height: 28px; font-size: 13px; background: #e9eff2; border: 1px solid #ccc;">검색어</span>
                                    <input class="form-control" type="text" id="conacorp" placeholder="거래처명 / 거래처코드"
                                           style="height: 28px; font-size: 13px; border: 1px solid #ccc; width: 200px;">
                                </div>
                            </div>
                        
                            <!-- 조회 버튼 -->
                            <div class="right" style="margin-top: 10px;">
                                <button type="button" class="color2" id="wciflistBtn"
                                        style="height: 30px; padding: 0 15px; background: #1c6b92; color: white; border: none; font-size: 13px; border-radius: 3px;">
                                    <i style="margin-right: 4px;"><img th:src="@{/assets/images/i_search.png}" alt="" style="vertical-align: middle; width: 14px;"></i>
                                    조회
                                </button>
                            </div>
                                       
                        </div> 
                    </div>   
                    <div class="box_wrap with_tit" style="padding: 10px;">
                        <div class="container-fluid" style="padding: 10px;">
                            <div id="wtab03Grid_div" ></div> 
                        </div>   
                    </div>
                </div>  

                <div class="modal-footer">
                    <div class="row g-1">
                        <div class="col-auto">
                            <button class="badge-soft-primary dropdown-item rounded-1"
                                type="button"  id="wciflist_rtn" data-bs-dismiss="modal">Close</button>
                        </div> 
                    </div>
                </div>   

            </div>
        </div> 
    </div>  
    <!--------------------------------------------------------------------------------------->   
    <!--------------------------------------------------------------------------------------->   
    <div class="modal fade" id="soyoModal" tabindex="-1" aria-labelledby="soyoModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-xl">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="soyoModalLabel">소요량 확인</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="닫기"></button>
            </div>
            <div class="modal-body">
              <iframe id="soyoFrame" src="" width="100%" height="600" frameborder="0"></iframe>
            </div>
          </div>
        </div>
      </div>
      <!--------------------------------------------------------------------------------------->   

      <script>
        // document.getElementById("btnSoyo").addEventListener("click", function () { 
        //     window.open("/app01/index06", "소요량", "width=1200,height=800");
        // });
      </script>
      
    <!--########################################자바 스크립트 시작-->
    <script th:inline="javascript"> 
        // 그리드 호출 window.onload 
        var view_p01tab01page;
        var view_innamepage;  
        var view_p01tab02page;
        var view_p01tab03page;
        var wtab01Grid;        
        var wtab02Grid;        
        var wtab03Grid;        
        var winnameGrid;  
        var typeMenu;  
        var treemap; 
        var insaflag = "";
        let barchart;
        let ani;
        var wseries_data = [0]; 
        

        const productList = [[${jpumList}]];
        const door1List = [[${door1List}]];
        const door2List = [[${door2List}]];
        const formList = [[${formList}]];
        const colorList = [[${colorList}]];
        const jthickList = [[${jthickList}]];
        
        // 폼 저장시  file data 와   string data 담을 변수 
        let formData = new FormData(); 



        window.onload = function() {   
            
            // document.querySelector('input[name="w_b_gubn"][value="J"]').checked = true; 
            document.getElementById("w_b_gubn").value = "W";
                //tab01 grid list
            view_p01tab01page = new wijmo.collections.CollectionView(getData_tab01(), {
                //sortDescriptions: [new wijmo.collections.SortDescription("jkey", false)],
                //pageSize: 21
            });
        // tab01 grid page
            // new wijmo.input.CollectionViewNavigator('#tab01Pager', {
            //     byPage: true,
            //     headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
            //     cv: view_p01tab01page
            // });      
            wtab01Grid = new wijmo.grid.FlexGrid('#wtab01Grid_div', {  
                autoGenerateColumns: false,
                showMarquee: true,
                isReadOnly: false, 
                // selectionMode: 'RowRange',
                allowSorting: 'MultiColumn',
                alternatingRowStep: 0,
                columns: [     
                    {
                        binding: 'jkey',
                        width: 180,
                        header: '코드', 
                        align:"center",
                        cellTemplate: wijmo.grid.cellmaker.CellMaker.makeLink({ 
                            text: '<b>${item.jkey}</b>',
                            click: (e, ctx) => {
                                wjcodeChk_a("A", ctx.item.jkey, ctx.item.j_dae, ctx.item.jthick, ctx.item.jgugek, ctx.item.jgugek2,ctx.item.jpum, ctx.item.jpumcode, ctx.item.jsayang, ctx.item.j_net, ctx.item.jchajong, ctx.item.j_sr,ctx.item.j_ct, ctx.item.j_cavity, ctx.item.jdanwy, ctx.item.jbigo, ctx.item.w_b_gubn , ctx.item.jpumname, ctx.item.j_misayong, ctx.item.j_sang, ctx.item.jboxsu1, ctx.item.cltcd, ctx.item.acorp, ctx.item.jgumtype, ctx.item.jdoor1, ctx.item.jdoor2, ctx.item.j_yangsan);
                            }
                        })
                    }, 
                    // { binding: 'jchajong', header: '차종', align: "center", width: 100 },  
                    {
                        binding: 'jpum',
                        width: 250,
                        header: '제품명', 
                        align:"left",
                        cellTemplate: wijmo.grid.cellmaker.CellMaker.makeLink({ 
                            text: '<b>${item.jpum}</b>',
                            click: (e, ctx) => {
                                wjcodeChk_a("A", ctx.item.jkey, ctx.item.j_dae, ctx.item.jthick, ctx.item.jgugek, ctx.item.jgugek2,ctx.item.jpum, ctx.item.jpumcode, ctx.item.jsayang, ctx.item.j_net, ctx.item.jchajong, ctx.item.j_sr,ctx.item.j_ct, ctx.item.j_cavity, ctx.item.jdanwy, ctx.item.jbigo, ctx.item.w_b_gubn , ctx.item.jpumname, ctx.item.j_misayong, ctx.item.j_sang, ctx.item.jboxsu1, ctx.item.cltcd, ctx.item.acorp, ctx.item.jgumtype, ctx.item.jdoor1, ctx.item.jdoor2, ctx.item.j_yangsan);
                            }
                        })
                    },   
                    { binding: 'w_b_gubnnm', header: '품목분류', align: "center", width: 100 },  
                    // { binding: 'jgumtypenm', header: '금형', align: "center", width: 130 }, 
                    { binding: 'jgugek', header: '규격', align: "center", width: 200 },   
                    { binding: 'jgugek2', header: '색상', align: "center", width: 100 },   
                    { binding: 'jdanwy', header: '단위', align: "center", width: 100 },  
                    // { binding: 'jpumcode', header: 'KCC품번', align: "center", width: 200 },
                    { binding: 'jpumname', header: 'GRADE', align: "center", width: 200 },
                    { binding: 'jdoor1', header: '제조사', align: "center", width: 100 },
                    { binding: 'jdoor2', header: '공급처', align: "center", width: 100 },
                    // { binding: 'j_sr', header: '스프루', align: "center", width: 100 },
                    // { binding: 'j_ct', header: 'C/T', align: "center", width: 100 },   
                    // { binding: 'j_cavity', header: 'CAVITY', align: "center", width: 100 },
                    // { binding: 'jbigo', header: '비고', align: "center", width: 100 },             
                    // { binding: 'jchgoga0', header: '단가', align: "right", width: 100 }, 
                    { binding: 'j_dae', header: '대분류', align: "center", width: 0 },               
                    // { binding: 'j_jung', header: '중분류', align: "right", width: 0 }, 
                    // { binding: 'j_misayong', header: '미사용', align: "right", width: 0 },  
                    // { binding: 'j_yangsan', header: '양산', align: "right", width: 0 },  
                    // { binding: 'j_sang', header: '구격중복사용', align: "right", width: 0 },                                  
                    
                ], 
                itemsSource: view_p01tab01page
            });        

            new FlexGridContextMenu(wtab01Grid); 
            // 헤더 열 전환
            setHeaderColumn(false);
            function setHeaderColumn(headerOn) {
                wtab01Grid.headersVisibility = headerOn
                ? wijmo.grid.HeadersVisibility.All
                : wijmo.grid.HeadersVisibility.Column; 
            } 
            wtab01Grid.showMarquee = true;
            wtab01Grid.focus();
            wijmo.toggleClass(wtab01Grid.hostElement, 'highlightActive', true);
            wtab01Grid.focus();

    
            // tab01검색 데이터 수집
            function getData_tab01(){        
                var wtab01Dto = [[${index03List}]];   
                var wactnm_data = [];       
                var cnt = 1;   
                var ls_w_b_gubn = "";
                var ls_w_b_gubnnm = "";
                for (var i = 0; i < wtab01Dto.length; i++) {

                    ls_w_b_gubn =  wtab01Dto[i]["w_b_gubn"] 
                    if (ls_w_b_gubn == 'J') {
                        ls_w_b_gubnnm = "제품"
                    }else if(ls_w_b_gubn == 'W'){
                        ls_w_b_gubnnm = "원자재"
                    }else if(ls_w_b_gubn == 'B'){
                        ls_w_b_gubnnm = "부자재"                        
                    }else if(ls_w_b_gubn == 'H'){
                        ls_w_b_gubnnm = "예비부품"                        
                    }else if(ls_w_b_gubn == 'G'){
                        ls_w_b_gubnnm = "기타"                        
                    } 
                    wactnm_data.push({
                        id: i, 
                        index: cnt,
                        jkey: wtab01Dto[i]["jkey"], 
                        j_dae: wtab01Dto[i]["j_dae"], 
                        j_jung: wtab01Dto[i]["j_jung"], 
                        jgugek: wtab01Dto[i]["jgugek"], 
                        jpum: wtab01Dto[i]["jpum"], 
                        jgugek2: wtab01Dto[i]["jgugek2"], 
                        jpumcode: wtab01Dto[i]["jpumcode"], 
                        jpumname: wtab01Dto[i]["jpumname"], 
                        jsayang: wtab01Dto[i]["jsayang"], 
                        j_net: wtab01Dto[i]["j_net"], 
                        jchajong: wtab01Dto[i]["jchajong"], 
                        j_sr: wtab01Dto[i]["j_sr"], 
                        j_ct: wtab01Dto[i]["j_ct"], 
                        j_cavity: wtab01Dto[i]["j_cavity"], 
                        jdanwy: wtab01Dto[i]["jdanwy"],
                        w_b_gubn: wtab01Dto[i]["w_b_gubn"],
                        w_b_gubnnm: ls_w_b_gubnnm,
                        jchgoga0: wtab01Dto[i]["jchgoga0"],
                        jbigo: wtab01Dto[i]["jbigo"],
                        j_misayong: wtab01Dto[i]["j_misayong"],
                        j_sang: wtab01Dto[i]["j_sang"] ,
                        jboxsu1: wtab01Dto[i]["jboxsu1"] ,   
                        cltcd: wtab01Dto[i]["cltcd"] , 
                        acorp: wtab01Dto[i]["acorp"] ,  
                        jgumtype: wtab01Dto[i]["jgumtype"] ,  
                        jgumtypenm: wtab01Dto[i]["jgumtypenm"] ,  
                        jdoor1: wtab01Dto[i]["jdoor1"] ,  
                        jdoor2: wtab01Dto[i]["jdoor2"] ,   
                        jthick: wtab01Dto[i]["jthick"] ,   
                        j_yangsan: wtab01Dto[i]["j_yangsan"] , 
                        
                        
                    });
                    cnt++;
                }      
                return wactnm_data;                                         
            }  

            // 품목현황 리스트     
            // // ################################################################

            view_p01tab02page = new wijmo.collections.CollectionView(getData_tab02(), {
                //sortDescriptions: [new wijmo.collections.SortDescription("jkey", false)],
                // pageSize: 18
            });
        // tab02 grid page
            // new wijmo.input.CollectionViewNavigator('#tab02Pager', {
            //     byPage: true,
            //     headerFormat: 'Page {currentPage:n0} of {pageCount:n0}',
            //     cv: view_p01tab02page
            // });      
            wtab02Grid = new wijmo.grid.FlexGrid('#wtab02Grid_div', {  
                autoGenerateColumns: false,
                showMarquee: true,
                isReadOnly: false,  
                frozenColumns: 2,
                // selectionMode: 'RowRange',
                allowSorting: 'MultiColumn',
                alternatingRowStep: 0,
                columns: [     
                {
                        binding: 'jkey',
                        width: 150,
                        header: '코드', 
                        align:"center",
                        cellTemplate: wijmo.grid.cellmaker.CellMaker.makeLink({ 
                            text: '<b>${item.jkey}</b>',
                            click: (e, ctx) => {                                
                                wjcodeChk_a("B", ctx.item.jkey, ctx.item.j_dae, ctx.item.j_jung, ctx.item.jgugek, ctx.item.jgugek2,ctx.item.jpum, ctx.item.jpumcode, ctx.item.jsayang, ctx.item.j_net, ctx.item.jchajong, ctx.item.j_sr,ctx.item.j_ct, ctx.item.j_cavity, ctx.item.jdanwy, ctx.item.jbigo, ctx.item.w_b_gubn , ctx.item.jpumname, ctx.item.j_misayong, ctx.item.j_sang, ctx.item.jboxsu1, ctx.item.cltcd, ctx.item.acorp, ctx.item.jgumtype, ctx.item.jdoor1, ctx.item.jdoor2, ctx.item.j_yangsan);
                            }
                        })
                    }, 
                    // { binding: 'jchajong', header: '차종', align: "center", width: 100 },
                    { binding: 'w_b_gubnnm', header: '품목분류', align: "center", width: 100 },  
                    { binding: 'jpum', header: '품명', align: "left", width: 250 }, 
                    // { binding: 'jgumtypenm', header: '금형코드', align: "center", width: 200 },   
                    { binding: 'jgugek', header: '규격', align: "center", width: 200 },   
                    { binding: 'jgugek2', header: '색상', align: "center", width: 100 }, 
                    { binding: 'jpumname', header: 'GRADE', align: "center", width: 200 },
                    { binding: 'jdoor1', header: '제조사', align: "center", width: 100 },
                    { binding: 'jdoor2', header: '공급처', align: "center", width: 100 },             
                    // { binding: 'jthick', header: '유리두께', align: "center", width: 100 }, 
                    // { binding: 'jdanwy', header: '단위', align: "center", width: 100 },  
                    // { binding: 'jpumcode', header: 'KCC품번', align: "center", width: 200 }, 
                    // { binding: 'jsayang', header: '사양구분', align: "center", width: 100 },
                    // { binding: 'j_net', header: '제품중량', align: "center", width: 100 },
                    // { binding: 'j_sr', header: '스프루', align: "center", width: 100 },
                    // { binding: 'j_ct', header: 'C/T', align: "center", width: 100 },   
                    // { binding: 'j_cavity', header: 'CAVITY', align: "center", width: 100 },
                    // { binding: 'jbigo', header: '비고', align: "center", width: 100 },             
                    // { binding: 'jchgoga0', header: '단가', align: "right", width: 100 }, 
                    { binding: 'j_dae', header: '대분류', align: "center", width: 0 },   
                    // { binding: 'j_misayong', header: '미사용', align: "center", width: 0 },
                    // { binding: 'j_yangsan', header: '양산', align: "center", width: 0 },  
                    // { binding: 'j_sang', header: '구격중복사용', align: "right", width: 0 },           
                    
                ], 
                itemsSource: view_p01tab02page
            });       
    

            new FlexGridContextMenu(wtab02Grid);
                // 그룹 패널 생성
                // var theGroupPanel = new wijmo.grid.grouppanel.GroupPanel('#theGroupPanel', {
                //     placeholder: '그룹을 만들려면 열을 여기로 끌어다 놓아주세요.  마우스 우 클릭하시면 엑셀로 받으실 수 있습니다.',
                //     grid: wtab02Grid
                // });  
                // 헤더 열 전환
                setHeaderColumn02(false);
                function setHeaderColumn02(headerOn) {
                    wtab02Grid.headersVisibility = headerOn
                    ? wijmo.grid.HeadersVisibility.All
                    : wijmo.grid.HeadersVisibility.Column; 
                } 
                wtab02Grid.showMarquee = true;
                wtab02Grid.focus();
                wijmo.toggleClass(wtab02Grid.hostElement, 'highlightActive', true);
                wtab02Grid.focus();

    
            // tab01검색 데이터 수집
            function getData_tab02(){         
                var wtab01Dto = [[${index03List}]];   
                var wactnm_data = [];         
                var cnt = 1;   
                var ls_w_b_gubn = "";
                var ls_w_b_gubnnm = "";
                for (var i = 0; i < wtab01Dto.length; i++) {
                    ls_w_b_gubn =  wtab01Dto[i]["w_b_gubn"] 
                    if (ls_w_b_gubn == 'J') {
                        ls_w_b_gubnnm = "제품"
                    }else if(ls_w_b_gubn == 'W'){
                        ls_w_b_gubnnm = "원자재"
                    }else if(ls_w_b_gubn == 'B'){
                        ls_w_b_gubnnm = "부자재"                        
                    }else if(ls_w_b_gubn == 'H'){
                        ls_w_b_gubnnm = "예비부품"                        
                    }else if(ls_w_b_gubn == 'G'){
                        ls_w_b_gubnnm = "기타"                        
                    }
                    wactnm_data.push({
                        id: i, 
                        index: cnt,
                        id: i, 
                        index: cnt, 
                        index: cnt, 
                        jkey: wtab01Dto[i]["jkey"], 
                        j_dae: wtab01Dto[i]["j_dae"], 
                        j_jung: wtab01Dto[i]["j_jung"], 
                        jgugek: wtab01Dto[i]["jgugek"], 
                        jpum: wtab01Dto[i]["jpum"], 
                        jgugek2: wtab01Dto[i]["jgugek2"], 
                        jpumcode: wtab01Dto[i]["jpumcode"], 
                        jpumname: wtab01Dto[i]["jpumname"], 
                        jsayang: wtab01Dto[i]["jsayang"], 
                        j_net: wtab01Dto[i]["j_net"], 
                        jchajong: wtab01Dto[i]["jchajong"], 
                        j_sr: wtab01Dto[i]["j_sr"], 
                        j_ct: wtab01Dto[i]["j_ct"], 
                        j_cavity: wtab01Dto[i]["j_cavity"], 
                        jdanwy: wtab01Dto[i]["jdanwy"],
                        jbigo: wtab01Dto[i]["jbigo"],
                        w_b_gubn: wtab01Dto[i]["w_b_gubn"],
                        w_b_gubnnm: ls_w_b_gubnnm,
                        jchgoga0: wtab01Dto[i]["jchgoga0"], 
                        j_misayong: wtab01Dto[i]["j_misayong"], 
                        j_sang: wtab01Dto[i]["j_sang"],    
                        jboxsu1: wtab01Dto[i]["jboxsu1"] ,    
                        cltcd: wtab01Dto[i]["cltcd"] ,    
                        acorp: wtab01Dto[i]["acorp"],  
                        jgumtype: wtab01Dto[i]["jgumtype"] ,  
                        jgumtypenm: wtab01Dto[i]["jgumtypenm"] ,  
                        jdoor1: wtab01Dto[i]["jdoor1"] ,  
                        jdoor2: wtab01Dto[i]["jdoor2"] ,   
                        jthick: wtab01Dto[i]["jthick"] ,  
                        j_yangsan: wtab01Dto[i]["j_yangsan"] , 
                        
                    });
                    cnt++;
                }      
                return wactnm_data;                                         
            } 
    
        



            // 거래처현황 리스트     
            // // ################################################################ 
            view_p01tab03page = new wijmo.collections.CollectionView(getData_wlist2(), {
                sortDescriptions: [new wijmo.collections.SortDescription("acode", false)],
                //pageSize: 21
            });      
            wtab03Grid = new wijmo.grid.FlexGrid('#wtab03Grid_div', {  
                autoGenerateColumns: false,
                isReadOnly: false, 
                allowSorting: 'MultiColumn',
                selectionMode: 'RowRange',
                alternatingRowStep: 0,
                columns: [     
                    { binding: 'acode', header: '코드', align: "center", width: 80 },
                    { binding: 'acorp', header: '거래처명', align: "center", width: 200 },
                ], 
                itemsSource: view_p01tab03page
            });  
            wtab03Grid.showMarquee = true; 
            wijmo.toggleClass(wtab03Grid.hostElement, 'highlightActive', true);
            wtab03Grid.focus();
            // 거래처 데이터 수집
            function getData_wlist2(){   
                var winname_data = []; 
                var cnt = 1;
                for (var i = 0; i < 12; i++) {
                    winname_data.push({
                        id: i, 
                        index: cnt,
                        acode:"",
                        acorp: "",                            
                    });
                    cnt++;
                }    
                return winname_data;                                      
            }  
            setHeaderColumn03(false);
            function setHeaderColumn03(headerOn) {
                wtab03Grid.headersVisibility = headerOn
                ? wijmo.grid.HeadersVisibility.All
                : wijmo.grid.HeadersVisibility.Column; 
            }  


            
            document.getElementById('j_dae').value =  "01"; 
            handleItemCategoryChange()


        } //window 호출 끝


        function handleItemCategoryChange(){ 
            const category = document.getElementById('j_dae').value; 
            
            const select_01 = document.createElement('select');  //jpum
            const input_01 = document.createElement('input');    //jpum
            const select_02 = document.createElement('select');  //jgugek2
            const input_02 = document.createElement('input');    //jgugek2
            const select_03 = document.createElement('select');  //door1
            const input_03 = document.createElement('input');    //door1
            const select_04 = document.createElement('select');  //door2
            const input_04 = document.createElement('input');    //door2
            const select_05 = document.createElement('select');  //form
            const input_05 = document.createElement('input');    //form
            const select_06 = document.createElement('select');  //form
            const input_06 = document.createElement('input');    //form

            const jpumWrap = document.getElementById('jpum_wrap');    
            const jgugek2Wrap = document.getElementById('jgugek2_wrap');
            const jpumnameWrap = document.getElementById('jpumname_wrap');
            const jdoor1Wrap = document.getElementById('jdoor1_wrap');
            const jdoor2Wrap = document.getElementById('jdoor2_wrap'); 
            // const jthick2Wrap = document.getElementById('jthick_wrap'); 
            const jpumcode = document.getElementById('jpumcode'); 
            // 완전히 제거
            while (jpumWrap.firstChild) {
                jpumWrap.removeChild(jpumWrap.firstChild);
            }
            while (jgugek2Wrap.firstChild) {
                jgugek2Wrap.removeChild(jgugek2Wrap.firstChild);
            }
            while (jpumnameWrap.firstChild) {
                jpumnameWrap.removeChild(jpumnameWrap.firstChild);
            }
            while (jdoor1Wrap.firstChild) {
                jdoor1Wrap.removeChild(jdoor1Wrap.firstChild);
            }
            while (jdoor2Wrap.firstChild) {
                jdoor2Wrap.removeChild(jdoor2Wrap.firstChild);
            }
            // while (jthick2Wrap.firstChild) {
            //     jthick2Wrap.removeChild(jthick2Wrap.firstChild);
            // }
            

            if (category === '02') { 
                // 02 = KCC      jpum 생성 --------------------------------------
                select_01.name = "jpum";
                select_01.id = "jpum";
                select_01.className = "form-select form-select-sm";
                select_01.style.width = "200px";
                const dOpt = document.createElement('option'); 
                dOpt.value = "";
                dOpt.text = "선택";
                select_01.appendChild(dOpt);
                if (Array.isArray(productList)) {
                    productList.forEach(item => {
                        const opt = document.createElement('option');
                        opt.value = item.pname;
                        opt.text = item.pname;  
                        select_01.appendChild(opt);
                    }); 
                }
                jpumWrap.appendChild(select_01);
                // color 생성 --------------------------------------
                select_02.name = "jgugek2";
                select_02.id = "jgugek2";
                select_02.className = "form-select form-select-sm";
                select_02.style.width = "200px"; 
                const dOpt02 = document.createElement('option'); 
                dOpt02.value = "";
                dOpt02.text = "선택";
                select_02.appendChild(dOpt02);

                colorList.forEach(item => {
                    const opt02 = document.createElement('option');
                    opt02.value = item.pname;
                    opt02.text = item.pname;  
                    select_02.appendChild(opt02);
                }); 
                jgugek2Wrap.appendChild(select_02);
                // door1 생성 --------------------------------------
                select_03.name = "jdoor1";
                select_03.id = "jdoor1";
                select_03.className = "form-select form-select-sm";
                select_03.style.width = "200px";

                const dOpt03 = document.createElement('option'); 
                dOpt03.value = "";
                dOpt03.text = "선택";
                select_03.appendChild(dOpt03);

                door1List.forEach(item => {
                    const opt03 = document.createElement('option');
                    opt03.value = item.pname;
                    opt03.text = item.pname;  
                    select_03.appendChild(opt03);
                }); 
                jdoor1Wrap.appendChild(select_03);
                // door2 생성 --------------------------------------
                select_04.name = "jdoor2";
                select_04.id = "jdoor2";
                select_04.className = "form-select form-select-sm";
                select_04.style.width = "200px";

                const dOpt04 = document.createElement('option'); 
                dOpt04.value = "";
                dOpt04.text = "선택";
                select_04.appendChild(dOpt04);

                door2List.forEach(item => {
                    const opt04 = document.createElement('option');
                    opt04.value = item.pname;
                    opt04.text = item.pname;  
                    select_04.appendChild(opt04);
                }); 
                jdoor2Wrap.appendChild(select_04);
                // jthick 생성 --------------------------------------
                select_06.name = "jthick";
                select_06.id = "jthick";
                select_06.className = "form-select form-select-sm";
                select_06.style.width = "200px";

                const dOpt06 = document.createElement('option'); 
                dOpt06.value = "";
                dOpt06.text = "선택";
                select_06.appendChild(dOpt06);

                jthickList.forEach(item => {
                    const opt06 = document.createElement('option');
                    opt06.value = item.pname;
                    opt06.text = item.pname;  
                    select_06.appendChild(opt06);
                }); 
                // jthick2Wrap.appendChild(select_06);
                // form 생성 --------------------------------------
                select_05.name = "jpumname";
                select_05.id = "jpumname";
                select_05.className = "form-select form-select-sm";
                select_05.style.width = "200px";

                const opt05 = document.createElement('option');
                opt05.value = "";
                opt05.text = "선택";
                select_05.appendChild(opt05);

                formList.forEach(item => {
                    const opt05 = document.createElement('option');
                    opt05.value = item.pname;
                    opt05.text = item.pname;  
                    select_05.appendChild(opt05);
                }); 
                jpumnameWrap.appendChild(select_05);  
                jpumcode.disabled = false; // KCC 품번
                
            } else {  
                // jpum 생성
                input_01.type = 'text';
                input_01.name = 'jpum';
                input_01.id = 'jpum';
                input_01.className = 'form-control form-control-sm';
                input_01.placeholder = '제품명을 직접 입력하세요';
                input_01.autocomplete = 'off';
                input_01.style.width = '200px';
                jpumWrap.appendChild(input_01);
                // color 생성
                input_02.type = 'text';
                input_02.name = 'jgugek2';
                input_02.id = 'jgugek2';
                input_02.className = 'form-control form-control-sm';
                input_02.placeholder = '색상을 직접 입력하세요';
                input_02.autocomplete = 'off';
                input_02.style.width = '200px';
                jgugek2Wrap.appendChild(input_02);
                // door1 생성
                input_03.type = 'text';
                input_03.name = 'jdoor1';
                input_03.id = 'jdoor1';
                input_03.className = 'form-control form-control-sm';
                input_03.placeholder = '제조사를 입력하세요';
                input_03.autocomplete = 'off';
                input_03.style.width = '200px';
                jdoor1Wrap.appendChild(input_03);
                // door2 생성
                input_04.type = 'text';
                input_04.name = 'jdoor2';
                input_04.id = 'jdoor2';
                input_04.className = 'form-control form-control-sm';
                input_04.placeholder = '공급처를 입력하세요';
                input_04.autocomplete = 'off';
                input_04.style.width = '200px';
                jdoor2Wrap.appendChild(input_04);
                // jthick 생성
                input_06.type = 'text';
                input_06.name = 'jthick';
                input_06.id = 'jthick';
                input_06.className = 'form-control form-control-sm';
                input_06.placeholder = 'jthick을 직접 입력하세요';
                input_06.autocomplete = 'off';
                input_06.style.width = '200px';
                // jthick2Wrap.appendChild(input_06);

                
                // form 생성
                input_05.type = 'text';
                input_05.name = 'jpumname';
                input_05.id = 'jpumname';
                input_05.className = 'form-control form-control-sm';
                input_05.placeholder = 'GRADE 입력하세요';
                input_05.autocomplete = 'off';
                input_05.style.width = '200px';
                jpumnameWrap.appendChild(input_05); 
                jpumcode.disabled = true; // KCC 품번
            } 

        }
    
        function delete_btn(){             
            if (!confirm("삭제하시겠습니까?")) {
                return ; 
            }               
            var ls_jkey = document.getElementById('jkey').value;                                        

            $.ajax({
                url: '/app01m/index03/del',   
                type:"POST", 
                data: {
                    "ascode" : ls_jkey 
                },
                async:false,
                success:function(data){ 
                    if(data == "success"){  
                        alert("삭제되었습니다.")
                        // console.log("delete", data);                     
                        $("#retrieveBtn").trigger("click"); 
                        // listUp();   
                    }else{
                        alert("삭제중 오류가 발생했습니다. 관리자에게 문의하세요.")                             
                    }   
                },error:function(e){
                    console.log('error',e);
                }
            }).done(function(fragment){           
            })
            clear_rtn();  
        }
        
        //초기화 function
        function clear_rtn(elem){
            document.getElementById('jkey').value =  ""; 
            document.getElementById('j_dae').value =  "01";   
            // document.getElementById('j_jung').value =  ""; 
            document.getElementById('jgugek').value =  "";
            document.getElementById('jpum').value =  "";  
            document.getElementById('jgugek2').value =  "";    
            document.getElementById('jpumcode').value =  "";    
            document.getElementById('jpumname').value =  ""; 
            document.getElementById('jsayang').value = ""; 
            document.getElementById('j_net').value =  ""; 
            document.getElementById('jchajong').value =  "";   
            document.getElementById('j_sr').value =  ""; 
            document.getElementById('j_ct').value =  ""; 
            document.getElementById('j_cavity').value =  ""; 
            document.getElementById('jdanwy').value = "";  
            document.getElementById('jbigo').value = "";   
            // document.querySelector('input[name="w_b_gubn"][value="J"]').checked = true; 
            document.getElementById("w_b_gubn").value = "W";
            document.getElementById('j_misayong').checked = false; 
            document.getElementById('j_yangsan').checked = false; 
            document.getElementById('acode').value = ""; 
            document.getElementById('acorp').innerHTML = "";  
            document.getElementById('acorp').value = "";  
            document.getElementById('jgumtype').value = ""; 
            document.getElementById('jsayang').value = ""; 
            document.getElementById('jdoor1').value = ""; 
            document.getElementById('jdoor2').value = "";
            document.getElementById('jthick').value = "";
             
            // document.getElementById('j_sang').value = ""; 
            document.getElementById('jboxsu1').value = 0; 
            document.getElementById('jpumcode').disabled = false; // KCC 품번
            handleItemCategoryChange()
        }
        // <!-- 저장 스크립트 시작 -->
        function save_btn(){   
            var jpum_sel = document.getElementById('jpum'); 
            var jgugek2_sel = document.getElementById('jgugek2'); 
            var jdoor1_sel = document.getElementById('jdoor1'); 
            var jdoor2_sel = document.getElementById('jdoor2'); 
            var jthick_sel = document.getElementById('jthick'); 
            
            var jpumname_sel = document.getElementById('jpumname');

            var ls_jkey     =  document.getElementById('jkey').value;  
            var ls_j_dae    =  document.getElementById('j_dae').value;  
            var ls_j_jung   =  "01"; //document.getElementById('j_jung').value;
            var ls_jgugek   =  document.getElementById('jgugek').value;  
            var ls_jpum     =  document.getElementById('jpum').value; 
            if (jpum_sel.tagName === 'SELECT'   && jpum_sel.selectedIndex >= 0) {
                var ls_jpum =  jpum_sel.options[jpum_sel.selectedIndex].text;
            }   
            var ls_jgugek2  =  document.getElementById('jgugek2').value; 
            if (jgugek2_sel.tagName === 'SELECT'  && jgugek2_sel.selectedIndex >= 0) { 
                var ls_jgugek2  =  jgugek2_sel.options[jgugek2_sel.selectedIndex].text;    
            } 
            var ls_jpumcode =  document.getElementById('jpumcode').value;  
            var ls_jsayang  =  document.getElementById('jsayang').value; 
            var ls_j_net    =  document.getElementById('j_net').value;  
            var ls_jchajong =  document.getElementById('jchajong').value;    
            var ls_j_sr     =  document.getElementById('j_sr').value;  
            var ls_j_ct     =  document.getElementById('j_ct').value;  
            var ls_j_cavity =  document.getElementById('j_cavity').value;  
            var ls_jdanwy   =  document.getElementById('jdanwy').value; 
            var ls_jbigo    =  document.getElementById('jbigo').value; 
            var ls_acode    =  document.getElementById('acode').value;  
            var ls_jgumtype     =  document.getElementById('jgumtype').value;
            var ls_door1    =  document.getElementById('jdoor1').value;
            if (jdoor1_sel.tagName === 'SELECT' && jdoor1_sel.selectedIndex >= 0) { 
                var ls_door1    =  jdoor1_sel.options[jdoor1_sel.selectedIndex].text;
            } 
            var ls_door2        =  document.getElementById('jdoor2').value; 
            
            if (jdoor2_sel.tagName === 'SELECT' && jdoor2_sel.selectedIndex >= 0 ) { 
                var ls_door2    =  jdoor2_sel.options[jdoor2_sel.selectedIndex].text; 
            }   
            var ls_jthick        =  document.getElementById('jthick').value; 
            if (jthick_sel.tagName === 'SELECT' && jthick_sel.selectedIndex >= 0) { 
                var ls_jthick    =  jthick_sel.options[jthick_sel.selectedIndex].text; 
            } 
            
            var ls_jpumname =  document.getElementById('jpumname').value; 
            if (jpumname_sel.tagName === 'SELECT') { 
                var ls_jpumname =  jpumname_sel.options[jpumname_sel.selectedIndex].text; 
            }                
            var ls_jchgoga0 =  0; 
            var ls_j_misayong =  document.getElementById('j_misayong').value;
            var ls_j_yangsan =  document.getElementById('j_yangsan').value;
            // var ls_j_sang =  document.getElementById('j_sang').value;
            var ls_jboxsu1 =  document.getElementById('jboxsu1').value;
                 
            if(ls_jboxsu1 == null || ls_jboxsu1.length == 0 || ls_jboxsu1 == ""){ 
                ls_jboxsu1 = 0;            
            }     
            if(ls_acode == null || ls_acode.length == 0 || ls_acode == ""){ 
                ls_acode = "";            
            }  
            const j_misayong = document.getElementById('j_misayong'); 
            const is_checked = j_misayong.checked;
             
            if (!is_checked){
                ls_j_misayong = "0"
            }else{
                ls_j_misayong = "1"
            }
            const j_yangsan = document.getElementById('j_yangsan'); 
            const is_checked02 = j_yangsan.checked;
             
            if (!is_checked02){
                ls_j_yangsan = "0"
            }else{
                ls_j_yangsan = "1"
            }
            var ls_j_sang = "0"
            // const j_sang = document.getElementById('j_sang'); 
            // const is_checked1 = j_sang.checked; 
            // if (is_checked1){
            //     ls_j_sang = "0"
            // }else{
            //     ls_j_sang = "1"
            // } 

            // var ls_w_b_gubn = ""
            // var x = document.getElementsByName('w_b_gubn'); 
            //     for(var i=0; i<3; i++) {
            //         if(x[i].checked){
            //             ls_w_b_gubn = x[i].value;
            //             //break;
            //         }
            //     }  
            var ls_w_b_gubn = document.getElementById("w_b_gubn").value;

                if (!confirm("저장하시겠습니까?")) {
                        return ; 
                    }   
                // if(!ls_jkey){
                //     alert("제품코드를 입력하세요")
                //         return ; 
                // } 
                if(!ls_jpum){
                    alert("제품명을 입력하세요") 
                        return ;                 
                }    
                if(!ls_j_dae){
                    alert("대분류를 선택하세요") 
                        return ;                 
                }  
                // if(!ls_j_jung){
                //     alert("중분류를 선택하세요") 
                //         return ;                 
                // }  
                // if(!ls_jchajong){
                //     alert("차종을 입력하세요") 
                //         return ;                 
                // }     
                // if(!ls_jgumtype){
                //     alert("금형을 입력하세요") 
                //         return ;                 
                // }             
                var inputdata = {  
                    "jkey"          : ls_jkey,
                    "j_dae"         : ls_j_dae , 
                    "j_jung"        : ls_j_jung, 
                    "jgugek"        : ls_jgugek , 
                    "jpum"          : ls_jpum, 
                    "jgugek2"       : ls_jgugek2,
                    "jpumcode"      : ls_jpumcode, 
                    "jpumname"      : ls_jpumname,
                    "jsayang"       : ls_jsayang , 
                    "j_net"         : ls_j_net,
                    "jchajong"      : ls_jchajong,
                    "j_sr"          : ls_j_sr,
                    "j_ct"          : ls_j_ct,
                    "j_cavity"      : ls_j_cavity, 
                    "jdanwy"        : ls_jdanwy,
                    "w_b_gubn"      : ls_w_b_gubn,
                    "jbigo"         : ls_jbigo,
                    "jchgoga0"      : ls_jchgoga0,
                    "j_misayong"    : ls_j_misayong,
                    "j_sang"        : ls_j_sang,     
                    "jboxsu1"       : ls_jboxsu1,     
                    "acode"         : ls_acode,     
                    "jgumtype"      : ls_jgumtype,     
                    "jdoor1"        : ls_door1,     
                    "jdoor2"        : ls_door2,
                    "jthick"        : ls_jthick,
                    "j_yangsan"    : ls_j_yangsan,
                } 
                //직전 데이타가 메모리에 남아 폼데이타 키를 삭제후 다시 데이타를 전송해야함. 
                formData.delete("key");   

            formData.append("key", new Blob([ JSON.stringify(inputdata) ], {type : "application/json"}));
            
                $.ajax({
                        url: '/app01m/index03/save',
                        type: "POST",   
                        processData : false,                //  processData : false로 선언 시 formData를 string으로 변환하지 않음
                        contentType : false,                // contentType : false 로 선언 시 content-type 헤더가 multipart/form-data로 전송되게     
                        data: formData,                   
                        async:false,
                    success:function(data){
                        if(data == "success"){
                            alert("저장되었습니다.")
                            // console.log(formData);
                            searchList_rtn("%");   
                            clear_rtn()           
                        }else{                       
                            alert("저장중 오류가 발생했습니다. 관리자에게 문의하세요.")
                            // listUp();
                            console.log(data);  
                        }
                    },error:function(e){
                        console.log('error',e);
                    }
                })            
                // return false;
        }
  

        function listUp(){
            window.location.href = '/app01/index03';
        }; 

        document.getElementById("wjpumlistBtn").addEventListener("click",function(){   
            searchListTot_rtn("M");  
        })
        document.getElementById("conjpum").addEventListener("keyup", (e)=>{ 
            if(e.keyCode === 13){  
                document.getElementById("wjpumlistBtn").click(); 
                searchListTot_rtn("M");
            }      
        })  
        //popup 품목현황 검색  
        document.getElementById("conjpum").addEventListener("keyup", (e)=>{ 
            if(e.keyCode === 13){ 
                searchListTot_rtn(); 
            }
        }); 
        
        document.getElementById("wciflistBtn").addEventListener("click",function(){   
            searchListcif_rtn("M");  
        })  
        //popup 거래처현황 검색  
        document.getElementById("conacorp").addEventListener("keyup", (e)=>{ 
            if(e.keyCode === 13){   
                searchListcif_rtn("M"); 
            }
        });    
        //거래처 조회 
        document.getElementById("acode").addEventListener("click",function(){  
            document.getElementById("incifbtn").click(); 
            searchListcif_rtn("A"); 

        })  
        document.getElementById("acode").addEventListener("keyup", (e)=>{ 
            if(e.keyCode === 13){  
                document.getElementById("incifbtn").click(); 
                //searchListcif_rtn("A"); 
            }
        });    

        //품목현황 조회 
        document.getElementById("retrieveBtn").addEventListener("click",function(){  
            let ls_searchtxt = document.getElementById('searchtxt').value;  
            searchList_rtn(ls_searchtxt); 

        })   
        //품명검색  
        document.getElementById("searchtxt").addEventListener("keyup", (e)=>{ 
            if(e.keyCode === 13){ 
                var searchText = document.getElementById('searchtxt').value; 
                searchList_rtn(searchText); 
            }
        });         
        function searchList_rtn(arg1){  
            ls_congubn = document.getElementById("con_gubn").value ;    
            if(ls_congubn == null || ls_congubn.length == 0 || ls_congubn == ""){ 
                ls_congubn = "%";            
            }   
            $.ajax({
                        url: '/app01m/index03/listmain',  
                        type:"POST",
                        data: { 
                            "searchtxt" :arg1, 
                            "congubn" :ls_congubn, 
                        }, 
                        async:false,
                        success:function(data){  
                            tabA_grid(data);
                        },error:function(e){
                            console.log("error");                            
                        }
                    }).done(function(fragment){           

                    })        

        }    

        //  tab01 grid data 수집
        function tabA_grid(data){
            var wtab01Dto  = data;   
            var wtab01_data = [];
            var cnt = 1;
            for (var i = 0; i < wtab01Dto.length; i++) {
                wtab01_data.push({
                    id: i, 
                    index: cnt, 
                    jkey: wtab01Dto[i]["jkey"], 
                    j_dae: wtab01Dto[i]["j_dae"], 
                    j_jung: wtab01Dto[i]["j_jung"], 
                    jgugek: wtab01Dto[i]["jgugek"], 
                    jpum: wtab01Dto[i]["jpum"], 
                    jgugek2: wtab01Dto[i]["jgugek2"], 
                    jpumcode: wtab01Dto[i]["jpumcode"], 
                    jpumname: wtab01Dto[i]["jpumname"], 
                    jsayang: wtab01Dto[i]["jsayang"], 
                    j_net: wtab01Dto[i]["j_net"], 
                    jchajong: wtab01Dto[i]["jchajong"], 
                    j_sr: wtab01Dto[i]["j_sr"], 
                    j_ct: wtab01Dto[i]["j_ct"], 
                    j_cavity: wtab01Dto[i]["j_cavity"], 
                    jdanwy: wtab01Dto[i]["jdanwy"],
                    jbigo: wtab01Dto[i]["jbigo"],
                    w_b_gubn: wtab01Dto[i]["w_b_gubn"],
                    jchgoga0: wtab01Dto[i]["jchgoga0"], 
                    j_misayong: wtab01Dto[i]["j_misayong"], 
                    j_sang: wtab01Dto[i]["j_sang"],    
                    jboxsu1: wtab01Dto[i]["jboxsu1"],       
                    acorp: wtab01Dto[i]["acorp"],       
                    cltcd: wtab01Dto[i]["cltcd"],        
                    jgumtype: wtab01Dto[i]["jgumtype"],   
                    jgumtypenm: wtab01Dto[i]["jgumtypenm"],       
                    jdoor1: wtab01Dto[i]["jdoor1"],     
                    jdoor2: wtab01Dto[i]["jdoor2"], 
                    jthick: wtab01Dto[i]["jthick"], 
                    j_yangsan: wtab01Dto[i]["j_yangsan"], 
                    
                });
                cnt++;
            }    
            wtab01Grid.columns.clear();  
            wtab01Grid.autoGenerateColumns = false; 
            view_p01tab01page.sourceCollection  = wtab01_data;

            var cols = new wijmo.grid.Column(); 
            cols.binding = 'jkey';
            cols.header = '코드';
            cols.align = "center";
            cols.width = 180;
            cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
                text: '<b>${item.jkey}</b>',
                click: (e, ctx) => {
                    wjcodeChk_a("A",ctx.item.jkey, ctx.item.j_dae, ctx.item.jthick, ctx.item.jgugek, ctx.item.jgugek2,ctx.item.jpum, ctx.item.jpumcode, ctx.item.jsayang, ctx.item.j_net, ctx.item.jchajong, ctx.item.j_sr,ctx.item.j_ct, ctx.item.j_cavity, ctx.item.jdanwy, ctx.item.jbigo, ctx.item.w_b_gubn , ctx.item.jpumname , ctx.item.j_misayong , ctx.item.j_sang, ctx.item.jboxsu1, ctx.item.cltcd, ctx.item.acorp, ctx.item.jgumtype, ctx.item.jdoor1, ctx.item.jdoor2, ctx.item.j_yangsan);                 
                    
                }
            });
            wtab01Grid.columns.push(cols);  

            // cols = new wijmo.grid.Column(); 
            // cols.binding = 'jchajong';
            // cols.header = '차종'; 
            // cols.align = "center"; 
            // cols.width = 100;
            // wtab01Grid.columns.push(cols);  

            cols = new wijmo.grid.Column(); 
            cols.binding = 'jpum';
            cols.header = '제품명';
            cols.align = "left";
            cols.width = 250;    
            cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
                text: '<b>${item.jpum}</b>',
                click: (e, ctx) => {
                    wjcodeChk_a("A",ctx.item.jkey, ctx.item.j_dae, ctx.item.j_jung, ctx.item.jgugek, ctx.item.jgugek2,ctx.item.jpum, ctx.item.jpumcode, ctx.item.jsayang, ctx.item.j_net, ctx.item.jchajong, ctx.item.j_sr,ctx.item.j_ct, ctx.item.j_cavity, ctx.item.jdanwy, ctx.item.jbigo, ctx.item.w_b_gubn , ctx.item.jpumname , ctx.item.j_misayong , ctx.item.j_sang, ctx.item.jboxsu1, ctx.item.cltcd, ctx.item.acorp, ctx.item.jgumtype, ctx.item.jdoor1, ctx.item.jdoor2, ctx.item.j_yangsan);                 
                    
                }
            });       
            wtab01Grid.columns.push(cols);  
            
            // cols = new wijmo.grid.Column(); 
            // cols.binding = 'jgumtypenm';
            // cols.header = '금형코드'; 
            // cols.align = "center"; 
            // cols.width = 130;
            // wtab01Grid.columns.push(cols);  

            cols = new wijmo.grid.Column(); 
            cols.binding = 'jgugek';
            cols.header = '규격';
            cols.align = "center";
            cols.width = 200;                  
            wtab01Grid.columns.push(cols);  

            cols = new wijmo.grid.Column(); 
            cols.binding = 'jgugek2';
            cols.header = '색상';
            cols.align = "center";
            cols.width = 100;           
            wtab01Grid.columns.push(cols);

            
            cols = new wijmo.grid.Column(); 
            cols.binding = 'jdanwy';
            cols.header = '단위'; 
            cols.align = "center"; 
            cols.width = 100;
            wtab01Grid.columns.push(cols);  
            
            // cols = new wijmo.grid.Column(); 
            // cols.binding = 'jpumcode';
            // cols.header = 'KCC품번'; 
            // cols.align = "center"; 
            // cols.width = 200;
            // wtab01Grid.columns.push(cols); 
            
            cols = new wijmo.grid.Column(); 
            cols.binding = 'jpumname';
            cols.header = 'GRADE'; 
            cols.align = "center"; 
            cols.width = 200;
            wtab01Grid.columns.push(cols); 
            
            cols = new wijmo.grid.Column(); 
            cols.binding = 'jdoor1';
            cols.header = '제조사'; 
            cols.align = "center"; 
            cols.width = 100;
            wtab01Grid.columns.push(cols);  

            cols = new wijmo.grid.Column(); 
            cols.binding = 'jdoor2';
            cols.header = '공급처'; 
            cols.align = "center"; 
            cols.width = 100;
            wtab01Grid.columns.push(cols);  

            // cols = new wijmo.grid.Column(); 
            // cols.binding = 'j_sr';
            // cols.header = '스프루'; 
            // cols.align = "center"; 
            // cols.width = 100;
            // wtab01Grid.columns.push(cols);  

            // cols = new wijmo.grid.Column(); 
            // cols.binding = 'j_ct';
            // cols.header = 'C/T'; 
            // cols.align = "center"; 
            // cols.width = 100;
            // wtab01Grid.columns.push(cols);  

            // cols = new wijmo.grid.Column(); 
            // cols.binding = 'j_cavity';
            // cols.header = 'CAVITY'; 
            // cols.align = "center"; 
            // cols.width = 100;
            // wtab01Grid.columns.push(cols);  

            // cols = new wijmo.grid.Column(); 
            // cols.binding = 'jbigo';
            // cols.header = '비고'; 
            // cols.align = "center"; 
            // cols.width = 100;
            // wtab01Grid.columns.push(cols);  

            cols = new wijmo.grid.Column(); 
            cols.binding = 'w_b_gubn';
            cols.header = '품목분류'; 
            cols.align = "center"; 
            cols.width = 100;
            wtab01Grid.columns.push(cols);  


            // cols = new wijmo.grid.Column(); 
            // cols.binding = 'jchgoga0';
            // cols.header = '단가'; 
            // cols.align = "right"; 
            // cols.width = 100;
            // wtab01Grid.columns.push(cols); 

            cols = new wijmo.grid.Column(); 
            cols.binding = 'j_dae';
            cols.header = '대분류'; 
            cols.align = "center"; 
            cols.width = 0;
            wtab01Grid.columns.push(cols); 

            // cols = new wijmo.grid.Column(); 
            // cols.binding = 'j_jung';
            // cols.header = '중분류'; 
            // cols.align = "center"; 
            // cols.width = 0;
            // wtab01Grid.columns.push(cols); 

            // cols = new wijmo.grid.Column(); 
            // cols.binding = 'j_misayong';
            // cols.header = '미사용여부'; 
            // cols.align = "center"; 
            // cols.width = 0;
            // wtab01Grid.columns.push(cols);  

            // cols = new wijmo.grid.Column(); 
            // cols.binding = 'j_yangsan';
            // cols.header = '양산'; 
            // cols.align = "center"; 
            // cols.width = 0;
            // wtab01Grid.columns.push(cols);  
        }        
 
            //   "A", jkey, j_dae, jthick, jgugek, jgugek2,jpum, jpumcode, jsayang, j_net, jchajong, 
            //   j_sr,j_ct, j_cavity, jdanwy, jbigo, w_b_gubn , jpumname, j_misayong, j_sang, jboxsu1, 
            //   cltcd, acorp, jgumtype, jdoor1, jdoor2, j_yangsan
        function wjcodeChk_a(arg0, arg1, arg2, arg3, arg4, arg5, arg6, arg7, arg8, arg9, arg10, arg11, arg12, arg13, arg14, arg15, arg16, arg17, arg18, arg19, arg20, arg21, arg22, arg23, arg24, arg25, arg26){            


            const jpumWrap = document.getElementById('jpum_wrap');    
            const jgugek2Wrap = document.getElementById('jgugek2_wrap');
            const jpumnameWrap = document.getElementById('jpumname_wrap');
            const jdoor1Wrap = document.getElementById('jdoor1_wrap');
            const jdoor2Wrap = document.getElementById('jdoor2_wrap');
            // const jthickWrap = document.getElementById('jthick_wrap');
            
            const select_01 = document.createElement('select');  //jpum
            const input_01 = document.createElement('input');    //jpum
            const select_02 = document.createElement('select');  //jgugek2
            const input_02 = document.createElement('input');    //jgugek2
            const select_03 = document.createElement('select');  //door1
            const input_03 = document.createElement('input');    //door1
            const select_04 = document.createElement('select');  //door2
            const input_04 = document.createElement('input');    //door2
            const select_05 = document.createElement('select');  //form
            const input_05 = document.createElement('input');    //form
            const select_06 = document.createElement('select');  //jthick
            const input_06 = document.createElement('input');    //jthick
            
            // ✅ 기존 하위 요소 제거
            jpumWrap.innerHTML = '';
            jgugek2Wrap.innerHTML = '';
            jpumnameWrap.innerHTML = '';
            jdoor1Wrap.innerHTML = '';
            jdoor2Wrap.innerHTML = '';
            // jthickWrap.innerHTML = '';
            
            // 완전히 제거
            while (jpumWrap.firstChild) {
                jpumWrap.removeChild(jpumWrap.firstChild);
            }
            while (jgugek2Wrap.firstChild) {
                jgugek2Wrap.removeChild(jgugek2Wrap.firstChild);
            }
            while (jpumnameWrap.firstChild) {
                jpumnameWrap.removeChild(jpumnameWrap.firstChild);
            }
            while (jdoor1Wrap.firstChild) {
                jdoor1Wrap.removeChild(jdoor1Wrap.firstChild);
            }
            while (jdoor2Wrap.firstChild) {
                jdoor2Wrap.removeChild(jdoor2Wrap.firstChild);
            }
            // while (jthickWrap.firstChild) {
            //     jthickWrap.removeChild(jthickWrap.firstChild);
            // }
            

            if (arg2 === '02') { 
                // jpum 생성 --------------------------------------
                select_01.name = "jpum";
                select_01.id = "jpum";
                select_01.className = "form-select form-select-sm";
                select_01.style.width = "200px";
                const dOpt = document.createElement('option'); 
                dOpt.value = "";
                dOpt.text = "선택";
                select_01.appendChild(dOpt);

                productList.forEach(item => {
                    const opt = document.createElement('option');
                    opt.value = item.pname;
                    opt.text = item.pname;  
                    select_01.appendChild(opt);
                }); 
                jpumWrap.appendChild(select_01);
                // color 생성 --------------------------------------
                select_02.name = "jgugek2";
                select_02.id = "jgugek2";
                select_02.className = "form-select form-select-sm";
                select_02.style.width = "200px"; 
                const dOpt02 = document.createElement('option'); 
                dOpt02.value = "";
                dOpt02.text = "선택";
                select_02.appendChild(dOpt02);

                colorList.forEach(item => {
                    const opt02 = document.createElement('option');
                    opt02.value = item.pname;
                    opt02.text = item.pname;  
                    select_02.appendChild(opt02);
                }); 
                jgugek2Wrap.appendChild(select_02);
                // door1 생성 --------------------------------------
                select_03.name = "jdoor1";
                select_03.id = "jdoor1";
                select_03.className = "form-select form-select-sm";
                select_03.style.width = "200px";

                const dOpt03 = document.createElement('option'); 
                dOpt03.value = "";
                dOpt03.text = "선택";
                select_03.appendChild(dOpt03);

                door1List.forEach(item => {
                    const opt03 = document.createElement('option');
                    opt03.value = item.pname;
                    opt03.text = item.pname;  
                    select_03.appendChild(opt03);
                }); 
                jdoor1Wrap.appendChild(select_03);
                // door2 생성 --------------------------------------
                select_04.name = "jdoor2";
                select_04.id = "jdoor2";
                select_04.className = "form-select form-select-sm";
                select_04.style.width = "200px";

                const dOpt04 = document.createElement('option'); 
                dOpt04.value = "";
                dOpt04.text = "선택";
                select_04.appendChild(dOpt04);

                door2List.forEach(item => {
                    const opt04 = document.createElement('option');
                    opt04.value = item.pname;
                    opt04.text = item.pname;  
                    select_04.appendChild(opt04);
                }); 
                jdoor2Wrap.appendChild(select_04);
                // jthick 생성 --------------------------------------
                select_06.name = "jthick";
                select_06.id = "jthick";
                select_06.className = "form-select form-select-sm";
                select_06.style.width = "200px";

                const dOpt06 = document.createElement('option'); 
                dOpt06.value = "";
                dOpt06.text = "선택";
                select_06.appendChild(dOpt06);

                jthickList.forEach(item => {
                    const opt06 = document.createElement('option');
                    opt06.value = item.pname;
                    opt06.text = item.pname;  
                    select_06.appendChild(opt06);
                }); 
                // jthickWrap.appendChild(select_06);
                // form 생성 --------------------------------------
                select_05.name = "jpumname";
                select_05.id = "jpumname";
                select_05.className = "form-select form-select-sm";
                select_05.style.width = "200px";

                const opt05 = document.createElement('option');
                opt05.value = "";
                opt05.text = "선택";
                select_05.appendChild(opt05);

                formList.forEach(item => {
                    const opt05 = document.createElement('option');
                    opt05.value = item.pname;
                    opt05.text = item.pname;  
                    select_05.appendChild(opt05);
                }); 
                jpumnameWrap.appendChild(select_05); 
            } else {  
                // jpum 생성
                input_01.type = 'text';
                input_01.name = 'jpum';
                input_01.id = 'jpum';
                input_01.className = 'form-control form-control-sm';
                input_01.placeholder = '제품명을 직접 입력하세요';
                input_01.autocomplete = 'off';
                input_01.style.width = '200px';
                jpumWrap.appendChild(input_01);
                // color 생성
                input_02.type = 'text';
                input_02.name = 'jgugek2';
                input_02.id = 'jgugek2';
                input_02.className = 'form-control form-control-sm';
                input_02.placeholder = '색상을 직접 입력하세요';
                input_02.autocomplete = 'off';
                input_02.style.width = '200px';
                jgugek2Wrap.appendChild(input_02);
                // door1 생성
                input_03.type = 'text';
                input_03.name = 'jdoor1';
                input_03.id = 'jdoor1';
                input_03.className = 'form-control form-control-sm';
                input_03.placeholder = '제조사를 입력하세요';
                input_03.autocomplete = 'off';
                input_03.style.width = '200px';
                jdoor1Wrap.appendChild(input_03);
                // door2 생성
                input_04.type = 'text';
                input_04.name = 'jdoor2';
                input_04.id = 'jdoor2';
                input_04.className = 'form-control form-control-sm';
                input_04.placeholder = '공급처를 입력하세요';
                input_04.autocomplete = 'off';
                input_04.style.width = '200px';
                jdoor2Wrap.appendChild(input_04);
                // jthick 생성
                input_06.type = 'text';
                input_06.name = 'jthick';
                input_06.id = 'jthick';
                input_06.className = 'form-control form-control-sm';
                input_06.placeholder = '유리두께를 직접 입력하세요';
                input_06.autocomplete = 'off';
                input_06.style.width = '200px';
                // jthickWrap.appendChild(input_06);
                // form 생성
                input_05.type = 'text';
                input_05.name = 'jpumname';
                input_05.id = 'jpumname';
                input_05.className = 'form-control form-control-sm';
                input_05.placeholder = 'GRADE를 입력하세요';
                input_05.autocomplete = 'off';
                input_05.style.width = '200px';
                jpumnameWrap.appendChild(input_05);
            } 
  

            document.getElementById('jkey').value = arg1;  
            document.getElementById('j_dae').value = arg2;   
            document.getElementById('jthick').value = arg3;
            document.getElementById('jgugek').value = arg4; 
            document.getElementById('jgugek2').value = arg5; 
            document.getElementById('jpum').value = arg6;   
            document.getElementById('jpumcode').value = arg7;
            document.getElementById('jsayang').value = arg8; 
            document.getElementById('j_net').value = arg9; 
            document.getElementById('jchajong').value = arg10;   
            document.getElementById('j_sr').value = arg11; 
            document.getElementById('j_ct').value = arg12; 
            document.getElementById('j_cavity').value = arg13; 
            document.getElementById('jdanwy').value = arg14;  
            document.getElementById('jbigo').value = arg15;
            //document.getElementById('w_b_gubn').value = arg16; 
            document.getElementById('jpumname').value = arg17;
            // document.getElementById('j_sang').value = arg19;   //규격중복체크
            document.getElementById('jboxsu1').value = arg20;  
            document.getElementById('acode').value = arg21;  
            document.getElementById('acorp').value = arg22;  //.innerText = arg22;  
            document.getElementById('jgumtype').value = arg23;   
            document.getElementById('jdoor1').value = arg24;   
            document.getElementById('jdoor2').value = arg25;  
            const j_misayong = document.getElementById('j_misayong'); 
            if(arg18 == "1"){
                j_misayong.checked = true; 
            }else{
                j_misayong.checked = false; 
            }   
            const j_yangsan = document.getElementById('j_yangsan'); 
            if(arg26 == "1"){
                j_yangsan.checked = true; 
            }else{
                j_yangsan.checked = false; 
            }   

            // var x = document.getElementsByName('w_b_gubn'); 
            // for(var i=0; i<3; i++) {
            //     if(x[i].value == arg16){
            //         x[i].checked = true;
            //     }else{
            //         x[i].checked = false;
            //     }
            // }
            document.getElementById("w_b_gubn").value = arg16; 
            if(arg0 == "B"){
                $("#wjcodelist_rtn").trigger("click");
            }
        }        

        function searchListTot_rtn(arg){ 
            
            if(arg == "M"){
                searchCode = document.getElementById('conjpum').value; 
            }
            if(arg == "A"){
                searchCode = document.getElementById('pcode').value; 
            }    
            $.ajax({
                        url: '/app01m/index03/listmain',  
                        type:"POST",
                        data: { 
                            "searchtxt" :searchCode,
                        }, 
                        async:false,
                        success:function(data){  
                            tabC_grid(data);
                        },error:function(e){
                            console.log("error");                            
                        }
                    }).done(function(fragment){           

                    })        

        }  

        // 팝업 품명현황 수집
        function tabC_grid(data){
                var wtab02Dto  = data;    
                var wtab02_data = [];
                var cnt = 1;
                for (var i = 0; i < wtab02Dto.length; i++) {
                    wtab02_data.push({
                        id: i, 
                        index: cnt, 
                        index: cnt, 
                        jkey: wtab02Dto[i]["jkey"], 
                        j_dae: wtab02Dto[i]["j_dae"], 
                        j_jung: wtab02Dto[i]["j_jung"], 
                        jgugek: wtab02Dto[i]["jgugek"], 
                        jpum: wtab02Dto[i]["jpum"], 
                        jgugek2: wtab02Dto[i]["jgugek2"], 
                        jpumcode: wtab02Dto[i]["jpumcode"], 
                        jpumname: wtab02Dto[i]["jpumname"], 
                        jsayang: wtab02Dto[i]["jsayang"], 
                        j_net: wtab02Dto[i]["j_net"], 
                        jchajong: wtab02Dto[i]["jchajong"], 
                        j_sr: wtab02Dto[i]["j_sr"], 
                        j_ct: wtab02Dto[i]["j_ct"], 
                        j_cavity: wtab02Dto[i]["j_cavity"], 
                        jdanwy: wtab02Dto[i]["jdanwy"],
                        jbigo: wtab02Dto[i]["jbigo"],
                        w_b_gubn: wtab02Dto[i]["w_b_gubn"],
                        jchgoga0: wtab02Dto[i]["jchgoga0"], 
                        j_misayong: wtab02Dto[i]["j_misayong"], 
                        j_sang: wtab02Dto[i]["j_sang"],    
                        jboxsu1: wtab02Dto[i]["jboxsu1"],      
                        acorp: wtab02Dto[i]["acorp"],  
                        cltcd: wtab02Dto[i]["cltcd"],    
                        jgumtype: wtab02Dto[i]["jgumtype"],  
                        jgumtypenm: wtab02Dto[i]["jgumtypenm"],    
                        jdoor1: wtab01Dto[i]["jdoor1"],     
                        jdoor2: wtab01Dto[i]["jdoor2"],     
                        jthick: wtab01Dto[i]["jthick"],       
                        j_yangsan: wtab01Dto[i]["j_yangsan"],   
                        
                    });
                    cnt++;
                }   

                // console.log(wtab02_data); 
    
                wtab02Grid.columns.clear();  
                wtab02Grid.autoGenerateColumns = false; 
                view_p01tab02page.sourceCollection  = wtab02_data;

                var cols = new wijmo.grid.Column(); 
                cols.binding = 'jkey';
                cols.header = '코드';
                cols.align = "center";
                cols.width = 150;   
                cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
                    text: '<b>${item.jkey}</b>',
                    click: (e, ctx) => {                        
                        wjcodeChk_a("B", ctx.item.jkey, ctx.item.j_dae, ctx.item.j_jung, ctx.item.jgugek, ctx.item.jgugek2,ctx.item.jpum, ctx.item.jpumcode, ctx.item.jsayang, ctx.item.j_net, ctx.item.jchajong, ctx.item.j_sr,ctx.item.j_ct, ctx.item.j_cavity, ctx.item.jdanwy, ctx.item.jbigo, ctx.item.w_b_gubn , ctx.item.jpumname, ctx.item.j_misayong, ctx.item.j_sang, ctx.item.jboxsu1, ctx.item.cltcd, ctx.item.acorp, ctx.item.jgumtype, ctx.item.jdoor1, ctx.item.jdoor2, ctx.item.j_yangsan);
                    }
                });       
                wtab02Grid.columns.push(cols); 

                // cols = new wijmo.grid.Column(); 
                // cols.binding = 'jchajong';
                // cols.header = '차종';
                // cols.align = "center";
                // cols.width = 100;    
                // wtab02Grid.columns.push(cols);   

                cols = new wijmo.grid.Column(); 
                cols.binding = 'jpum';
                cols.header = '제품명';
                cols.align = "left";
                cols.width = 250;    
                wtab02Grid.columns.push(cols);   

                // cols = new wijmo.grid.Column(); 
                // cols.binding = 'jgumtypenm';
                // cols.header = '금형코드';
                // cols.align = "center";
                // cols.width = 200;                  
                // wtab02Grid.columns.push(cols);  

                cols = new wijmo.grid.Column(); 
                cols.binding = 'jgugek';
                cols.header = '규격';
                cols.align = "center";
                cols.width = 200;                  
                wtab02Grid.columns.push(cols);  

                cols = new wijmo.grid.Column(); 
                cols.binding = 'jgugek2';
                cols.header = '색상';
                cols.align = "center";
                cols.width = 100;           
                wtab02Grid.columns.push(cols);

                
                cols = new wijmo.grid.Column(); 
                cols.binding = 'jpumname';
                cols.header = 'GRADE'; 
                cols.align = "center"; 
                cols.width = 100;
                wtab02Grid.columns.push(cols);  

                
                cols = new wijmo.grid.Column(); 
                cols.binding = 'jdoor1';
                cols.header = '제조사'; 
                cols.align = "center"; 
                cols.width = 100;
                wtab02Grid.columns.push(cols);  

                                
                cols = new wijmo.grid.Column(); 
                cols.binding = 'jdoor2';
                cols.header = '공급처'; 
                cols.align = "center"; 
                cols.width = 100;
                wtab02Grid.columns.push(cols);  

                                
                // cols = new wijmo.grid.Column(); 
                // cols.binding = 'jthick';
                // cols.header = '유리두께'; 
                // cols.align = "center"; 
                // cols.width = 100;
                // wtab02Grid.columns.push(cols);  

                
                // cols = new wijmo.grid.Column(); 
                // cols.binding = 'jdanwy';
                // cols.header = '단위'; 
                // cols.align = "center"; 
                // cols.width = 100;
                // wtab02Grid.columns.push(cols);  
                
                // cols = new wijmo.grid.Column(); 
                // cols.binding = 'jpumcode';
                // cols.header = 'KCC품번'; 
                // cols.align = "center"; 
                // cols.width = 200;
                // wtab02Grid.columns.push(cols);  

                // cols = new wijmo.grid.Column(); 
                // cols.binding = 'jsayang';
                // cols.header = '사양구분'; 
                // cols.align = "center"; 
                // cols.width = 100;
                // wtab02Grid.columns.push(cols);  

                // cols = new wijmo.grid.Column(); 
                // cols.binding = 'j_net';
                // cols.header = '제품중량'; 
                // cols.align = "center"; 
                // cols.width = 100;
                // wtab02Grid.columns.push(cols);  

                // cols = new wijmo.grid.Column(); 
                // cols.binding = 'jchajong';
                // cols.header = '차종'; 
                // cols.align = "center"; 
                // cols.width = 100;
                // wtab02Grid.columns.push(cols);  

                // cols = new wijmo.grid.Column(); 
                // cols.binding = 'j_sr';
                // cols.header = '스프루'; 
                // cols.align = "center"; 
                // cols.width = 100;
                // wtab02Grid.columns.push(cols);  

                // cols = new wijmo.grid.Column(); 
                // cols.binding = 'j_ct';
                // cols.header = 'C/T'; 
                // cols.align = "center"; 
                // cols.width = 100;
                // wtab02Grid.columns.push(cols);  

                // cols = new wijmo.grid.Column(); 
                // cols.binding = 'j_cavity';
                // cols.header = 'CAVITY'; 
                // cols.align = "center"; 
                // cols.width = 100;
                // wtab02Grid.columns.push(cols);  

                // cols = new wijmo.grid.Column(); 
                // cols.binding = 'jbigo';
                // cols.header = '비고'; 
                // cols.align = "center"; 
                // cols.width = 100;
                // wtab02Grid.columns.push(cols);  

                cols = new wijmo.grid.Column(); 
                cols.binding = 'w_b_gubn';
                cols.header = '품목분류'; 
                cols.align = "center"; 
                cols.width = 100;
                wtab02Grid.columns.push(cols);   

                cols = new wijmo.grid.Column(); 
                cols.binding = 'j_dae';
                cols.header = '대분류'; 
                cols.align = "center"; 
                cols.width = 0;
                wtab02Grid.columns.push(cols); 

                // cols = new wijmo.grid.Column(); 
                // cols.binding = 'j_jung';
                // cols.header = '중분류'; 
                // cols.align = "center"; 
                // cols.width = 0;
                // wtab02Grid.columns.push(cols); 

                // cols = new wijmo.grid.Column(); 
                // cols.binding = 'j_misayong';
                // cols.header = '미사용여부'; 
                // cols.align = "center"; 
                // cols.width = 0;
                // wtab02Grid.columns.push(cols);  

                // cols = new wijmo.grid.Column(); 
                // cols.binding = 'j_yangsan';
                // cols.header = '양산'; 
                // cols.align = "center"; 
                // cols.width = 0;
                // wtab02Grid.columns.push(cols); 

                // cols = new wijmo.grid.Column(); 
                // cols.binding = 'j_sang';
                // cols.header = '규격중복체크'; 
                // cols.align = "right"; 
                // cols.width = 0;
                // wtab02Grid.columns.push(cols); 
        
            }   


        
        function searchListcif_rtn(arg){  
            var searchCode = "";   
            if(arg == "M"){
                searchCode = document.getElementById('conacorp').value;   
            }
            if(arg == "A"){
                searchCode = document.getElementById('acode').value;   
            } 
            if(searchCode == null || searchCode.length == 0 || searchCode == ""){ 
                searchCode = "%"         ;
            }    
            $.ajax({
                    url: '/app02m/index10/listot',  
                    type:"POST",
                    data: {  
                        "conacorp" :searchCode,  
                    }, 
                    async:false,
                    success:function(data){  
                        tabPop_grid(data);
                    },error:function(e){
                        console.log("error");                            
                    }
                }).done(function(fragment){           

                })    

        } 


        //  tab01 grid data 수집
        function tabPop_grid(data){
            var wtab03Dto  = data;    
            var wtab03_data = [];
            var cnt = 1; 
            for (var i = 0; i < wtab03Dto.length; i++) {
                wtab03_data.push({
                    id: i, 
                    index: cnt, 
                    acorp1: wtab03Dto[i]["acorp1"], 
                    acorp2: wtab03Dto[i]["acorp2"], 
                    acorp3: wtab03Dto[i]["acorp3"],  
                    acode: wtab03Dto[i]["acode"], 
                    acorp: wtab03Dto[i]["acorp"]      
                });
                cnt++;
            }    
            wtab03Grid.columns.clear();  
            wtab03Grid.autoGenerateColumns = false; 
            view_p01tab03page.sourceCollection  = wtab03_data;

            var cols = new wijmo.grid.Column(); 
            cols.binding = 'acode';
            cols.header = '코드';
            cols.align = "center";
            cols.width = 80;
            cols.cellTemplate = wijmo.grid.cellmaker.CellMaker.makeLink({ 
                text: '<b>${item.acode}</b>',
                click: (e, ctx) => {
                    wcifChk_a(ctx.item.acorp1, ctx.item.acorp2, ctx.item.acorp3, ctx.item.acode,   ctx.item.acorp );                    
                    
                }
            });
            wtab03Grid.columns.push(cols);  

            cols = new wijmo.grid.Column(); 
            cols.binding = 'acorp';
            cols.header = '거래처명'; 
            cols.align = "left"; 
            cols.width = 200;
            wtab03Grid.columns.push(cols); 
        }        

                        //acorp1, acorp2, acorp3, acode,   acorp
        function wcifChk_a(arg1, arg2, arg3, arg4, arg5){                       
                document.getElementById('acorp1').value = arg1;  
                document.getElementById('acorp2').value = arg2;  
                document.getElementById('acorp3').value = arg3;  
                document.getElementById('acode').value = arg4;   
                document.getElementById("acorp").value = arg5;  //.innerText = arg5;
                //document.getElementById('acorp').value = arg5;   
                $("#wciflist_rtn").trigger("click");
                
            }
        
    // ####################################################################################################  
    
    // 우편번호  script 
    function sample4_execDaumPostcode() {
            new daum.Postcode({
                oncomplete: function(data) {
                    // 팝업에서 검색결과 항목을 클릭했을때 실행할 코드를 작성하는 부분.

                    // 도로명 주소의 노출 규칙에 따라 주소를 표시한다.
                    // 내려오는 변수가 값이 없는 경우엔 공백('')값을 가지므로, 이를 참고하여 분기 한다.
                    var roadAddr = data.roadAddress; // 도로명 주소 변수
                    var extraRoadAddr = ''; // 참고 항목 변수

                    // 법정동명이 있을 경우 추가한다. (법정리는 제외)
                    // 법정동의 경우 마지막 문자가 "동/로/가"로 끝난다.
                    if(data.bname !== '' && /[동|로|가]$/g.test(data.bname)){
                        extraRoadAddr += data.bname;
                    }
                    // 건물명이 있고, 공동주택일 경우 추가한다.
                    if(data.buildingName !== '' && data.apartment === 'Y'){
                    extraRoadAddr += (extraRoadAddr !== '' ? ', ' + data.buildingName : data.buildingName);
                    }
                    // 표시할 참고항목이 있을 경우, 괄호까지 추가한 최종 문자열을 만든다.
                    if(extraRoadAddr !== ''){
                        extraRoadAddr = ' (' + extraRoadAddr + ')';
                    }

                    // 우편번호와 주소 정보를 해당 필드에 넣는다.
                    document.getElementById('apost1').value = data.zonecode;
                    document.getElementById("ajuso1").value = roadAddr;
                    document.getElementById("ajuso2").focus();
                    // alert(data.zonecode);
                    // document.getElementById("ajuso2").value = data.jibunAddress;
                    
                    // 참고항목 문자열이 있을 경우 해당 필드에 넣는다.
                    // if(roadAddr !== ''){
                    //     document.getElementById("sample4_extraAddress").value = extraRoadAddr;
                    // } else {
                    //     document.getElementById("sample4_extraAddress").value = '';
                    // }

                    // var guideTextBox = document.getElementById("guide");
                    // 사용자가 '선택 안함'을 클릭한 경우, 예상 주소라는 표시를 해준다.
                    // if(data.autoRoadAddress) {
                    //     var expRoadAddr = data.autoRoadAddress + extraRoadAddr;
                    //     guideTextBox.innerHTML = '(예상 도로명 주소 : ' + expRoadAddr + ')';
                    //     guideTextBox.style.display = 'block';

                    // } else if(data.autoJibunAddress) {
                    //     var expJibunAddr = data.autoJibunAddress;
                    //     guideTextBox.innerHTML = '(예상 지번 주소 : ' + expJibunAddr + ')';
                    //     guideTextBox.style.display = 'block';
                    // } else {
                    //     guideTextBox.innerHTML = '';
                    //     guideTextBox.style.display = 'none';
                    // }
                }
            }).open();
        }

    // 바코드 
        function barcode_prt(){
            // $("#bcTarget").barcode("1234567890128", "codabar");        
            //    바코드 타입    
            //    codabar
            //    code11 (code 11)
            //    code39 (code 39)
            //    code93 (code 93)
            //    code128 (code 128)
            //    ean8 (ean 8)
            //    ean13 (ean 13)
            //    std25 (standard 2 of 5 - industrial 2 of 5)
            //    int25 (interleaved 2 of 5)
            //    msi
            //    datamatrix (ASCII + extended)
            
            // div 초기화 
            const ListDivs = $('div[data-name="fileDiv"]');
            ListDivs.remove();
            var ls_barcode = document.getElementById('jkey').value ;


        // for (var i = 0; i < 3; i++) {
                // wfile_data.push({
                //     id: i, 
                //     index: cnt,
                //     idx: wfileDto[i]["idx"],
                //     boardIdx: wfileDto[i]["boardIdx"], 
                //     originalName: wfileDto[i]["originalName"], 
                // });  
                    // var  id = i; 
                    // var  idx = wfileDto[i]["idx"];
                    // var  boardIdx = wfileDto[i]["boardIdx"];
                    // var  originalName = wfileDto[i]["originalName"]; 

                const fileHtml = `
                <div data-name="fileDiv" class="form-group filebox bs3-primary">
                    
                        <table>
                            <tr> 
                                <td> 
                                    <div class="col-sm-15">
                                        $("#bcTarget").barcode("${ls_barcode}", "code128");
    
                                    </div>
                                </td>
                            </tr>
                        </table>  
                </div>
                `; 

                // $('#btnDiv').before(fileHtml);                                

            //    cnt++;                        
        // }  


            $("#bcTarget").barcode(ls_barcode, "code128");
        }
        function barcodeprt_btn(){
            var ls_barcode = document.getElementById('jkey').value ;
            var ls_qty = document.getElementById('inprtqty').value ;


            var initBody;
                window.onbeforeprint = function(){
                    initBody = document.body.innerHTML;
                    document.body.innerHTML =  document.getElementById('bcTarget').innerHTML;
                };
                window.onafterprint = function(){
                document.body.innerHTML = initBody;
                };
                for (var h = 0; h <= ls_qty ; h++){

                    window.print();
                }
                return false;


        }



    // 날짜 및 시간 표현 script     
            //gettoday,init_date script
            $(document).ready(function() {             
                getToday()
                //fn_egov_init_date()  
                
            })       
        
            // function timeFunction() {
            //     var actarrivtimez = document.getElementById("#actarrivtimez").value;
            //     var actcomptimez = document.getElementById("#actcomptimez").value;
            // }
            function getToday(){
                let today = new Date();   
                let year = today.getFullYear(); // 년도
                let month = today.getMonth() + 1;  // 월
                let date = today.getDate();  // 날짜d
                let day = today.getDay();  // 요일
                let hours = today.getHours();
                let minutes = today.getMinutes();
                if(month > 0 && month < 10) {month = "0" + month};
                if(date > 0 && date < 10) {date = "0" + date};
                if(minutes > 0 && minutes < 10) {minutes = "0" + minutes};
                if(hours > 0 && hours < 10) {hours = "0" + hours};
                let ls_time = hours + ':' + minutes
                let ls_dddd = year + '-' + month + '-' + '01'
                let ls_frday = year + '-' + month + '-' + date
                let ls_today = year + '-' + month + '-' + date  
            }
            function convert_time(timestamp){ 
                //현재시간
                var date = new Date(timestamp); 
                var year = date.getFullYear();
                var month = ("0" + (1 + date.getMonth())).slice(-2);
                var day = ("0" + date.getDate()).slice(-2); 
                var hh = date.getHours();  
                var min = ('0' + date.getMinutes()).slice(-2) 
                time = year +  month +  day   ;
                return time;  
            
            } 
            
            
            
            // <!--######################################## 그리드 메뉴-->
            class FlexGridContextMenu {
                constructor(grid) {
                    let host = grid.hostElement, menu = this._buildMenu(grid);
                    host.addEventListener('contextmenu', (e) => {
                        // 클릭된 셀/열 선택
                        let sel = grid.selection, ht = grid.hitTest(e), row = ht.getRow();

                        switch (ht.panel) {
                            case grid.cells:
                            let colIndex = ht.col;
                            // 만약 그룹 헤더이면, 그룹 열 선택
                            if (row instanceof wijmo.grid.GroupRow && row.dataItem instanceof wijmo.collections.CollectionViewGroup) {
                                let gd = row.dataItem.groupDescription;
                                if (gd instanceof wijmo.collections.PropertyGroupDescription) {
                                let col = grid.getColumn(gd.propertyName);
                                if (col && col.index > -1) {
                                    colIndex = col.index;
                                }
                                }
                            }
                            grid.select(ht.row, colIndex);
                            break;
                            case grid.columnHeaders:
                            grid.select(sel.row, ht.col);
                            break;
                            case grid.rowHeaders:
                            grid.select(ht.row, sel.col);
                            break;
                            default:
                            return; // 유효하지 않는 패널
                        }
                        // 현재 열에 대한 메뉴 표시
                        if (grid.selection.col > -1) {
                            e.preventDefault(); // 브라우저의 기본 메뉴 취소
                            menu.show(e); // Wijmo 메뉴 표시
                        }
                    }, true);
                }
                _buildMenu(grid) {
                    let menu = new wijmo.input.Menu(document.createElement('div'), {
                    owner: grid.hostElement,
                    displayMemberPath: 'header',
                    subItemsPath: 'items',
                    commandParameterPath: 'cmd',
                    dropDownCssClass: 'ctx-menu',
                    openOnHover: true,
                    closeOnLeave: true,
                    itemsSource: [
                        {
                        header: '정렬', items: [
                            { header: 'Ascending', cmd: 'SRT_ASC' },
                            { header: 'Descending', cmd: 'SRT_DESC' },
                            { header: 'No Sort', cmd: 'SRT_NONE' },
                            { header: '-' },
                            { header: 'Clear All Sorts', cmd: 'SRT_CLR' }
                        ]
                        },
                        { header: '-' },
                        { header: 'Pin/Unpin', cmd: 'PIN' },
                        { header: '-' },
                        { header: 'AutoSize', cmd: 'ASZ' },
                        { header: 'AutoSize All', cmd: 'ASZ_ALL' },
                        { header: '-' },
                        { header: 'Group/Ungroup', cmd: 'GRP' },
                        { header: 'Clear All Groups', cmd: 'GRP_CLR' },
                        { header: '-' },
                        {
                        header: '내려받기', items: [
                            { header: 'CSV', cmd: 'X_CSV' },
                            { header: 'XLSX', cmd: 'X_XLSX' },
                            { header: 'PDF', cmd: 'X_PDF' },
                        ]
                        }
                    ],
                    command: {
                        // 메뉴 명령 활성화/비활성화
                        canExecuteCommand: (cmd) => {
                        let view = grid.collectionView, col = grid.columns[grid.selection.col];
                        switch (cmd) {
                            case 'SRT_ASC':
                            return col.currentSort != '+';
                            case 'SRT_DESC':
                            return col.currentSort != '-';
                            case 'SRT_NONE':
                            return col.currentSort != null;
                            case 'SRT_CLR':
                            return view.sortDescriptions.length > 0;
                            case 'PIN':
                            return true; // toggle pin
                            case 'ASZ':
                            case 'ASZ_ALL':
                            return true;
                            case 'GRP':
                            return col.dataType != wijmo.DataType.Number; // don't group numbers
                            case 'GRP_CLR':
                            return view.groupDescriptions.length > 0;
                        }
                        return true;
                        },
                        // 메뉴 명령 실행
                        
                        executeCommand: (cmd) => {
                            let view = grid.collectionView, cols = grid.columns, col = cols[grid.selection.col], sd = view.sortDescriptions, gd = view.groupDescriptions;
                                            
                            switch (cmd) {
                                case 'SRT_ASC':
                                case 'SRT_DESC':
                                case 'SRT_NONE':
                                if (grid.allowSorting != wijmo.grid.AllowSorting.MultiColumn) {
                                    sd.clear();
                                }
                                else {
                                    for (let i = 0; i < sd.length; i++) {
                                    if (sd[i].property == col.binding) {
                                        sd.removeAt(i);
                                        break;
                                    }
                                    }
                                }
                                if (cmd != 'SRT_NONE') {
                                    sd.push(new wijmo.collections.SortDescription(col.binding, cmd == 'SRT_ASC'));
                                }
                                    break;
                                case 'SRT_CLR':
                                    sd.clear();
                                    break;
                                case 'PIN':
                                    let fCols = grid.frozenColumns;
                                    if (col.index >= fCols) { // pinning
                                        cols.moveElement(col.index, fCols, false);
                                        cols.frozen++;
                                    }
                                    else { // unpinning
                                        cols.moveElement(col.index, fCols - 1, false);
                                        cols.frozen--;
                                    }
                                    break;
                                case 'ASZ':
                                    grid.autoSizeColumn(col.index);
                                    break;
                                case 'ASZ_ALL':
                                    grid.autoSizeColumns(0, grid.columns.length - 1);
                                    break;
                                case 'GRP':
                                // 그룹 삭제
                                    for (let i = 0; i < gd.length; i++) {
                                        if (gd[i].propertyName == col.binding) {
                                        gd.removeAt(i);
                                        return; // we're done
                                        }
                                    }
                                    // 그룹 추가
                                    gd.push(new wijmo.collections.PropertyGroupDescription(col.binding));
                                    break;
                                case 'GRP_CLR':
                                    gd.clear();
                                    break;
                                // 내보내기
                                case 'X_CSV':
                                    let rng = new wijmo.grid.CellRange(0, 0, grid.rows.length - 1, grid.columns.length - 1), csv = grid.getClipString(rng, wijmo.grid.ClipStringOptions.CSV, true, false);
                                    wijmo.saveFile(csv, 'FlexGrid.csv');
                                    break;
                                case 'X_XLSX':
                                    //엑셀수정
                                    const gridView = grid.collectionView;
                                    let oldPgSize = gridView.pageSize, oldPgIndex = gridView.pageIndex;

                                    grid.beginUpdate();
                                    gridView.pageSize = 0;

                                    wijmo.grid.xlsx.FlexGridXlsxConverter.saveAsync(grid, {includeCellStyles: true, includeColumnHeaders: true}, 'FlexGrid.xlsx',
                                    saved => {
                                    gridView.pageSize = oldPgSize;
                                    gridView.moveToPage(oldPgIndex);
                                    grid.endUpdate();
                                    }, null
                                    );                          
                                    break;
                                case 'X_PDF':
                                    wijmo.grid.pdf.FlexGridPdfConverter.export(grid,'FlexGrid.pdf', {
                                        maxPages: 10,
                                        scaleMode: wijmo.grid.pdf.ScaleMode.PageWidth,
                                        // exportMode = wijmo.grid.pdf.ExportMode.All,
                                        documentOptions: {
                                            compress: true,
                                            pageSettings: {
                                            layout: orientation
                                            },
                                        header: { declarative: { text: '\t&[Page] of &[Pages]' } },
                                        footer: { declarative: { text: '\t&[Page] of &[Pages]' } },
                                        info: { author: 'Actas', title: 'FlexGrid' }
                                        },
                                        styles: {
                                        cellStyle: { backgroundColor: '#ffffff', borderColor: '#c6c6c6' },
                                        altCellStyle: { backgroundColor: '#f9f9f9' },
                                        groupCellStyle: { backgroundColor: '#dddddd' },
                                        headerCellStyle: { backgroundColor: '#eaeaea' }
                                        },
                                        embeddedFonts: 
                                        {
                                        // source: 'resources/fira/FiraSans-Regular.ttf',
                                        source: 'https://assets.codepen.io/975719/FiraSans-Regular.ttf',
                                        name: 'fira',
                                        style: 'normal',
                                        weight: 'normal',
                                        sansSerif: true
                                        }
                                    });
                                    // let doc = new pdf.PdfDocument({
                                    // header: {
                                    //     declarative: {
                                    //         text: '\t&[Page]\\&[Pages]'
                                    //     }
                                    // },
                                    // footer: {
                                    //     declarative: {
                                    //         text: '\t&[Page]\\&[Pages]'
                                    //     }
                                    // },
                                    // ended: (sender, args) => pdf.saveBlob(args.blob, 'FlexGrid.pdf')
                                    // });
                                    // let settings = {
                                    // styles: {
                                    //     cellStyle: {
                                    //         backgroundColor: '#ffffff',
                                    //         borderColor: '#c6c6c6'
                                    //     },
                                    //     altCellStyle: {
                                    //         backgroundColor: '#f9f9f9'
                                    //     },
                                    //     groupCellStyle: {
                                    //         backgroundColor: '#dddddd'
                                    //     },
                                    //     headerCellStyle: {
                                    //         backgroundColor: '#eaeaea'
                                    //     }
                                    // }}
                                    // doc.drawText('This grid is drawn in its original size using the draw method and is split into multiple pages.', 0, 400);
                                    // doc.moveDown();
                                    // gridPdf.FlexGridPdfConverter.draw(flexGrid, doc, null, null, settings);
                                    // //
                                    // doc.end();
                                    break;
                            }
                            // 활성화 그리드 셀에 포커스 복원
                            grid.refresh();
                            let sel = grid.selection, cell = grid.cells.getCellElement(sel.row, sel.col);
                            if (cell) {
                                cell.focus();
                            }
                        }
                    }
                    });
                    // 완료
                    return menu;
                }
            }


            //모달 끝
    // 자바 끝
    </script>  
</div>  

<!-- ######################### ######################### ######################### ######################### ######################### ######################### -->
</body> 
               
                    <!------footer ------>
                    <!-- <footer th:replace="layouts/XDashBoard/XDashBoard_footer :: XDashBoard_footer"></footer> -->
                    <!--------------------->
                </div>  
            <!-- </div> -->
        </main>
    </div>
</header>