<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">  
<header th:fragment="headerFragment">
   <!-- <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>   -->
    <!-- 차트  -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0; 
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: #007bff;
            color: white;
            padding: 10px 20px;
            font-size: 1.2rem;
        }
        .header .time {
            font-size: 1rem;
        }
        .controls {
            display: flex;
            gap: 10px;
            padding: 10px 20px;
            background-color: #e9ecef;
            border-bottom: 1px solid #dee2e6;
        }
        .controls input, .controls select, .controls button {
            padding: 5px;
            font-size: 1rem;
        }
        .dashboard {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            padding: 20px;
        }
        .summary {
            display: flex;
            justify-content: space-around;
            margin: 20px;
            padding: 10px;
            background-color: #fff;
            border: 1px solid #dee2e6;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .summary-item {
            text-align: center;
            padding: 10px;
            border-radius: 5px;
            color: white;
            font-size: 1.2rem;
            width: 150px;
        }
        .summary-item.blue {
            background-color: #007bff;
        }
        .summary-item.green {
            background-color: #28a745;
        }
        .summary-item.yellow {
            background-color: #ffc107;
        }
        .summary-item.red {
            background-color: #dc3545;
        }
        .card {
            background-color: white;
            border: 1px solid #dee2e6;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .card-header {
            text-align: center;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .chart-container {
            position: relative;
            height: 200px;
            width: 200px;
            margin: 0 auto;
        }
        .info {
            text-align: center;
            margin-top: 10px;
        }
        .info table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        .info table td {
            padding: 5px;
            text-align: left;
        }
        .completed {
            text-align: center;
            margin-top: 10px;
            background-color: #28a745;
            color: white;
            border-radius: 5px;
            padding: 5px;
        }
    </style>
    <div class="card-body d-flex align-items-center py-md-2 px-2 py-1">      
    <main class="main" id="top">
        <!-- Fluid Layout:  Replace class .container to .container-fluid inside the main tag, and the page will be switched to fluid layout. -->
        <div class="container-fluid"> 
            <!-- <div class="container" data-layout="container"> -->
                <script>
                    var isFluid = JSON.parse(localStorage.getItem('isFluid'));
                    if (isFluid) {
                        var container = document.querySelector('[data-layout]');
                        container.classList.remove('container');
                        container.classList.add('container-fluid');
                    }
                </script>
                <nav class="navbar navbar-light navbar-vertical navbar-expand-xl">
                    <script>
                        var navbarStyle = localStorage.getItem("navbarStyle");
                        if (navbarStyle && navbarStyle !== 'transparent') {
                            document.querySelector('.navbar-vertical').classList.add(`navbar-${navbarStyle}`);
                        }
                    </script>
                    <div class="d-flex align-items-center">
                        <div class="toggle-icon-wrapper">

                            <button class="btn navbar-toggler-humburger-icon navbar-vertical-toggle"
                                data-bs-toggle="tooltip" data-bs-placement="left" title="Toggle Navigation"><span
                                    class="navbar-toggle-icon"><span class="toggle-line"></span></span></button>

                        </div><a class="navbar-brand" href="@{/user}">
                            <!-- <div class="d-flex align-items-center py-3"><img class="me-2"
                                    th:src="@{assets/img/icons/spot-illustrations/falcon.png}" alt="" width="40" /><span
                                    class="font-sans-serif">ActasErp</span>
                            </div> -->
                        </a>
                    </div>  
                    <!------navbar vertical------>     
                    <div th:replace="layouts/layout01/navbarMemWeb :: navbar"></div>  
                </nav>
                <div class="content">  
                    <!------nav ------>     
                    <!-- <div th:replace="layouts/layout01/headerNavWeb :: headerNav"></div>    -->
                    <!------contents ------>    
                    <!-- <div class="container">contents display</div> -->
                    <!-- <div th:replace="layouts/XDashBoard/dashboard001 :: dashboard001"></div>   -->
                    <!-- 
                        content fragment 사용 
                        현재 layout을 사용하는 content fragment의 내용을 삽입한다.
                    -->
                    <body layout:fragment="content">
                      <div class="card-body bg-light">
                            <ul class="nav nav-tabs">
                                <li class="nav-item">
                                    <a class="nav-link active" data-toggle="tab" href="#step01" onclick="tabchk_rtn('A')">생산가동현황</a>
                                </li>
                                <!--<li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#step02"  onclick="tabchk_rtn('B')">생산진행</a>
                                </li> 
                                <li class="nav-item">
                                    <a class="nav-link" data-toggle="tab" href="#step03"  onclick="tabchk_rtn('C')">검사이력현황</a>
                                </li> -->
                                <input type="hidden" id="tabvalue" value="A">
                            </ul>
                            <div class="tab-content">
                                  <div class="tab-pane fade show active" id="step01">     
                                    <div class="header">
                                      <div>CMS - Product Board</div>
                                      <div class="time" id="current-time">--:--:--</div>
                                  </div>
                          
                                  <div class="controls">
                                      <label>Start Date:
                                          <input type="datetime-local"  value="2024-12-09T00:00" id = "startdate">
                                      </label>
                                      <label>End Date:
                                          <input type="datetime-local" value="2024-12-09T23:59"  id = "enddate">
                                      </label>
                                      <label>Machine Name:
                                          <input type="text">
                                      </label>
                                      <label>Material:
                                          <input type="text">
                                      </label>
                                      <button>Search</button>
                                  </div>
                          
                                  <!-- <div class="summary">
                                    <div class="summary-item blue">
                                        <div>사출기</div>
                                        <div id="total-machines">15</div>
                                    </div>
                                    <div class="summary-item green">
                                        <div>동작중</div>
                                        <div id="active-machines">14</div>
                                    </div>
                                    <div class="summary-item yellow">
                                        <div>수동</div>
                                        <div id="manual-machines">0</div>
                                    </div>
                                    <div class="summary-item red">
                                        <div>정지</div>
                                        <div id="stopped-machines">1</div>
                                    </div>
                                </div> -->

                                <div class="dashboard">
                                    <!-- Cards for each product -->
                                    <div class="card">
                                        <div class="card-header" id="addname0">No. 1 - 금형명칭: </div>
                                        <div class="chart-container">
                                            <canvas id="chart0"></canvas>
                                        </div>
                                        <div class="info">
                                            <table>
                                                <tr>
                                                    <td style="font-weight: bold;">기계 상태:</td><td  id="machineState0" >자동</td>
                                                    <td style="font-weight: bold;">계획:</td><td  id="plannedQty0">75</td>
                                                </tr>
                                                <tr>
                                                    <td style="font-weight: bold;">생산:</td><td  id="producedQty0">125</td>
                                                    <td style="font-weight: bold;">불량:</td><td  id="defectiveQty0"  colspan="3">125</td>
                                                </tr>  
                                                <tr><td style="font-weight: bold;">금형온도:</td><td id="temperature0"  colspan="3">0</td></tr>
                                                <tr><td style="font-weight: bold;">온수기:</td><td id="onsutemp0">0</td><td style="font-weight: bold;">건조기:</td><td id="drytemp0">0</td></tr>
                                                <tr>
                                                    <td style="font-weight: bold;">캐비티:</td><td id="cavityCount0"  >0</td>
                                                    <td style="font-weight: bold;">가동시간:</td><td id="operatingTime0"  >0</td>
                                                </tr> 
                                                <tr><td style="font-weight: bold;">설비유휴시간:</td><td id="idleTime0"  colspan="3">100%</td></tr>
                                            </table>
                                        </div>
                                        <div class="completed">37% Completed..</div>
                                    </div>
                            
                                    <div class="card">
                                        <div class="card-header" id="addname1">No. 2 - 금형명칭: </div>
                                        <div class="chart-container">
                                            <canvas id="chart1"></canvas>
                                        </div>
                                        <div class="info">
                                            <table>
                                                <tr>
                                                    <td style="font-weight: bold;">기계 상태:</td><td  id="machineState1" >자동</td>
                                                    <td style="font-weight: bold;">계획:</td><td  id="plannedQty1">75</td>
                                                </tr>
                                                <tr>
                                                    <td style="font-weight: bold;">생산:</td><td  id="producedQty1">125</td>
                                                    <td style="font-weight: bold;">불량:</td><td  id="defectiveQty1"  colspan="3">125</td>
                                                </tr>  
                                                <tr><td style="font-weight: bold;">금형온도:</td><td id="temperature1"  colspan="3">0</td></tr>
                                                <tr><td style="font-weight: bold;">온수기:</td><td id="onsutemp1">0</td><td style="font-weight: bold;">건조기:</td><td id="drytemp1">0</td></tr>
                                                <tr>
                                                    <td style="font-weight: bold;">캐비티:</td><td id="cavityCount1"  >0</td>
                                                    <td style="font-weight: bold;">가동시간:</td><td id="operatingTime1"  >0</td>
                                                </tr> 
                                                <tr><td style="font-weight: bold;">설비유휴시간:</td><td id="idleTime1"  colspan="3">100%</td></tr>
                                            </table>
                                        </div>
                                        <div class="completed">37% Completed..</div>
                                    </div>
                            
                                    <div class="card">
                                        <div class="card-header" id="addname2">No. 3 - 금형명칭: </div>
                                        <div class="chart-container">
                                            <canvas id="chart2"></canvas>
                                        </div>
                                        <div class="info">
                                            <table> 
                                                <tr>
                                                    <td style="font-weight: bold;">기계 상태:</td><td  id="machineState2" >자동</td>
                                                    <td style="font-weight: bold;">계획:</td><td  id="plannedQty2">75</td>
                                                </tr>
                                                <tr>
                                                    <td style="font-weight: bold;">생산:</td><td  id="producedQty2">125</td>
                                                    <td style="font-weight: bold;">불량:</td><td  id="defectiveQty2"  colspan="3">125</td>
                                                </tr>  
                                                <tr><td style="font-weight: bold;">금형온도:</td><td id="temperature2"  colspan="3">0</td></tr>
                                                <tr><td style="font-weight: bold;">온수기:</td><td id="onsutemp2">0</td><td style="font-weight: bold;">건조기:</td><td id="drytemp2">0</td></tr>
                                                <tr>
                                                    <td style="font-weight: bold;">캐비티:</td><td id="cavityCount2"  >0</td>
                                                    <td style="font-weight: bold;">가동시간:</td><td id="operatingTime2"  >0</td>
                                                </tr> 
                                                <tr><td style="font-weight: bold;">설비유휴시간:</td><td id="idleTime2"  colspan="3">100%</td></tr>
                                            </table>
                                        </div>
                                        <div class="completed">37% Completed..</div>
                                    </div>

                                    <div class="card">
                                        <div class="card-header" id="addname3">No. 4 - 금형명칭: </div>
                                        <div class="chart-container">
                                            <canvas id="chart3"></canvas>
                                        </div>
                                        <div class="info">
                                            <table>
                                                <tr>
                                                    <td style="font-weight: bold;">기계 상태:</td><td  id="machineState3" >자동</td>
                                                    <td style="font-weight: bold;">계획:</td><td  id="plannedQty3">75</td>
                                                </tr>
                                                <tr>
                                                    <td style="font-weight: bold;">생산:</td><td  id="producedQty3">125</td>
                                                    <td style="font-weight: bold;">불량:</td><td  id="defectiveQty3"  colspan="3">125</td>
                                                </tr>  
                                                <tr><td style="font-weight: bold;">금형온도:</td><td id="temperature3"  colspan="3">0</td></tr>
                                                <tr><td style="font-weight: bold;">온수기:</td><td id="onsutemp3">0</td><td style="font-weight: bold;">건조기:</td><td id="drytemp3">0</td></tr>
                                                <tr>
                                                    <td style="font-weight: bold;">캐비티:</td><td id="cavityCount3"  >0</td>
                                                    <td style="font-weight: bold;">가동시간:</td><td id="operatingTime3"  >0</td>
                                                </tr> 
                                                <tr><td style="font-weight: bold;">설비유휴시간:</td><td id="idleTime3"  colspan="3">100%</td></tr>
                                            </table>
                                        </div>
                                        <div class="completed">37% Completed..</div>
                                    </div>
                            
                                    <!-- Additional cards... -->
                                </div>


                                <div class="dashboard">
                                    <!-- Cards for each product -->
                                    <div class="card">
                                        <div class="card-header" id="addname4">No. 5 - 금형명칭: </div>
                                        <div class="chart-container">
                                            <canvas id="chart4"></canvas>
                                        </div>
                                        <div class="info">
                                            <table>
                                                <tr>
                                                    <td style="font-weight: bold;">기계 상태:</td><td  id="machineState4" >자동</td>
                                                    <td style="font-weight: bold;">계획:</td><td  id="plannedQty4">75</td>
                                                </tr>
                                                <tr>
                                                    <td style="font-weight: bold;">생산:</td><td  id="producedQty4">125</td>
                                                    <td style="font-weight: bold;">불량:</td><td  id="defectiveQty4"  colspan="3">125</td>
                                                </tr>  
                                                <tr><td style="font-weight: bold;">금형온도:</td><td id="temperature4"  colspan="3">0</td></tr>
                                                <tr><td style="font-weight: bold;">온수기:</td><td id="onsutemp4">0</td><td style="font-weight: bold;">건조기:</td><td id="drytemp4">0</td></tr>
                                                <tr>
                                                    <td style="font-weight: bold;">캐비티:</td><td id="cavityCount4"  >0</td>
                                                    <td style="font-weight: bold;">가동시간:</td><td id="operatingTime4"  >0</td>
                                                </tr> 
                                                <tr><td style="font-weight: bold;">설비유휴시간:</td><td id="idleTime4"  colspan="3">100%</td></tr>
                                            </table>
                                        </div>
                                        <div class="completed">37% Completed..</div>
                                    </div>
                            
                                    <div class="card">
                                        <div class="card-header" id="addname5">No. 6 - 금형명칭: </div>
                                        <div class="chart-container">
                                            <canvas id="chart5"></canvas>
                                        </div>
                                        <div class="info">
                                            <table>
                                                <tr>
                                                    <td style="font-weight: bold;">기계 상태:</td><td  id="machineState5" >자동</td>
                                                    <td style="font-weight: bold;">계획:</td><td  id="plannedQty5">75</td>
                                                </tr>
                                                <tr>
                                                    <td style="font-weight: bold;">생산:</td><td  id="producedQty5">125</td>
                                                    <td style="font-weight: bold;">불량:</td><td  id="defectiveQty5"  colspan="3">125</td>
                                                </tr>  
                                                <tr><td style="font-weight: bold;">금형온도:</td><td id="temperature5"  colspan="3">0</td></tr>
                                                <tr><td style="font-weight: bold;">온수기:</td><td id="onsutemp5">0</td><td style="font-weight: bold;">건조기:</td><td id="drytemp5">0</td></tr>
                                                <tr>
                                                    <td style="font-weight: bold;">캐비티:</td><td id="cavityCount5"  >0</td>
                                                    <td style="font-weight: bold;">가동시간:</td><td id="operatingTime5"  >0</td>
                                                </tr> 
                                                <tr><td style="font-weight: bold;">설비유휴시간:</td><td id="idleTime5"  colspan="3">100%</td></tr>
                                            </table>
                                        </div>
                                        <div class="completed">37% Completed..</div>
                                    </div>
                            
                                    <div class="card">
                                        <div class="card-header" id="addname6">No. 7 - 금형명칭: </div>
                                        <div class="chart-container">
                                            <canvas id="chart6"></canvas>
                                        </div>
                                        <div class="info">
                                            <table>
                                                <tr>
                                                    <td style="font-weight: bold;">기계 상태:</td><td  id="machineState6" >자동</td>
                                                    <td style="font-weight: bold;">계획:</td><td  id="plannedQty6">75</td>
                                                </tr>
                                                <tr>
                                                    <td style="font-weight: bold;">생산:</td><td  id="producedQty6">125</td>
                                                    <td style="font-weight: bold;">불량:</td><td  id="defectiveQty6"  colspan="3">125</td>
                                                </tr>  
                                                <tr><td style="font-weight: bold;">금형온도:</td><td id="temperature6"  colspan="3">0</td></tr>
                                                <tr><td style="font-weight: bold;">온수기:</td><td id="onsutemp6">0</td><td style="font-weight: bold;">건조기:</td><td id="drytemp6">0</td></tr>
                                                <tr>
                                                    <td style="font-weight: bold;">캐비티:</td><td id="cavityCount6"  >0</td>
                                                    <td style="font-weight: bold;">가동시간:</td><td id="operatingTime6"  >0</td>
                                                </tr> 
                                                <tr><td style="font-weight: bold;">설비유휴시간:</td><td id="idleTime6"  colspan="3">100%</td></tr>
                                            </table>
                                        </div>
                                        <div class="completed">37% Completed..</div>
                                    </div>

                                    <div class="card">
                                        <div class="card-header" id="addname7">No. 8 - 금형명칭: </div>
                                        <div class="chart-container">
                                            <canvas id="chart7"></canvas>
                                        </div>
                                        <div class="info">
                                            <table>
                                                <tr>
                                                    <td style="font-weight: bold;">기계 상태:</td><td  id="machineState7" >자동</td>
                                                    <td style="font-weight: bold;">계획:</td><td  id="plannedQty7">75</td>
                                                </tr>
                                                <tr>
                                                    <td style="font-weight: bold;">생산:</td><td  id="producedQty7">125</td>
                                                    <td style="font-weight: bold;">불량:</td><td  id="defectiveQty7"  colspan="3">125</td>
                                                </tr>  
                                                <tr><td style="font-weight: bold;">금형온도:</td><td id="temperature7"  colspan="3">0</td></tr>
                                                <tr><td style="font-weight: bold;">온수기:</td><td id="onsutemp7">0</td><td style="font-weight: bold;">건조기:</td><td id="drytemp7">0</td></tr>
                                                <tr>
                                                    <td style="font-weight: bold;">캐비티:</td><td id="cavityCount7"  >0</td>
                                                    <td style="font-weight: bold;">가동시간:</td><td id="operatingTime7"  >0</td>
                                                </tr> 
                                                <tr><td style="font-weight: bold;">설비유휴시간:</td><td id="idleTime7"  colspan="3">100%</td></tr>
                                            </table>
                                        </div>
                                        <div class="completed">37% Completed..</div>
                                    </div>
                            
                                    <!-- Additional cards... -->
                                </div>
                              </div>
                            </div>      
                       </div> 
 

                       <div class="dashboard">
                        <!-- Cards for each product -->
                        <div class="card">
                            <div class="card-header" id="addname8">No. 9 - 금형명칭: </div>
                            <div class="chart-container">
                                <canvas id="chart8"></canvas>
                            </div>
                            <div class="info">
                                <table>
                                    <tr>
                                        <td style="font-weight: bold;">기계 상태:</td><td  id="machineState8" >자동</td>
                                        <td style="font-weight: bold;">계획:</td><td  id="plannedQty8">75</td>
                                    </tr>
                                    <tr>
                                        <td style="font-weight: bold;">생산:</td><td  id="producedQty8">125</td>
                                        <td style="font-weight: bold;">불량:</td><td  id="defectiveQty8"  colspan="3">125</td>
                                    </tr>  
                                    <tr><td style="font-weight: bold;">금형온도:</td><td id="temperature8"  colspan="3">0</td></tr>
                                    <tr><td style="font-weight: bold;">온수기:</td><td id="onsutemp8">0</td><td style="font-weight: bold;">건조기:</td><td id="drytemp8">0</td></tr>
                                    <tr>
                                        <td style="font-weight: bold;">캐비티:</td><td id="cavityCount8"  >0</td>
                                        <td style="font-weight: bold;">가동시간:</td><td id="operatingTime8"  >0</td>
                                    </tr> 
                                    <tr><td style="font-weight: bold;">설비유휴시간:</td><td id="idleTime8"  colspan="3">100%</td></tr>
                                </table>
                            </div>
                            <div class="completed">37% Completed..</div>
                        </div>
                 
                        <!-- Additional cards... -->
                    </div>
                  </div>
                </div>      
           </div> 

                    </body>

                    <!------footer ------>    
                    <!-- <footer th:replace="layouts/layout01/XDashBoard_footer :: XDashBoard_footer"></footer>     -->
                    <!--------------------->
                </div> 
        </div>
    </main>
    <script> 

    window.onload = function() { 
        let chartInstance; 
 
        function createPieChart(ctx, data, labels) {
            return new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: ['#FF6384', '#4BC0C0', '#FFCD56', '#4BC0C0', '#36A2EB'],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top'
                        }
                    }
                }
            });
        }

               
      // Initialize charts  ['#FF6384', '#FF9F40', '#FFCD56', '#4BC0C0', '#36A2EB'],
        // Initialize charts
        const chart0 = createPieChart(
            document.getElementById('chart0').getContext('2d'),
            [40, 60],
            ['미완료',   '완료', ]
        );

        const chart1 = createPieChart(
            document.getElementById('chart1').getContext('2d'),
            [30, 70],
            ['미완료',   '완료', ]
        );
 
        const chart2 = createPieChart(
            document.getElementById('chart2').getContext('2d'),
            [ 25, 75],
            ['미완료',   '완료', ]
        );
 
        const chart3 = createPieChart(
            document.getElementById('chart3').getContext('2d'),
            [30, 70],
            ['미완료',   '완료', ]
        );
 
        const chart4 = createPieChart(
            document.getElementById('chart4').getContext('2d'),
            [40, 60],
            ['미완료',   '완료', ]
        );

        const chart5 = createPieChart(
            document.getElementById('chart5').getContext('2d'),
            [30, 70],
            ['미완료',   '완료', ]
        );
 
        const chart6 = createPieChart(
            document.getElementById('chart6').getContext('2d'),
            [ 25, 75],
            ['미완료',   '완료', ]
        );
 
        const chart7 = createPieChart(
            document.getElementById('chart7').getContext('2d'),
            [30, 70],
            ['미완료',   '완료', ]
        );
 
        const chart8 = createPieChart(
            document.getElementById('chart8').getContext('2d'),
            [30, 70],
            ['미완료',   '완료', ]
        );

        function convert_date(arg_date){  
            var ls_arg_date = String(arg_date); 
            if(ls_arg_date == null || ls_arg_date.length == 0 || ls_arg_date == ""|| ls_arg_date == "null"){  
                return "";
            }  
            // Date 객체로 변환
            const dateObj = new Date(arg_date);

            // 년, 월, 일 추출 (월은 0부터 시작하므로 +1 필요)
            const year = dateObj.getFullYear();
            const month = String(dateObj.getMonth() + 1).padStart(2, '0');
            const day = String(dateObj.getDate()).padStart(2, '0');


            // 시간과 분 추출
            const hours = String(dateObj.getHours()).padStart(2, '0');
            const minutes = String(dateObj.getMinutes()).padStart(2, '0');

            // "YYYY-MM-DD" 형식으로 변환
            const formattedDate = `${year}-${month}-${day} ${hours}:${minutes}`;
            arg_date = formattedDate; 
            return arg_date; 
        }

 
    }
   
    function updateCardData(machineId, data) {
        document.getElementById(`status${machineId}`).textContent = data.status;
        document.getElementById(`current${machineId}`).textContent = data.current;
        document.getElementById(`remaining${machineId}`).textContent = data.remaining;
        document.getElementById(`cavity${machineId}`).textContent = data.cavity;
        document.getElementById(`process${machineId}`).textContent = data.process;
        document.getElementById(`yield${machineId}`).textContent = data.yield;
    }

    async function fetchData() {
        // Example fetch logic
           
        var wtab01_data = []; 
        var cnt = 0;
        const response = await fetch('/appcms/addlistinfo'); // Replace with actual API endpoint
        const data = await response.json();
        console.log(data)
        for (var i = 0; i < data.length; i++) {
            if(data[i]["mold_Temperature_1"] + 
               data[i]["mold_Temperature_2"] + 
               data[i]["mold_Temperature_3"] + 
               data[i]["mold_Temperature_4"] + 
               data[i]["mold_Temperature_5"] + 
               data[i]["mold_Temperature_6"] == 0){
                continue
            }
            wtab01_data.push({
                id: i, 
                index: cnt,
                machine_name: data[i]["machine_name"], 
                additional_Info_1: data[i]["additional_Info_1"], 
                status: data[i]["status"], 
                wotqty: data[i]["wotqty"], 
                mold_Temperature_1: data[i]["mold_Temperature_1"], 
                mold_Temperature_2: data[i]["mold_Temperature_2"], 
                mold_Temperature_3: data[i]["mold_Temperature_3"], 
                mold_Temperature_4: data[i]["mold_Temperature_4"], 
                mold_Temperature_5: data[i]["mold_Temperature_5"], 
                mold_Temperature_6: data[i]["mold_Temperature_6"], 
                cavity: data[i]["cavity"], 
                operatingTimeHours: data[i]["operatingTimeHours"], 
                idleTimeMinute: data[i]["idleTimeMinute"],  
                starttime: data[i]["starttime"],  
                endtime: data[i]["endtime"],   
                
            });
        }
        const startdate = document.getElementById(`startdate`);
        const enddate = document.getElementById(`enddate`);

        // 날짜 문자열을 `datetime-local` 형식으로 변환
        const date01 = new Date(data[0].starttime);
        const date02 = new Date(data[0].endtime);

        // 로컬 시간으로 변환 (YYYY-MM-DD HH:mm:ss 형식)
        const localDate01 = date01.getFullYear() +
            "-" +
            String(date01.getMonth() + 1).padStart(2, "0") +
            "-" +
            String(date01.getDate()).padStart(2, "0") +
            " " +
            String(date01.getHours()).padStart(2, "0") +
            ":" +
            String(date01.getMinutes()).padStart(2, "0") +
            ":" +
            String(date01.getSeconds()).padStart(2, "0");
        // 로컬 시간으로 변환 (YYYY-MM-DD HH:mm:ss 형식)
        const localDate02 = date02.getFullYear() +
            "-" +
            String(date02.getMonth() + 1).padStart(2, "0") +
            "-" +
            String(date02.getDate()).padStart(2, "0") +
            " " +
            String(date02.getHours()).padStart(2, "0") +
            ":" +
            String(date02.getMinutes()).padStart(2, "0") +
            ":" +
            String(date02.getSeconds()).padStart(2, "0");
 
        // datetime-local 형식으로 변환 (YYYY-MM-DDTHH:mm) 
         startdate.value = localDate01.replace(" ", "T").slice(0, 16);
         enddate.value = localDate02.replace(" ", "T").slice(0, 16); 
        for (var i = 0; i < wtab01_data.length; i++) {
            
            const element = document.getElementById(`addname${i}`);
            const machine = document.getElementById(`machineState${i}`);
            const planqty = document.getElementById(`plannedQty${i}`);
            const proqty = document.getElementById(`producedQty${i}`);
            const defqty = document.getElementById(`defectiveQty${i}`);
            const temp = document.getElementById(`temperature${i}`);
            const onsutemp = document.getElementById(`onsutemp${i}`);
            const drytemp = document.getElementById(`drytemp${i}`);
            const cavity = document.getElementById(`cavityCount${i}`);
            const opertime = document.getElementById(`operatingTime${i}`);
            const idletime = document.getElementById(`idleTime${i}`); 
            
             
            if (element) { // Check if the element exists
                element.innerHTML = `${wtab01_data[i].machine_name}호기  ${wtab01_data[i].additional_Info_1}`;
            } else {
                console.warn(`Element with id addname${i} not found.`);
            } 
            if (machine) { // Check if the element exists
                machine.innerHTML = `${wtab01_data[i].status}`;
            } else {
                console.warn(`Element with id machine${i} not found.`);
            } 
            if (planqty) { // Check if the element exists
                planqty.innerHTML = `0`;
            } else {
                console.warn(`Element with id planqty${i} not found.`);
            } 
            if (proqty) { // Check if the element exists
                proqty.innerHTML = `${wtab01_data[i].wotqty}`;
            } else {
                console.warn(`Element with id wotqty${i} not found.`);
            } 
            if (defqty) { // Check if the element exists
                defqty.innerHTML = `0`;
            } else {
                console.warn(`Element with id defqty${i} not found.`);
            } 
            if (temp) { // Check if the element existsmold_Temperature_1
                temp.innerHTML = `${wtab01_data[i].mold_Temperature_1} ( ${wtab01_data[i].mold_Temperature_2} ) ${wtab01_data[i].mold_Temperature_3} (${wtab01_data[i].mold_Temperature_4})`;
            } else {
                console.warn(`Element with id mold_Temperature_1${i} not found.`);
            } 
            if (onsutemp) { // Check if the element existsmold_Temperature_1
                onsutemp.innerHTML = `${wtab01_data[i].mold_Temperature_5}`;
            } else {
                console.warn(`Element with id onsutemp${i} not found.`);
            } 
            if (drytemp) { // Check if the element existsmold_Temperature_1
                drytemp.innerHTML = `${wtab01_data[i].mold_Temperature_6}`;
            } else {
                console.warn(`Element with id drytemp${i} not found.`);
            } 
            if (cavity) { // Check if the element existsmold_Temperature_1
                cavity.innerHTML = `${wtab01_data[i].cavity}`;
            } else {
                console.warn(`Element with id cavity${i} not found.`);
            } 
            if (opertime) { // Check if the element existsmold_Temperature_1
                opertime.innerHTML = `${wtab01_data[i].operatingTimeHours}시간`;
            } else {
                console.warn(`Element with id opertime${i} not found.`);
            } 
            if (idletime) { // Check if the element existsmold_Temperature_1
                idletime.innerHTML = `${wtab01_data[i].idleTimeMinute}분`;
            } else {
                console.warn(`Element with id idletime${i} not found.`);
            } 
        }
          
        // Update data for each machine
        // updateCardData(7, data.machine7);
        // updateCardData(8, data.machine8);
        // Add more machines as needed
    }

    setInterval(fetchData, 5000); // Fetch data every 5 seconds

    // Update current time every second
    function updateTime() {
        const now = new Date();
        document.getElementById('current-time').textContent = now.toLocaleTimeString();
    }
    setInterval(updateTime, 1000);


    // Fetch initial data
    fetchData();     
//$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$


$(document).ready(function() {   
        // init()          
        // getToday() 
        // $('datetimepicker').datetimepicker({
            
        // }); 

        // $("#frdate").change(function(e){ 
        //     // console.log("달력클릭");
        //     // console.log(convert_time(e.timestamp));
        // })
        // $("#todate").change(function(e){ 
        //     // console.log("달력클릭");
        //     // console.log(convert_time(e.timestamp));
        // })
   })    
    function init(){ 
            
            wfrdate = new wijmo.input.InputDateTime('#frdate', {
                isRequired: false,
                value: null,
                placeholder: '',
                format: 'yyyy-MM-dd HH:mm', 
            });
            wtodate = new wijmo.input.InputDateTime('#todate', {
                isRequired: false,
                value: null,
                placeholder: '',
                format: 'yyyy-MM-dd HH:mm', 
            }); 

            var result = new Date();
            result.setHours(result.getHours() + 9); 
            var ls_date01 = result.toISOString().substring(0,10);    
            
            // ls_date02 값을 날짜와 시간을 "23:59"로 설정
            
            // result.setHours(result.getHours() + 10); 
            var today = new Date();
            today.setHours(23, 59, 0, 0); // 시간: 23, 분: 59, 초: 0, 밀리초: 0 
            var ls_date02 = today.toISOString().substring(0, 10) + " " + today.toTimeString().substring(0, 5); 
                          
            wfrdate.value = ls_date01;   
            wtodate.value = ls_date02;  
            
    } 
    


    function getToday(){
        let today = new Date();   

        let year = today.getFullYear(); // 년도
        let month = today.getMonth() + 1;  // 월
        let date = today.getDate();  // 날짜
        let day = today.getDay();  // 요일
        if(month > 0 && month < 10) {month = "0" + month};
        if(date > 0 && date < 10) {date = "0" + date};
        let ls_frday = year + '-' + month + '-01'  
        let ls_today = year + '-' + month + '-' + date 
        document.getElementById('frdate').value = ls_frday;  
        document.getElementById('todate').value = ls_today;
        
        // document.getElementById('todate').value = ls_today;
    }

    function convert_time(timestamp){ 
        //현재시간
        var date = new Date(timestamp); 
        var year = date.getFullYear();
        var month = ("0" + (1 + date.getMonth())).slice(-2);
        var day = ("0" + date.getDate()).slice(-2); 
        var hh = date.getHours();  
        var min = ('0' + date.getMinutes()).slice(-2) 
        time = year +  month +  day   ;
        return time;  
    } 
 
 
    function logout(){   
      var ip_addr = "" ;
      if (!confirm("로그아웃하시겠습니까?") ){
          return    
      } 
      var ls_loginid   = localStorage.getItem("userid"); 
          ip_addr = document.getElementById('ipaddr').value; 
      $.ajax({
          url: '/authcrud/logoutlog',
          type:"POST",
          data: {
              "loginid" : ls_loginid ,
              "ipaddr" : ip_addr ,
          },
          async:false,
          success:function(){
                  console.log('success');
          }
      });
      localStorage.removeItem("perid");
      localStorage.removeItem("pernm");
      localStorage.removeItem("userid");
      localStorage.removeItem("flag");
      localStorage.removeItem("custnm") ;
      location.href = "/" ;
  }   

 

    </script>
</header>